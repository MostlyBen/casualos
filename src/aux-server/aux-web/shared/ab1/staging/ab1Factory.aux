{"version":2,"updates":[{"id":0,"timestamp":1680641800215,"update":"AZgC+fDpyQIAJwEEYm90cyQxMDE0MjU0Ni04YzM0LTRiZDYtYWQzNi0wYTE0NjE3OTNkMDkBKAD58OnJAgAKbWF4VmVyc2lvbgF+JwD58OnJAgAEYWJJRAIEAPnw6ckCAhRhYnJ3X3Rlc3RfZXhwZXJpZW5jZSgA+fDpyQIABWxhYmVsAX4oAPnw6ckCABFlZ2dWZXJzaW9uSGlzdG9yeQF+JwD58OnJAgAQZWdnRm9ybWF0VmVyc2lvbgIEAPnw6ckCGSQwMTcwZDhiYS0xN2MwLTQyYzYtODBlOS0yYjE1ZDNjZDc1YzcoAPnw6ckCAA10YXJnZXRWZXJzaW9uAX0BKAD58OnJAgAMaW5pdGlhbFRpbWVyAX4nAPnw6ckCAAdtYW5hZ2VyAgQA+fDpyQJAKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPnw6ckCAAdvbkNsaWNrAgQA+fDpyQJnJUAgbGlua3MubWFuYWdlci5pbnRlcmFjdE92byh0aGlzQm90KTsnAPnw6ckCAAhvbkNyZWF0ZQIEAPnw6ckCjQG3A0Bjb25zdCB0YXJnZXRBQiA9IGF3YWl0IG9zLnNob3dJbnB1dCgnYWInLCB7CiAgICB0aXRsZTogJ2FiIG5hbWUnCn0pOwoKaWYgKCF0YXJnZXRBQiB8fCB0YXJnZXRBQiA9PSAiYWIiKQp7CiAgICBvcy50b2FzdCgibm8gdmFsaWQgYWIgZ2l2ZW4iKTsKCiAgICBkZXN0cm95KHRoaXNCb3QpOwoKICAgIHJldHVybjsKfQoKY29uc3QgZ2V0UmVjb3JkID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiMVJlY29yZEtleSwgdGFyZ2V0QUIsIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxRW5kcG9pbnQpOwoKaWYgKCFnZXRSZWNvcmQuc3VjY2VzcykKewogICAgb3MudG9hc3QoIm5vIGFiIGZvdW5kIHdpdGggdGhhdCBuYW1lIik7CgogICAgZGVzdHJveSh0aGlzQm90KTsKCiAgICByZXR1cm47Cn0KCmFwcGx5TW9kKHRoaXNCb3QsIGdldFJlY29yZC5kYXRhKTsnAPnw6ckCAARmb3JtAgQA+fDpyQLFBANlZ2cnAPnw6ckCABBwcm9ncmVzc0JhckNvbG9yAgQA+fDpyQLJBAcjQkY1RTY2JwD58OnJAgAacHJvZ3Jlc3NCYXJCYWNrZ3JvdW5kQ29sb3ICBAD58OnJAtEEByM1OTI5ODkoAPnw6ckCAAlsYWJlbFNpemUBfD8AAAAnAPnw6ckCAApsYWJlbENvbG9yAgQA+fDpyQLaBAcjNDA0MDQwJwD58OnJAgAOb25Qb2ludGVyRW50ZXICBAD58OnJAuIEL0Bvcy50b2FzdCh0YWdzLmFiSUQgKyAnIHYnK3RhZ3MudGFyZ2V0VmVyc2lvbik7JwD58OnJAgANbGFiZWxQb3NpdGlvbgIEAPnw6ckCkgUFZnJvbnQnAPnw6ckCAA9vcmllbnRhdGlvbk1vZGUCBAD58OnJApgFDmJpbGxib2FyZEZyb250JwD58OnJAgAJb25EZXN0cm95AgQA+fDpyQKnBSNAbGlua3MubWFuYWdlci5tYXNrcy5vdm9Cb3QgPSBudWxsOygA+fDpyQIACGVnZ1RpbWVyAX4oAPnw6ckCAARob21lAX4oAPnw6ckCAAVob21lWAF+KAD58OnJAgAFaG9tZVkBficA+fDpyQIACWRpbWVuc2lvbgIEAPnw6ckCzwUEaG9tZSgA+fDpyQIACmFiSURPcmlnaW4BfigA+fDpyQIAC3Byb2dyZXNzQmFyAX4nAPnw6ckCAAZzeXN0ZW0CBAD58OnJAtYFEGFiLTEuZmFjdG9yeS5lZ2cnAPnw6ckCAAlsaXN0ZW5pbmcCBAD58OnJAucFBWZhbHNlJwD58OnJAgAKYWIxRmFjdG9yeQIEAPnw6ckC7QUEdHJ1ZSgA+fDpyQIACGFiMUlnb3JlAX4nAPnw6ckCAAlhYjFJZ25vcmUCBAD58OnJAvMFBHRydWUnAPnw6ckCAAhyZW1lbWJlcgIEAPnw6ckC+AUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA+fDpyQIAC2ZhY3RvcnlJY29uAgQA+fDpyQKfBgNlZ2cnAPnw6ckCAAVjb2xvcgIEAPnw6ckCowYHI0ZGRkZGRigA+fDpyQIADWFiMUJvdFZlcnNpb24BfQonAQRib3RzJDE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NQEnAPnw6ckCrAYGc3lzdGVtAgQA+fDpyQKtBhRhYi0xLmZhY3RvcnkubWFuYWdlcicA+fDpyQKsBgRmb3JtAgQA+fDpyQLCBgdub3RoaW5nJwD58OnJAqwGCWFiMUlnbm9yZQIEAPnw6ckCygYEdHJ1ZScA+fDpyQKsBg9hYjFBZGRUb0ZhY3RvcnkCBAD58OnJAs8GjgZALy9zaG91dCgiYWIxQWRkVG9GYWN0b3J5Iiwge2RpbWVuc2lvbjogZGltZW5zaW9uLCBib3Q6IGJvdCwgZmFjdG9yeUlEOiBmYWN0b3J5SUR9KTsKbGV0IGZhY3RvcnlJRDsKCmlmICh0aGF0LmZhY3RvcnlJRCkKewogICAgZmFjdG9yeUlEID0gdGhhdC5mYWN0b3J5SUQ7Cn0KZWxzZQp7CiAgICBmYWN0b3J5SUQgPSBhd2FpdCBvcy5zaG93SW5wdXQobnVsbCwgewogICAgICAgIHRpdGxlOiAnQWRkIGZhY3RvcnkgaWQnCiAgICB9KTsKfQoKaWYgKGZhY3RvcnlJRCkKewogICAgbGV0IHByZXZpb3VzRmFjdG9yeUJvdCA9IGdldEJvdCgic3lzdGVtIiwgImFiLTEuZmFjdG9yeS4iICsgZmFjdG9yeUlEKTsKICAgIAogICAgaWYocHJldmlvdXNGYWN0b3J5Qm90KQogICAgewogICAgICAgIGRlc3Ryb3kocHJldmlvdXNGYWN0b3J5Qm90KTsKICAgIH0KCiAgICBsZXQgdGVtcGxhdGVCb3QgPSB0aGF0LmJvdDsKICAgIGxldCBmYWN0b3J5TW9kID0ge307CgogICAgZmFjdG9yeU1vZFt0aGF0LmRpbWVuc2lvbl0gPSBudWxsOwogICAgZmFjdG9yeU1vZC5zeXN0ZW0gPSAiYWItMS5mYWN0b3J5LiIgKyBmYWN0b3J5SUQ7CiAgICBmYWN0b3J5TW9kLmxpc3RlbmluZyA9IGZhbHNlOwogICAgZmFjdG9yeU1vZC5hYjFGYWN0b3J5ID0gdHJ1ZTsKCiAgICBjcmVhdGUodGVtcGxhdGVCb3QsIGZhY3RvcnlNb2QpOwoKICAgIGFiMS5sb2coZmFjdG9yeUlEICsgIiBhZGRlZCB0byBmYWN0b3J5Iik7CgogICAgb3MudG9hc3QoImFkZGVkICIgKyBmYWN0b3J5SUQgKyAiIHRvIGZhY3RvcnkiKTsKfScA+fDpyQKsBgphYjFGYWN0b3J5AgQA+fDpyQLeDAR0cnVlJwD58OnJAqwGEGFiMUJvdE1lbnVBY3Rpb24CBAD58OnJAuMMuwFAY29uc3QgY3VycmVudERpbSA9IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWIxQm90LnRhZ3MuZGltZW5zaW9uOwpjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYjFCb3RGb2N1czsKCnRoaXNCb3QuYWIxQWRkVG9GYWN0b3J5KHtkaW1lbnNpb246IGN1cnJlbnREaW0sIGJvdDogdGFyZ2V0Qm90fSk7JwD58OnJAqwGFGFiMUNyZWF0ZUZyb21GYWN0b3J5AgQA+fDpyQKfDp8GQC8vc2hvdXQoImFiMUNyZWF0ZUZyb21GYWN0b3J5Iiwge2ZhY3RvcnlJRDogImZhY3RvcnlJRCIsIHBvc2l0aW9uOiB7ZGltZW5zaW9uOiAiZGltZW5zaW9uIiwgeDogIngiLCB5OiAieSJ9fSk7CmxldCBmdWxsTmFtZSA9ICJhYi0xLmZhY3RvcnkuIiArIHRoYXQuZmFjdG9yeUlEOwpsZXQgZmFjdG9yeVRlbXBsYXRlID0gZ2V0TW9kKGdldEJvdCgnc3lzdGVtJywgZnVsbE5hbWUpKTsKbGV0IHBvc2l0aW9uSW5mbyA9IHRoYXQucG9zaXRpb247CgppZighZmFjdG9yeVRlbXBsYXRlKQp7CiAgICBjb25zb2xlLmxvZygibm90IGZhY3RvcnkgYm90IGZvdW5kIik7CgogICAgYWIxLmxvZyhmdWxsTmFtZSArICIgY291bGQgbm90IGJlIGZvdW5kIikKCiAgICByZXR1cm47Cn0KCmFiMS5sb2coZnVsbE5hbWUgKyAiIGNyZWF0ZWQgZnJvbSBmYWN0b3J5Iik7CgpsZXQgbmV3Qm90ID0ge30KCm5ld0JvdC5jcmVhdG9yID0gbnVsbDsKbmV3Qm90W3Bvc2l0aW9uSW5mby5kaW1lbnNpb25dID0gdHJ1ZTsKbmV3Qm90W3Bvc2l0aW9uSW5mby5kaW1lbnNpb24gKyAiWCJdID0gcG9zaXRpb25JbmZvLnBvc2l0aW9uLng7Cm5ld0JvdFtwb3NpdGlvbkluZm8uZGltZW5zaW9uICsgIlkiXSA9IHBvc2l0aW9uSW5mby5wb3NpdGlvbi55OwpuZXdCb3QubGlzdGVuaW5nID0gbnVsbDsKbmV3Qm90LmFiMUlnbm9yZSA9IG51bGw7Cm5ld0JvdC5zeXN0ZW0gPSBudWxsOwpuZXdCb3QuYWIxRmFjdG9yeSA9IG51bGw7CgpjcmVhdGUoZmFjdG9yeVRlbXBsYXRlLCBuZXdCb3QpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYjFDbGljaygpOycA+fDpyQKsBhFhYjFHcmlkTWVudUFjdGlvbgIEAPnw6ckCvxSZCEBzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiMU1lbnUiOwoKbGlua3MubWVudS5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYjFNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7IjsKCmNvbnN0IGZhY3RvcnlCb3RzID0gZ2V0Qm90cygiYWIxRmFjdG9yeSIpOwpjb25zdCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLmFiMU1lbnUgPSB0cnVlOwptZW51QnV0dG9uLmFiMU1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51QnV0dG9uLmdyaWRJbmZvcm1hdGlvbiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxR3JpZEZvY3VzOwptZW51QnV0dG9uLm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5tYW5hZ2VyLmFiMUNyZWF0ZUZyb21GYWN0b3J5KHtmYWN0b3J5SUQ6IHRhZ3MubGFiZWwsIHBvc2l0aW9uOiB0YWdzLmdyaWRJbmZvcm1hdGlvbn0pOyBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTtgOwoKaWYgKGZhY3RvcnlCb3RzLmxlbmd0aCA8IDIpCnsKICAgIHJldHVybjsgCn0KCmZvciAobGV0IGogPSAwOyBqIDwgZmFjdG9yeUJvdHMubGVuZ3RoOyBqKyspIAp7CiAgICBsZXQgY3VycmVudEZhY3RvcnlCb3QgPSBmYWN0b3J5Qm90c1tqXTsKICAgIGxldCBjdXJyZW50U3lzdGVtVGFnID0gY3VycmVudEZhY3RvcnlCb3QudGFncy5zeXN0ZW07CgogICAgaWYgKGN1cnJlbnRTeXN0ZW1UYWcgPT0gdGFncy5zeXN0ZW0pCiAgICB7CiAgICAgICAgY29udGludWU7CiAgICB9CgogICAgbWVudUJ1dHRvbi5sYWJlbCA9IGN1cnJlbnRTeXN0ZW1UYWcuc3Vic3RyaW5nKDEzKTsKICAgIG1lbnVCdXR0b24uY29sb3IgPSBjdXJyZW50RmFjdG9yeUJvdC50YWdzLmNvbG9yOwogICAgbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGN1cnJlbnRGYWN0b3J5Qm90LnRhZ3MuZmFjdG9yeUljb247CgogICAgbGlua3MubWVudS5hYjFDcmVhdGVNZW51QnV0dG9uKG1lbnVCdXR0b24pOwp9JwD58OnJAqwGDW1hbmlmZXN0YXRpb24CBAD58OnJAtccKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAPnw6ckCrAYIcmVtZW1iZXICBAD58OnJAv4cKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPnw6ckCrAYEbWVudQIEAPnw6ckCpR0o8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA+fDpyQKsBhBhYjFHcmlkTWVudUxhYmVsAgQA+fDpyQLMHQd0b29sYm94JwD58OnJAqwGD2FiMUdyaWRNZW51SWNvbgIEAPnw6ckC1B0MY29uc3RydWN0aW9uJwD58OnJAqwGFGFiMUdyaWRNZW51U29ydE9yZGVyAgQA+fDpyQLhHQEzJwD58OnJAqwGDmFiMUJvdE1lbnVJY29uAgQA+fDpyQLjHQxjb25zdHJ1Y3Rpb24nAPnw6ckCrAYPYWIxQm90TWVudUxhYmVsAgQA+fDpyQLwHQ5hZGQgdG8gdG9vbGJveCcA+fDpyQKsBhNhYjFCb3RNZW51U29ydE9yZGVyAgQA+fDpyQL/HQEzJwD58OnJAqwGD2FiMUJvdE1lbnVDb2xvcgIEAPnw6ckCgR4HIzU1RTY3OScA+fDpyQKsBhBhYjFHcmlkTWVudUNvbG9yAgQA+fDpyQKJHgcjNTVFNjc5KAD58OnJAqwGDWFiMUJvdFZlcnNpb24BfRAnAQRib3RzJGE1ZTJlZWRmLWNkMTctNGJmOC1hOTg2LWRkODJhYTFmZDg1OAEnAPnw6ckCkh4FY29sb3ICBAD58OnJApMeByM2MjI3NzMnAPnw6ckCkh4EZm9ybQIEAPnw6ckCmx4FaGVsaXgnAPnw6ckCkh4EbW9kcwIEAPnw6ckCoR4Y8J+nrHsiY29sb3IiOiAiIzYyMjc3MyJ9JwD58OnJApIeBnN5c3RlbQIEAPnw6ckCuB4QYWItMS5mYWN0b3J5Lm1vZCcA+fDpyQKSHgphYjFGYWN0b3J5AgQA+fDpyQLJHgR0cnVlJwD58OnJApIeCWFiMUlnbm9yZQIEAPnw6ckCzh4EdHJ1ZScA+fDpyQKSHglsaXN0ZW5pbmcCBAD58OnJAtMeBWZhbHNlJwD58OnJApIeC2ZhY3RvcnlJY29uAgQA+fDpyQLZHgVoZWxpeCcA+fDpyQKSHgt0b29sTWFuYWdlcgIEAPnw6ckC3x4o8J+UlzE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NScA+fDpyQKSHgdvbkNsaWNrAgQA+fDpyQKGH5MGQHNob3V0KCJtb2RNZW51UmVzZXQiKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gIm1vZE1lbnUiOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBgQCBzaG91dCgibW9kTWVudVJlc2V0Iik7YDsKbWFza3MubW9kTWVudVJlc2V0ID0gYEAgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOwpjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gbnVsbDsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3IgPSBudWxsOwoKY2xlYXJUYWdNYXNrcyh0aGlzQm90KTtgOwoKbGV0IG1vZE1lbnVCb3QgPSB7fTsKCm1vZE1lbnVCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKbW9kTWVudUJvdC5tb2RNZW51ID0gdHJ1ZTsKbW9kTWVudUJvdC5sYWJlbCA9ICJlZGl0IG1vZCI7Cm1vZE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiZWRpdCI7Cm1vZE1lbnVCb3QuY29sb3IgPSB0YWdzLmNvbG9yOwptb2RNZW51Qm90Lm1vZERpbWVuc2lvbiA9IHRoaXNCb3QuaWQgKyAiLm1vZHMiOwptb2RNZW51Qm90Lm1vZE1lbnVSZXNldCA9IGBAIGRlc3Ryb3kodGhpc0JvdCk7YDsKbW9kTWVudUJvdC5tZW51SXRlbVN0eWxlID0geyJib3JkZXItcmFkaXVzIjoiOHB4IiwgIm1hcmdpbi10b3AiOiIzcHgifTsKbW9kTWVudUJvdC5vbkNsaWNrID0gYEAgZGVzdHJveSh0aGlzQm90KTsKCmNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSB0YWdzLm1vZERpbWVuc2lvbjsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9ICJ0b3AiOwpgOwoKY3JlYXRlKG1vZE1lbnVCb3QpOycA+fDpyQKSHgZvbkRyb3ACBAD58OnJApol6gJAaWYgKHRoYXQuZHJhZ0JvdCAhPSB0aGlzQm90IHx8IHRoYXQudG8uYm90LnRhZ3MuYWIxRmFjdG9yeSkKewogICAgcmV0dXJuOwp9CgphcHBseU1vZCh0aGF0LnRvLmJvdCwgdGFncy5tb2RzKTsKCmxldCBwcmV2aW9pdXNEaW1lbnNpb24gPSB0aGF0LmZyb20uZGltZW5zaW9uOwoKdGFnc1t0aGF0LnRvLmRpbWVuc2lvbl0gPSBudWxsOwp0YWdzW3ByZXZpb2l1c0RpbWVuc2lvbl0gPSB0cnVlOwp0YWdzW3ByZXZpb2l1c0RpbWVuc2lvbiArICJYIl0gPSB0aGF0LmZyb20ueDsKdGFnc1twcmV2aW9pdXNEaW1lbnNpb24gKyAiWSJdID0gdGhhdC5mcm9tLnk7CnRhZ3NbcHJldmlvaXVzRGltZW5zaW9uICsgIloiXSA9IHRoYXQuZnJvbS56OygA+fDpyQKSHg1hYjFCb3RWZXJzaW9uAX0KKAD58OnJApIeCGFiMUlnb3JlAX4nAQRib3RzJGM0NGViYzdmLTNkZjctNGU4ZS05NzgxLTE0ZTJjZThlMzRjOAEnAPnw6ckChygLZmFjdG9yeUljb24CBAD58OnJAogoC2ludmVudG9yeV8yJwD58OnJAocoBWNvbG9yAgQA+fDpyQKUKAcjOTA4QkZDKAD58OnJAocoDWFiMUJvdFZlcnNpb24BfQ8nAPnw6ckChygEZm9ybQIEAPnw6ckCnSgGY2lyY2xlKAD58OnJAocoBXNjYWxlAX0CJwD58OnJAocoC3Rvb2xNYW5hZ2VyAgQA+fDpyQKlKCjwn5SXMTRlMWZkYWMtY2ZkNy00ZTdlLWJkZDEtOTY3YTQwODVhNzU1KAD58OnJAocoBGhvbWUBfigA+fDpyQKHKAVob21lWQF+KAD58OnJAocoBWhvbWVaAX4nAPnw6ckChygGc2NhbGVaAgQA+fDpyQLPKAMwLjEoAPnw6ckChygFaG9tZVgBficA+fDpyQKHKAZzeXN0ZW0CBAD58OnJAtQoFWFiLTEuZmFjdG9yeS5ib3RTdG9yZScA+fDpyQKHKAZvbkRyb3ACBAD58OnJAuoof0BpZiAodGhhdC5kcmFnQm90ID09IHRoaXNCb3QgfHwgdGhhdC5kcmFnQm90LnRhZ3Muc3BhY2UgIT0gInNoYXJlZCIpCnsKICAgIHJldHVybjsKfQoKdGhpc0JvdFt0YWdzLnN0b3JlTW9kZSArICJPbkRyb3AiXSh0aGF0KTsnAPnw6ckChygRYm90U3RvcmVSZWplY3RCb3QCBAD58OnJAuopigJAdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb25dID0gbnVsbDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbl0gPSB0cnVlOwp0aGF0LmRyYWdCb3QudGFnc1t0aGF0LmZyb20uZGltZW5zaW9uKyJYIl0gPSB0aGF0LmZyb20ueDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbisiWSJdID0gdGhhdC5mcm9tLnk7CnRoYXQuZHJhZ0JvdC50YWdzW3RoYXQuZnJvbS5kaW1lbnNpb24rIloiXSA9IHRoYXQuZnJvbS56OygA+fDpyQKHKAhvbkNyZWF0ZQF+JwD58OnJAocoCXN0b3JlTW9kZQIEAPnw6ckC9isJdW5saW1pdGVkJwD58OnJAocoD3VubGltaXRlZE9uRHJvcAIEAPnw6ckCgCxlQGlmICh0YWdzLnRlbXBsYXRlKQp7CiAgICB0aGlzQm90LmJvdFN0b3JlUmVqZWN0Qm90KHRoYXQpOwoKICAgIHJldHVybjsKfQoKdGhpc0JvdC5hZGRUZW1wbGF0ZSh0aGF0KTsnAPnw6ckChygNbGltaXRlZE9uRHJvcAIEAPnw6ckC5iyJAkBpZiAoKHRhZ3MuYm90U3RvcmVJRCAmJiB0aGF0LmRyYWdCb3QudGFncy5ib3RTdG9yZUlEICE9IHRhZ3MuYm90U3RvcmVJRCkgfHwgdGFncy5tYXhDb3VudCA9PSB0YWdzLmxhYmVsKQp7CiAgICB0aGlzQm90LmJvdFN0b3JlUmVqZWN0Qm90KHRoYXQpOwoKICAgIHJldHVybjsKfQoKdGFncy5sYWJlbCsrOwoKaWYgKHRhZ3MudGVtcGxhdGUpCnsKICAgIGRlc3Ryb3kodGhhdC5kcmFnQm90KTsKfQplbHNlCnsKICAgIHRoaXNCb3QuYWRkVGVtcGxhdGUodGhhdCk7Cn0nAPnw6ckChygLYWRkVGVtcGxhdGUCBAD58OnJAvAu4wtAdGFncy50ZW1wbGF0ZSA9IGdldExpbmsodGhhdC5kcmFnQm90KTsKCnRoYXQuZHJhZ0JvdC50YWdzLmxpc3RlbmluZyA9IGZhbHNlOwp0aGF0LmRyYWdCb3QudGFncy5wb2ludGFibGUgPSBmYWxzZTsKdGhhdC5kcmFnQm90LnRhZ3MudHJhbnNmb3JtZXIgPSB0aGlzQm90LmlkOwp0aGF0LmRyYWdCb3QudGFncy5jcmVhdG9yID0gdGhpc0JvdC5pZDsKdGhhdC5kcmFnQm90LnRhZ3MudHJhbnNmb3JtZXIgPSB0aGlzQm90LmlkOwp0aGF0LmRyYWdCb3QudGFnc1t0aGF0LnRvLmRpbWVuc2lvbiArICJYIl0gPSAwOwp0aGF0LmRyYWdCb3QudGFnc1t0aGF0LnRvLmRpbWVuc2lvbiArICJZIl0gPSAwOwp0aGF0LmRyYWdCb3QudGFnc1t0aGF0LnRvLmRpbWVuc2lvbiArICJaIl0gPSA1Owp0aGF0LmRyYWdCb3QudGFncy5zY2FsZSA9IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlID8gdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGUgLyAyIDogMC41Owp0aGF0LmRyYWdCb3QudGFncy5zY2FsZVggPSB0aGF0LmRyYWdCb3QudGFncy5zY2FsZVggPyB0aGF0LmRyYWdCb3QudGFncy5zY2FsZVggLyAyIDogMTsKdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVZID0gdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVZID8gdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVZIC8gMiA6IDE7CnRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWiA9IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWiA/IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWiAqIDEwIDogMTA7CgppZiAodGFncy5zdG9yZU1vZGUgPT0gImxpbWl0ZWQiKQp7CiAgICBsZXQgbmV3U3RvcmVJRCA9IHV1aWQoKTsKCiAgICB0YWdzLmJvdFN0b3JlSUQgPSBuZXdTdG9yZUlEOwoKICAgIHRoYXQuZHJhZ0JvdC50YWdzLmJvdFN0b3JlSUQgPSBuZXdTdG9yZUlEOwp9CgpsZXQgaGl0Qm94ID0ge307CgpoaXRCb3gudHJhbnNmb3JtZXIgPSB0aGlzQm90LmlkOwpoaXRCb3guY29sb3IgPSAiY2xlYXIiOwpoaXRCb3guZHJhZ2dhYmxlID0gZmFsc2U7CmhpdEJveC5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKaGl0Qm94Lm9uRHJhZyA9IGBAIGxpbmtzLm1hbmFnZXIudGVtcGxhdGVEcmFnKHRoYXQpO2A7CmhpdEJveC5zY2FsZSA9IGxpbmtzLnRlbXBsYXRlLnRhZ3Muc2NhbGU7CmhpdEJveC5zY2FsZVggPSBsaW5rcy50ZW1wbGF0ZS50YWdzLnNjYWxlWDsKaGl0Qm94LnNjYWxlWSA9IGxpbmtzLnRlbXBsYXRlLnRhZ3Muc2NhbGVZOwpoaXRCb3guc2NhbGVaID0gbGlua3MudGVtcGxhdGUudGFncy5zY2FsZVo7CmhpdEJveFt0aGF0LnRvLmRpbWVuc2lvbl0gPSB0cnVlOwpoaXRCb3hbdGhhdC50by5kaW1lbnNpb24gKyAiWCJdID0gMDsKaGl0Qm94W3RoYXQudG8uZGltZW5zaW9uICsgIlkiXSA9IDA7CmhpdEJveFt0aGF0LnRvLmRpbWVuc2lvbiArICJaIl0gPSA1OwoKbGV0IG5ld0hpdGJveCA9IGNyZWF0ZShoaXRCb3gpOwoKbGlua3MuaGl0Qm94ID0gZ2V0TGluayhuZXdIaXRib3gpOwoKdGhpc0JvdC5pbml0aWF0ZUJvdFN0b3JlQW5pbWF0aW9uKCk7JwD58OnJAocoB29uQ2xpY2sCBAD58OnJAtQ6/ApAc2hvdXQoImJvdFN0b3JlTWVudVJlc2V0Iik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJib3RTdG9yZU1lbnUiOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBgQCBzaG91dCgiYm90U3RvcmVNZW51UmVzZXQiKTtgOwptYXNrcy5ib3RTdG9yZU1lbnVSZXNldCA9IGBAIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKCmNsZWFyVGFnTWFza3ModGhpc0JvdCk7YDsKCmxldCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCdXR0b24uYm90U3RvcmVNZW51ID0gdHJ1ZTsKbWVudUJ1dHRvbi5ib3RTdG9yZU1lbnVSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbi5tZW51SXRlbVN0eWxlID0geyJib3JkZXItcmFkaXVzIjoiOHB4IiwgIm1hcmdpbi10b3AiOiIzcHgifTsKbWVudUJ1dHRvbi5sYWJlbEFsaWdubWVudCA9ICJsZWZ0IjsKbWVudUJ1dHRvbi5jb2xvciA9IHRhZ3MuY29sb3I7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cm1lbnVCdXR0b24ub25DbGljayA9IGBAIHNob3V0KCJib3RTdG9yZU1lbnVSZXNldCIpOwogICAgCmxpbmtzLm1hbmFnZXIuY2hhbmdlU3RvcmVTdGF0ZSgpO2A7CgppZiAodGFncy5zdG9yZU1vZGUgPT0gInVubGltaXRlZCIpCnsKICAgIG1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiaW52ZW50b3J5IjsKICAgIG1lbnVCdXR0b24ubGFiZWwgPSAiY2hhbmdlIHRvIGxpbWl0ZWQiOwoKICAgIGNyZWF0ZShtZW51QnV0dG9uKTsKfQplbHNlCnsKICAgIG1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZmlsZV9jb3B5IjsKICAgIG1lbnVCdXR0b24ubGFiZWwgPSAiY2hhbmdlIHRvIHVubGltaXRlZCI7CgogICAgY3JlYXRlKG1lbnVCdXR0b24pOwoKICAgIG1lbnVCdXR0b24ubGFiZWwgPSAiICAgICI7CiAgICBtZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImNlbnRlciI7CiAgICBtZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5tYW5hZ2VyLnRhZ3MudGVtcGxhdGVMb2NrID0gIWxpbmtzLm1hbmFnZXIudGFncy50ZW1wbGF0ZUxvY2sKICAgIAogICAgaWYgKGxpbmtzLm1hbmFnZXIudGFncy50ZW1wbGF0ZUxvY2spCiAgICB7CiAgICAgICAgdGFncy5mb3JtQWRkcmVzcyA9ICJsb2NrIjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0YWdzLmZvcm1BZGRyZXNzID0gImxvY2tfb3BlbiI7CiAgICB9YDsKCiAgICBpZiAodGFncy50ZW1wbGF0ZUxvY2spCiAgICB7CiAgICAgICAgbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJsb2NrIjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBtZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImxvY2tfb3BlbiI7CiAgICB9CgogICAgY3JlYXRlKG1lbnVCdXR0b24pOwp9CgonAPnw6ckChygMdGVtcGxhdGVEcmFnAgQA+fDpyQLRRYEHQGlmICh0YWdzLnN0b3JlTW9kZSA9PSAibGltaXRlZCIpCnsKICAgIGlmICh0YWdzLmxhYmVsID09IDApCiAgICB7CiAgICAgICAgcmV0dXJuOwogICAgfQp9CgpsZXQgbmV3Qm90ID0gZ2V0TW9kKGxpbmtzLnRlbXBsYXRlKTsKCm5ld0JvdFt0aGF0LmZyb20uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFt0aGF0LmZyb20uZGltZW5zaW9uICsgIlgiXSA9IHRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJYIl07Cm5ld0JvdFt0aGF0LmZyb20uZGltZW5zaW9uICsgIlkiXSA9IHRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJZIl07Cm5ld0JvdFt0aGF0LmZyb20uZGltZW5zaW9uICsgIloiXSA9IDA7Cm5ld0JvdC5saXN0ZW5pbmcgPSBudWxsOwpuZXdCb3QucG9pbnRhYmxlID0gbnVsbDsKbmV3Qm90LnRyYW5zZm9ybWVyID0gbnVsbDsKbmV3Qm90LmNyZWF0b3IgPSBudWxsOwpuZXdCb3QudHJhbnNmb3JtZXIgPSBudWxsOwpuZXdCb3Quc2NhbGUgPSBuZXdCb3Quc2NhbGUgPT0gMC41ID8gbnVsbCA6IG5ld0JvdC5zY2FsZSAqIDI7Cm5ld0JvdC5zY2FsZVggPSBuZXdCb3Quc2NhbGVYID09IDEgPyBudWxsIDogbmV3Qm90LnNjYWxlWCAqIDI7Cm5ld0JvdC5zY2FsZVkgPSBuZXdCb3Quc2NhbGVZID09IDEgPyBudWxsIDogbmV3Qm90LnNjYWxlWSAqIDI7Cm5ld0JvdC5zY2FsZVogPSBuZXdCb3Quc2NhbGVaID09IDEwID8gbnVsbCA6IG5ld0JvdC5zY2FsZVogLyAxMDsKbmV3Qm90LmJvdFN0b3JlSUQgPSB0YWdzLmJvdFN0b3JlSUQ7CgpsZXQgY3JlYXRlZEJvdCA9IGNyZWF0ZShuZXdCb3QpOwoKb3MucmVwbGFjZURyYWdCb3QoY3JlYXRlZEJvdCk7CgppZiAodGFncy5zdG9yZU1vZGUgPT0gImxpbWl0ZWQiKQp7CiAgICB0aGlzQm90LnJlZHVjZUxpbWl0ZWRDb3VudCgpOwp9JwD58OnJAocoEnJlZHVjZUxpbWl0ZWRDb3VudAIEAPnw6ckC00yNAkB0YWdzLmxhYmVsLS07CgppZiAodGFncy5sYWJlbCA9PSAwICYmICF0YWdzLnRlbXBsYXRlTG9jaykKewogICAgY2xlYXJJbnRlcnZhbCh0YWdzLnN0b3JlSW50ZXJ2YWwpOwoKICAgIGRlc3Ryb3kobGlua3MudGVtcGxhdGUpOwogICAgZGVzdHJveShsaW5rcy5oaXRCb3gpOwoKICAgIHRhZ3MudGVtcGxhdGUgPSBudWxsOwogICAgdGFncy5oaXRCb3ggPSBudWxsOwogICAgdGFncy5ib3RTdG9yZUlEID0gbnVsbDsKICAgIG1hc2tzLnN0b3JlSW50ZXJ2YWwgPSBudWxsOwp9JwD58OnJAocoCmFiMUZhY3RvcnkCBAD58OnJAuFOBHRydWUnAPnw6ckChygJYWIxSWdub3JlAgQA+fDpyQLmTgR0cnVlJwD58OnJAocoCWxpc3RlbmluZwIEAPnw6ckC604FZmFsc2UnAPnw6ckChygQY2hhbmdlU3RvcmVTdGF0ZQIEAPnw6ckC8U7tBEBpZiAodGFncy5zdG9yZU1vZGUgPT0gInVubGltaXRlZCIpCnsKICAgIHRhZ3Muc3RvcmVNb2RlID0gImxpbWl0ZWQiOwoKICAgIGNvbnN0IG1heENvdW50ID0gYXdhaXQgb3Muc2hvd0lucHV0KDEsIHsKICAgICAgICB0aXRsZTogJ2Nob29zZSBtYXgnCiAgICB9KTsKCiAgICBpZiAoIW1heENvdW50KQogICAgewogICAgICAgIG1heENvdW50ID0gMTsKICAgIH0KCiAgICB0YWdzLm1heENvdW50ID0gbWF4Q291bnQ7CgogICAgaWYgKHRhZ3MudGVtcGxhdGUpCiAgICB7CiAgICAgICAgbGV0IG5ld1N0b3JlSUQgPSB1dWlkKCk7CgogICAgICAgIHRhZ3MuYm90U3RvcmVJRCA9IG5ld1N0b3JlSUQ7CgogICAgICAgIGxpbmtzLnRlbXBsYXRlLnRhZ3MuYm90U3RvcmVJRCA9IG5ld1N0b3JlSUQ7CgogICAgICAgIHRhZ3MubGFiZWwgPSAxOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHRhZ3MubGFiZWwgPSAwOwogICAgfQp9CmVsc2UKewogICAgdGFncy5zdG9yZU1vZGUgPSAidW5saW1pdGVkIjsKCiAgICB0YWdzLmxhYmVsID0gbnVsbDsKICAgIHRhZ3MubWF4Q291bnQgPSBudWxsOwogICAgdGFncy50ZW1wbGF0ZUxvY2sgPSBudWxsOwogICAgdGFncy5ib3RTdG9yZUlEID0gbnVsbDsKfScA+fDpyQKHKBlpbml0aWF0ZUJvdFN0b3JlQW5pbWF0aW9uAgQA+fDpyQLfU4sBQGlmICghdGFncy5zdG9yZUludGVydmFsKQp7CiAgICB0aGlzQm90LmFuaW1hdGVCb3RTdG9yZSgpOwoKICAgIG1hc2tzLnN0b3JlSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzQm90LmFuaW1hdGVCb3RTdG9yZSgpLCAyMDAwKTsKfScA+fDpyQKHKA9hbmltYXRlQm90U3RvcmUCBAD58OnJAutUmgJAbGV0IHJvdFogPSBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsICsgIlJvdGF0aW9uWiI7CmxldCB0YXJnZXRSb3RhdGlvbiA9IDM2MCAqIE1hdGguUEkvMTgwOwoKYXdhaXQgYW5pbWF0ZVRhZyhsaW5rcy50ZW1wbGF0ZSwgcm90WiwgewogICAgZnJvbVZhbHVlOiAwLAogICAgdG9WYWx1ZTogdGFyZ2V0Um90YXRpb24sCiAgICBlYXNpbmc6ewogICAgICAgIG1vZGU6ICJpbm91dCIsCiAgICAgICAgdHlwZTogImxpbmVhciIKICAgIH0sCiAgICBkdXJhdGlvbjogMgp9KS5jYXRjaChlID0+IHt9KTsnAPnw6ckChygPb25JbnN0U3RyZWFtaW5nAgQA+fDpyQKGV0BAaWYgKHRhZ3MudGVtcGxhdGUpCnsKICAgIHRoaXNCb3QuaW5pdGlhdGVCb3RTdG9yZUFuaW1hdGlvbigpOwp9JwD58OnJAocoCW9uRGVzdHJveQIEAPnw6ckCx1cjQGNsZWFySW50ZXJ2YWwodGFncy5zdG9yZUludGVydmFsKTsnAQRib3RzJGQxNDAyMDRjLTU1YzctNGVjMy05MzU0LTkzYWU3NjI2YTgzNgEoAPnw6ckC61cGc2NhbGVaAXs/hHrhR64UeygA+fDpyQLrVwVzY2FsZQF7P+OFHrhR64UnAPnw6ckC61cFY29sb3ICBAD58OnJAu5XBGdyYXknAPnw6ckC61cLc3Ryb2tlQ29sb3ICBAD58OnJAvNXByM1RTU4ODAnAPnw6ckC61cJbGluZUNvbG9yAgQA+fDpyQL7VwcjNUU1ODgwKAD58OnJAutXCGR1cmF0aW9uAX0BJwD58OnJAutXCmVhc2luZ1R5cGUCBAD58OnJAoRYBmxpbmVhcicA+fDpyQLrVwplYXNpbmdNb2RlAgQA+fDpyQKLWAVpbm91dCcA+fDpyQLrVwlsaW5lU3R5bGUCBAD58OnJApFYBGxpbmUnAPnw6ckC61cGc3lzdGVtAgQA+fDpyQKWWBJhYi0xLmZhY3RvcnkudHJhY2snAPnw6ckC61cKYWIxRmFjdG9yeQIEAPnw6ckCqVgEdHJ1ZScA+fDpyQLrVwlhYjFJZ25vcmUCBAD58OnJAq5YBHRydWUnAPnw6ckC61cLdG9vbE1hbmFnZXICBAD58OnJArNYKPCflJcxNGUxZmRhYy1jZmQ3LTRlN2UtYmRkMS05NjdhNDA4NWE3NTUnAPnw6ckC61cLZmFjdG9yeUljb24CBAD58OnJAtpYCHRpbWVsaW5lKAD58OnJAutXDWFiMUJvdFZlcnNpb24BfQonAPnw6ckC61cIb25DcmVhdGUCBAD58OnJAuRYb0B0YWdzLmNvbG9yID0gImNsZWFyIjsKCmlmICghdGFncy5saW5lVG8pCnsKICAgIHRoaXNCb3QuYWRkVHJhY2tOb2RlKHtkaW1lbnNpb246IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWx9KTsKfScA+fDpyQLrVwxhZGRUcmFja05vZGUCBAD58OnJAtRZ1wVAbGV0IGJvdE1vZCA9IGdldE1vZCh0aGlzQm90KTsKCmJvdE1vZFt0aGF0LmRpbWVuc2lvbiArICJZIl0gPSBib3RNb2RbdGhhdC5kaW1lbnNpb24gKyAiWSJdIC0gMzsKCmJvdE1vZC5saW5lVG8gPSB0aGlzQm90LmlkOwpib3RNb2QuY3JlYXRvciA9IHRoaXNCb3QuaWQ7CgpsZXQgbm9kZTIgPSBjcmVhdGUoYm90TW9kKTsKCnRhZ3MubGluZVRvID0gbm9kZTIuaWQ7CnRhZ3MuY3JlYXRvciA9IG5vZGUyLmlkOwoKbGV0IG5vZGUzID0gY3JlYXRlKGJvdE1vZCk7Cgpib3RNb2RbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gYm90TW9kW3RoYXQuZGltZW5zaW9uICsgIlgiXSArIDM7CgpsZXQgbm9kZTQgPSBjcmVhdGUoYm90TW9kKTsKCm5vZGUzLnRhZ3MubGluZVRvID0gbm9kZTQuaWQ7Cm5vZGUzLnRhZ3MuY3JlYXRvciA9IG5vZGU0LmlkOwpub2RlNC50YWdzLmxpbmVUbyA9IG5vZGUzLmlkOwpub2RlNC50YWdzLmNyZWF0b3IgPSBub2RlMy5pZDsKCmxldCBub2RlNSA9IGNyZWF0ZShib3RNb2QpOwoKYm90TW9kW3RoYXQuZGltZW5zaW9uICsgIlkiXSA9IGJvdE1vZFt0aGF0LmRpbWVuc2lvbiArICJZIl0gLSAzOwoKbGV0IG5vZGU2ID0gY3JlYXRlKGJvdE1vZCk7Cgpub2RlNS50YWdzLmxpbmVUbyA9IG5vZGU2LmlkOwpub2RlNS50YWdzLmNyZWF0b3IgPSBub2RlNi5pZDsKbm9kZTYudGFncy5saW5lVG8gPSBub2RlNS5pZDsKbm9kZTYudGFncy5jcmVhdG9yID0gbm9kZTUuaWQ7JwD58OnJAutXDGFiMVRyYWNrTm9kZQIEAPnw6ckCrF8EdHJ1ZScA+fDpyQLrVwlsaXN0ZW5pbmcCBAD58OnJArFfBWZhbHNlJwD58OnJAutXBm9uRHJvcAIEAPnw6ckCt1+XBUBpZiAodGhhdC5kcmFnQm90LnRhZ3MuYWIxVHJhY2tOb2RlKQp7CiAgICB0YWdzW2NvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgKyAiWCJdID0gTWF0aC5yb3VuZCh0YWdzW2NvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgKyAiWCJdKTsKICAgIHRhZ3NbY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCArICJZIl0gPSBNYXRoLnJvdW5kKHRhZ3NbY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCArICJZIl0pOwoKICAgIHJldHVybjsKfQplbHNlIGlmICh0aGF0LmRyYWdCb3QudGFncy5mYWN0b3J5SWNvbiA9PSAiaGVsaXgiKQp7CiAgICB0aGlzQm90LmFwcGx5TW9kVG9UcmFja05vZGUodGhhdCk7CgogICAgdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJYIl0gPSB0aGF0LmZyb20ueDsKICAgIHRoYXQuZHJhZ0JvdC50YWdzW3RoYXQuZnJvbS5kaW1lbnNpb24gKyAiWSJdID0gdGhhdC5mcm9tLnk7CgogICAgcmV0dXJuOwp9Cgp0aGF0LmRyYWdCb3QubWFza3Mub25EcmFnID0gIkAgY2xlYXJUaW1lb3V0KHRhZ3MudHJhY2tUaW1lb3V0KTsgY2xlYXJBbmltYXRpb25zKHRoaXNCb3QpOyI7Cgp0aGlzQm90LmFuaW1hdGVUcmFjayh7YW5pbWF0ZWRCb3Q6IHRoYXQuZHJhZ0JvdCwgdGFyZ2V0Tm9kZTogZ2V0Qm90KCJpZCIsIHRhZ3MubGluZVRvKX0pOycA+fDpyQLrVwxhbmltYXRlVHJhY2sCBAD58OnJAs9kkA1AbGV0IGN1cnJlbnREaW0gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwpsZXQgYW5pbWF0ZWRCb3QgPSB0aGF0LmFuaW1hdGVkQm90OwpsZXQgbmV4dE5vZGUgPSB0aGF0LnRhcmdldE5vZGU7CmxldCBvcmlnaW5Ob2RlID0gdGhpc0JvdDsKCmlmIChuZXh0Tm9kZS5pZCA9PSB0aGlzQm90LmlkKQp7CiAgICBsZXQgbm9kZVN0YWNrID0gZ2V0Qm90cyhieU1vZCh7YWIxVHJhY2tOb2RlOiB0cnVlLCBbY3VycmVudERpbV06IHRydWUsIFtjdXJyZW50RGltICsgIlgiXTogdGFnc1tjdXJyZW50RGltICsgIlgiXSwgW2N1cnJlbnREaW0gKyAiWSJdOiB0YWdzW2N1cnJlbnREaW0gKyAiWSJdfSkpOwoKICAgIGlmIChub2RlU3RhY2subGVuZ3RoID49IDMpCiAgICB7CiAgICAgICAgb3JpZ2luTm9kZSA9IG5vZGVTdGFja1ttYXRoLnJhbmRvbUludCgwLCBub2RlU3RhY2subGVuZ3RoKV07CgogICAgICAgIG5leHROb2RlID0gZ2V0Qm90KCJpZCIsIG9yaWdpbk5vZGUudGFncy5saW5lVG8pOwogICAgfQogICAgZWxzZSBpZiAobm9kZVN0YWNrLmxlbmd0aCA+IDEpCiAgICB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlU3RhY2subGVuZ3RoOyBpKyspCiAgICAgICAgewogICAgICAgICAgICBpZiAobm9kZVN0YWNrW2ldLmlkICE9IHRoaXNCb3QuaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9yaWdpbk5vZGUgPSBub2RlU3RhY2tbaV07CgogICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBnZXRCb3QoImlkIiwgb3JpZ2luTm9kZS50YWdzLmxpbmVUbyk7CgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbmV4dE5vZGUgPSBnZXRCb3QoImlkIiwgdGFncy5saW5lVG8pOwogICAgfQp9CgphbmltYXRlZEJvdC5tYXNrcy50cmFja1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpPT4gd2hpc3BlcihuZXh0Tm9kZSwgImFuaW1hdGVUcmFjayIsIHthbmltYXRlZEJvdDogYW5pbWF0ZWRCb3QsIHRhcmdldE5vZGU6IG5leHROb2RlfSksIHRhZ3MuZHVyYXRpb24gKiAxMDAwKTsKCmlmIChvcmlnaW5Ob2RlLnRhZ3MubW9kcykKewogICAgYXBwbHlNb2QoYW5pbWF0ZWRCb3QsIG9yaWdpbk5vZGUudGFncy5tb2RzKTsKfQoKYXdhaXQgYW5pbWF0ZVRhZyhhbmltYXRlZEJvdCwgewogICAgZnJvbVZhbHVlOiB7CiAgICAgICAgW2N1cnJlbnREaW0gKyAiWCJdOiBvcmlnaW5Ob2RlLnRhZ3NbY3VycmVudERpbSArICJYIl0sCiAgICAgICAgW2N1cnJlbnREaW0gKyAiWSJdOiBvcmlnaW5Ob2RlLnRhZ3NbY3VycmVudERpbSArICJZIl0KICAgIH0sCiAgICB0b1ZhbHVlOiB7CiAgICAgICAgW2N1cnJlbnREaW0gKyAiWCJdOiBuZXh0Tm9kZS50YWdzW2N1cnJlbnREaW0gKyAiWCJdLAogICAgICAgIFtjdXJyZW50RGltICsgIlkiXTogbmV4dE5vZGUudGFnc1tjdXJyZW50RGltICsgIlkiXQogICAgfSwKICAgIGR1cmF0aW9uOiB0YWdzLmR1cmF0aW9uLAogICAgZWFzaW5nOnsKICAgICAgICB0eXBlOiB0YWdzLmVhc2luZ1R5cGUsCiAgICAgICAgbW9kZTogdGFncy5lYXNpbmdNb2RlCiAgICB9LAogICAgdGFnTWFza1NwYWNlOiAidGVtcExvY2FsIgp9KS5jYXRjaChlID0+IHt9KTsnAPnw6ckC61cHb25DbGljawIEAPnw6ckC4HHXCEBzaG91dCgiYWIxVHJhY2tNZW51UmVzZXQiKTsKCmNvbnN0IG1lbnVUeXBlID0gdGhhdC5tZW51VHlwZSA/IHRoYXQubWVudVR5cGUgOiAiYmFzZSI7CmNvbnN0IG1lbnVUYWcgPSB0YWdzW21lbnVUeXBlICsgIkFCMVRyYWNrTWVudSJdOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWIxVHJhY2tNZW51IjsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgc2hvdXQoImFiMVRyYWNrTWVudVJlc2V0Iik7YDsKbWFza3MuYWIxVHJhY2tNZW51UmVzZXQgPSBgQCBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CgpjbGVhclRhZ01hc2tzKHRoaXNCb3QpO2A7CgpsZXQgbWVudUJ1dHRvbiA9IHt9OwoKbWVudUJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwptZW51QnV0dG9uLmFiMVRyYWNrTWVudSA9IHRydWU7Cm1lbnVCdXR0b24uYWIxVHJhY2tNZW51UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IHsiYm9yZGVyLXJhZGl1cyI6IjhweCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWxDb2xvciA9ICIjZmZmZmZmIjsKbWVudUJ1dHRvbi5jb2xvciA9IHRhZ3Muc3Ryb2tlQ29sb3I7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cgpmb3IgKGxldCBpID0gMDsgaSA8IHRhZ3NbbWVudVR5cGUgKyAiQUIxVHJhY2tNZW51Il0ubGVuZ3RoOyBpKyspCnsKICAgIGNyZWF0ZShtZW51QnV0dG9uLCB0YWdzW21lbnVUeXBlICsgIkFCMVRyYWNrTWVudSJdW2ldKTsKfQoKaWYgKHRhZ3MubW9kcykKewogICAgbWVudUJ1dHRvbi5sYWJlbCA9ICJyZW1vdmUgbW9kIjsKICAgIG1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiaGVsaXgiOwogICAgbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubWFuYWdlci50YWdzLm1vZHMgPSBudWxsOwogICAgbGlua3MubWFuYWdlci50YWdzLmNvbG9yID0gImNsZWFyIjsKICAgIGxpbmtzLm1hbmFnZXIudGFncy5mb3JtID0gbnVsbDsKICAgIAogICAgc2hvdXQoJ2FiMVRyYWNrTWVudVJlc2V0Jyk7YDsKCiAgICBjcmVhdGUobWVudUJ1dHRvbik7Cn0nAPnw6ckC61cQYmFzZUFCMVRyYWNrTWVudQIEAPnw6ckCuHrVAvCfp6xbeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci51cGRhdGVUcmFja0R1cmF0aW9uKCk7IiwgImZvcm1BZGRyZXNzIjogImF2X3RpbWVyIiwgImxhYmVsIjogImR1cmF0aW9uIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIub25DbGljayh7bWVudVR5cGU6ICdlYXNpbmcnfSk7IiwgImZvcm1BZGRyZXNzIjogInRyZW5kaW5nX2ZsYXQiLCAibGFiZWwiOiAiZWFzaW5nIHR5cGUifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci5vbkNsaWNrKHttZW51VHlwZTogJ21vZGUnfSk7IiwgImZvcm1BZGRyZXNzIjogInRyZW5kaW5nX3VwIiwgImxhYmVsIjogImVhc2luZyBtb2RlIn1dJwD58OnJAutXE3VwZGF0ZVRyYWNrRHVyYXRpb24CBAD58OnJAox9owFAc2hvdXQoImFiMVRyYWNrTWVudVJlc2V0Iik7CgpsZXQgaW5wdXQgPSBhd2FpdCBvcy5zaG93SW5wdXQodGFncy5kdXJhdGlvbiwgewogICAgdGl0bGU6ICJkdXJhdGlvbiIKfSk7CgppZiAoaW5wdXQgJiYgIWlzTmFOKGlucHV0KSkKewogICAgdGFncy5kdXJhdGlvbiA9IGlucHV0Owp9JwD58OnJAutXEmVhc2luZ0FCMVRyYWNrTWVudQIEAPnw6ckCsH73CfCfp6xbeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWIxVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAibGluZWFyIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIudGFncy5lYXNpbmdUeXBlID0gdGFncy5sYWJlbDsgc2hvdXQoJ2FiMVRyYWNrTWVudVJlc2V0Jyk7IiwgImZvcm1BZGRyZXNzIjogImFycm93X3JpZ2h0IiwgImxhYmVsIjogInF1YWRyYXRpYyJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJjdWJpYyJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJxdWFydGljIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIudGFncy5lYXNpbmdUeXBlID0gdGFncy5sYWJlbDsgc2hvdXQoJ2FiMVRyYWNrTWVudVJlc2V0Jyk7IiwgImZvcm1BZGRyZXNzIjogImFycm93X3JpZ2h0IiwgImxhYmVsIjogInF1aW50aWMifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWIxVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAic2ludXNvaWRhbCJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJleHBvbmVudGlhbCJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJjaXJjdWxhciJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJlbGFzdGljIn1dJwD58OnJAutXEG1vZGVBQjFUcmFja01lbnUCBAD58OnJAqaIAZ0D8J+nrFt7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nTW9kZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJpbiJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nTW9kZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYjFUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJvdXQifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ01vZGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWIxVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAiaW5vdXQifV0nAPnw6ckC61cTYXBwbHlNb2RUb1RyYWNrTm9kZQIEAPnw6ckCwosB9QFAbGV0IGJvdE1vZCA9IHRoYXQuZHJhZ0JvdC50YWdzLm1vZHM7Cgp0YWdzLm1vZHMgPSBib3RNb2Q7CnRhZ3MuY29sb3IgPSB0YWdzLnN0cm9rZUNvbG9yOwp0YWdzLmZvcm0gPSAic3ByaXRlIjsKdGFncy5mb3JtQWRkcmVzcyA9ICJodHRwczovL2J1aWxkZXItbHRtLWZpbGVzLnMzLmFtYXpvbmF3cy5jb20vYjYzNTJlZGI4ODU5OGExOTY5YTY0OGY3ZGQ2ZDQxODIzM2VmMTE1OWJkNzhiNzM3Y2YyMGEzZGE1NDA1ZDFjNC5wbmciOycBBGJvdHMkZWI3NWY1NWEtMmJiOS00MzcyLWJmOGMtY2NiYWM4NjM5MGZmAScA+fDpyQK4jQEFY29sb3ICBAD58OnJArmNAQcjN0I2NEZGJwD58OnJAriNAQlkaW1lbnNpb24CBAD58OnJAsGNAQRob21lJwD58OnJAriNAQRmb3JtAgQA+fDpyQLGjQEDaGV4KAD58OnJAriNAQVzY2FsZQF9AicA+fDpyQK4jQEGc2NhbGVaAgQA+fDpyQLLjQEEMC43NScA+fDpyQK4jQEHb25DbGljawIEAPnw6ckC0I0BGkB0aGlzQm90Lm9wZW5Qb3J0YWwodGhhdCk7JwD58OnJAriNAQ5vblBvaW50ZXJFbnRlcgIEAPnw6ckC640BE0BtYXNrcy5zY2FsZSA9IDIuMTsnAPnw6ckCuI0BC29uRHJvcEVudGVyAgQA+fDpyQL/jQFqQGlmICh0aGF0LmRyYWdCb3QuaWQgIT0gdGhpc0JvdC5pZCkgLy9NQVlCRSBNQUtFIEEgV0FZIEZPUiBBQi0xIFRPIE5PVCBJTlRFUkFDVAp7CiAgICB0aGlzQm90Lm9uQ2xpY2soKTsKfScA+fDpyQK4jQEGc3lzdGVtAgQA+fDpyQLqjgETYWItMS5mYWN0b3J5LnBvcnRhbCcA+fDpyQK4jQENb25Qb2ludGVyRXhpdAIEAPnw6ckC/o4BFEBtYXNrcy5zY2FsZSA9IG51bGw7KAD58OnJAriNAQ1hYjFCb3RWZXJzaW9uAX0FJwD58OnJAriNAQphYjFGYWN0b3J5AgQA+fDpyQKUjwEEdHJ1ZScA+fDpyQK4jQEJYWIxSWdub3JlAgQA+fDpyQKZjwEEdHJ1ZScA+fDpyQK4jQELdG9vbE1hbmFnZXICBAD58OnJAp6PASjwn5SXMTRlMWZkYWMtY2ZkNy00ZTdlLWJkZDEtOTY3YTQwODVhNzU1JwD58OnJAriNAQlsaXN0ZW5pbmcCBAD58OnJAsWPAQVmYWxzZScA+fDpyQK4jQELZmFjdG9yeUljb24CBAD58OnJAsuPAQV0b3BpYycA+fDpyQK4jQEKb3BlblBvcnRhbAIEAPnw6ckC0Y8BpTBAY29uc3QgY3VycmVudERpbSA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CmNvbnN0IGEgPSBNYXRoLlBJIC8gNjsKY29uc3QgaGV4U2NhbGUgPSA1Owpjb25zdCBwb3J0YWxEaW1lbnNpb24gPSB0YWdzLnBvcnRhbEFkZHJlc3M7CgpsZXQgaGV4ID0ge307CmxldCBoZXhOdW0gPSAxOwoKaGV4LnNwYWNlID0gInRlbXBMb2NhbCI7CmhleC5wb3J0YWxSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKaGV4LmZvcm0gPSAiaGV4IjsKaGV4LmNvbG9yID0gdGFncy5jb2xvcjsKaGV4Lm9yaWdpbiA9IHRoaXNCb3QuaWQ7CmhleC5wb3J0YWxIZXggPSB0cnVlOwpoZXhbY3VycmVudERpbSsiWiJdID0gLTE7CmhleC5hbmNob3JQb2ludCA9ICJ0b3AiOwpoZXguc2NhbGUgPSA0LjU7CmhleFtjdXJyZW50RGltXSA9IHRydWU7CmhleC5wb2ludGFibGUgPSBmYWxzZTsKaGV4LnNjYWxlWiA9IDAuMDE7CmhleC5hbmltYXRlID0gYEAgYW5pbWF0ZVRhZyh0aGlzQm90LCAic2NhbGUiLCB7CiAgICBmcm9tVmFsdWU6IHRhZ3Muc2NhbGUsCiAgICB0b1ZhbHVlOiBbdGhhdF0sCiAgICBlYXNpbmc6IHsKICAgICAgICB0eXBlOiAicXVhZHJhdGljIiwKICAgICAgICBtb2RlOiAib3V0IgogICAgfSwKICAgIGR1cmF0aW9uOiAwLjMKfSkuY2F0Y2goZSA9PiB7IH0pO2A7CgpsZXQgZGltZW5zaW9uQm90cyA9IGdldEJvdHMocG9ydGFsRGltZW5zaW9uLCB0cnVlKTsKbGV0IHJpbmdOdW07CgppZiAoZGltZW5zaW9uQm90cy5sZW5ndGggPiAwKQp7CiAgICBsZXQgeFBhcmFtZXRlciA9IGRpbWVuc2lvbkJvdHMuc29ydCgoYSwgYik9PiBNYXRoLmFicyhiLnRhZ3NbcG9ydGFsRGltZW5zaW9uKyJYIl0pIC0gTWF0aC5hYnMoYS50YWdzW3BvcnRhbERpbWVuc2lvbisiWCJdKSlbMF0udGFnc1twb3J0YWxEaW1lbnNpb24rIlgiXTsKICAgIGxldCB5UGFyYW1ldGVyID0gZGltZW5zaW9uQm90cy5zb3J0KChhLCBiKT0+IE1hdGguYWJzKGIudGFnc1twb3J0YWxEaW1lbnNpb24rIlkiXSkgLSBNYXRoLmFicyhhLnRhZ3NbcG9ydGFsRGltZW5zaW9uKyJZIl0pKVswXS50YWdzW3BvcnRhbERpbWVuc2lvbisiWSJdOwoKCiAgICBsZXQgZGlzdGFuY2UgPSBNYXRoLmZsb29yKE1hdGguc3FydChNYXRoLnBvdyhNYXRoLmZsb29yKE1hdGguYWJzKHhQYXJhbWV0ZXIgLSAwKSksIDIpICsgTWF0aC5wb3coTWF0aC5mbG9vcihNYXRoLmFicyh5UGFyYW1ldGVyIC0gMCkpLCAyKSkgLyBoZXhTY2FsZSkgKyAxOwogICAgcmluZ051bSA9IDYgKiAoZGlzdGFuY2UpKihkaXN0YW5jZSsxKS8yICsgMTsKCiAgICBpZiAocmluZ051bSA+IDM5NykKICAgIHsKICAgICAgICByaW5nTnVtID0gMzk3OwogICAgfQp9CmVsc2UKewogICAgcmluZ051bSA9IDc7Cn0KCm1hc2tzLnNjYWxlID0gMC4xOwptYXNrcy5wb2ludGFibGUgPSBmYWxzZTsKCmxldCBwcmV2aW91c0hleDsKCmZvciAobGV0IGkgPSAwOyBpIDwgcmluZ051bTsgaSsrKQp7CiAgICBpZiAoaSAhPSAwKQogICAgewogICAgICAgIGxldCBlbXB0eVBvcyA9IGF3YWl0IGNoZWNrSGV4UG9zKHByZXZpb3VzSGV4LCBjdXJyZW50RGltKTsKCiAgICAgICAgaWYgKGVtcHR5UG9zID09IDAgfHwgZW1wdHlQb3MgPT0gMykKICAgICAgICB7CiAgICAgICAgICAgIHZhciB4ID0gcHJldmlvdXNIZXgudGFnc1tjdXJyZW50RGltKyJYIl07CiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgZmxpcFggPSAxOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGVtcHR5UG9zID09IDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmbGlwWSA9IDA7CiAgICAgICAgICAgICAgICB2YXIgeSA9IHByZXZpb3VzSGV4LnRhZ3NbY3VycmVudERpbSsiWSJdICsgaGV4U2NhbGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZmxpcFkgPSAtMTsKICAgICAgICAgICAgICAgIHZhciB5ID0gcHJldmlvdXNIZXgudGFnc1tjdXJyZW50RGltKyJZIl0gLSBoZXhTY2FsZS8yOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHZhciB4ID0gcHJldmlvdXNIZXgudGFnc1tjdXJyZW50RGltKyJYIl0gKyAoaGV4U2NhbGUgKiAwLjg1KTsKICAgICAgICAgICAgdmFyIHkgPSBwcmV2aW91c0hleC50YWdzW2N1cnJlbnREaW0rIlkiXTsKCiAgICAgICAgICAgIGlmIChlbXB0eVBvcyA9PSAxKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZmxpcFggPSAxOwogICAgICAgICAgICAgICAgdmFyIGZsaXBZID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChlbXB0eVBvcyA9PSAyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZmxpcFggPSAxOwogICAgICAgICAgICAgICAgdmFyIGZsaXBZID0gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoZW1wdHlQb3MgPT0gNCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgeCA9IHByZXZpb3VzSGV4LnRhZ3NbY3VycmVudERpbSsiWCJdIC0gKGhleFNjYWxlICogMC44NSk7CgogICAgICAgICAgICAgICAgdmFyIGZsaXBYID0gMTsKICAgICAgICAgICAgICAgIHZhciBmbGlwWSA9IC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGVtcHR5UG9zID09IDUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHggPSBwcmV2aW91c0hleC50YWdzW2N1cnJlbnREaW0rIlgiXSAtIChoZXhTY2FsZSAqIDAuODUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgZmxpcFggPSAxOwogICAgICAgICAgICAgICAgdmFyIGZsaXBZID0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaGV4W2N1cnJlbnREaW0rIlgiXSA9IHggKiBmbGlwWDsKICAgICAgICBoZXhbY3VycmVudERpbSsiWSJdID0geSArIGZsaXBZICogaGV4U2NhbGUvMjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBoZXhbY3VycmVudERpbSsiWCJdID0gdGFnc1tjdXJyZW50RGltKyJYIl07CiAgICAgICAgaGV4W2N1cnJlbnREaW0rIlkiXSA9IHRhZ3NbY3VycmVudERpbSsiWSJdOwogICAgfQoKICAgIGhleC5oZXhOdW0gPSBoZXhOdW07CgogICAgbGV0IG5lYXJieVBvcnRhbEJvdCA9IGdldEJvdChieU1vZCh7Ly9iZWluZyBtaXJyb3JlZCByaWdodCBub3cKICAgICAgICBbcG9ydGFsRGltZW5zaW9uXTogdHJ1ZSwKICAgICAgICBbcG9ydGFsRGltZW5zaW9uKyJYIl06IHggPT4geCA+IChoZXhbY3VycmVudERpbSsiWCJdIC0gdGFnc1tjdXJyZW50RGltKyJYIl0pIC0gaGV4U2NhbGUgJiYgeCA8IChoZXhbY3VycmVudERpbSsiWCJdIC0gdGFnc1tjdXJyZW50RGltKyJYIl0pICsgaGV4U2NhbGUsCiAgICAgICAgW3BvcnRhbERpbWVuc2lvbisiWSJdOiB5ID0+IHkgPiAoaGV4W2N1cnJlbnREaW0rIlkiXSAtIHRhZ3NbY3VycmVudERpbSsiWSJdKSAtIGhleFNjYWxlICYmIHkgPCAoaGV4W2N1cnJlbnREaW0rIlkiXSAtIHRhZ3NbY3VycmVudERpbSsiWSJdKSArIGhleFNjYWxlCiAgICB9KSk7CgogICAgaWYgKG5lYXJieVBvcnRhbEJvdCB8fCBpIDwgNykKICAgIHsKICAgICAgICBoZXgub25Qb3J0YWxDb21wbGV0ZSA9IGZhbHNlOwogICAgICAgIGhleC5jb2xvciA9IHRhZ3MuY29sb3I7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgaGV4Lm9uUG9ydGFsQ29tcGxldGUgPSB0cnVlOwogICAgICAgIGhleC5jb2xvciA9ICJjbGVhciI7CiAgICB9CgogICAgaGV4TnVtKys7CgogICAgcHJldmlvdXNIZXggPSBhd2FpdCBjcmVhdGUoaGV4KTsKfQoKbGV0IG5vblBvcnRhbEhleGVzID0gZ2V0Qm90cygib25Qb3J0YWxDb21wbGV0ZSIsIHRydWUpOwpsZXQgcG9ydGFsSGV4ZXMgPSBnZXRCb3RzKCJvblBvcnRhbENvbXBsZXRlIiwgZmFsc2UpOwoKZm9yIChsZXQgbiA9IDA7IG4gPCBub25Qb3J0YWxIZXhlcy5sZW5ndGg7IG4rKykKewogICAgZGVzdHJveShub25Qb3J0YWxIZXhlc1tuXSk7Cn0KCndoaXNwZXIocG9ydGFsSGV4ZXMsICJhbmltYXRlIiwgaGV4U2NhbGUpOwoKbWFza3MuZm9ybSA9ICJwb3J0YWwiOwptYXNrcy5mb3JtQWRkcmVzcyA9IHRhZ3MucG9ydGFsQWRkcmVzczsKbWFza3MucG9ydGFsSGV4Qm90cyA9IGdldExpbmsocG9ydGFsSGV4ZXMpOwoKdGhpc0JvdC5wb3J0YWxNZW51KCk7CgpmdW5jdGlvbiBjaGVja0hleFBvcyhoZXgsIGRpbWVuc2lvbikKewogICAgbGV0IHNjYWxlVmFyID0gaGV4U2NhbGUvMjsKICAgIGxldCB4UG9zID0gaGV4LnRhZ3NbZGltZW5zaW9uKyJYIl07CiAgICBsZXQgeVBvcyA9IGhleC50YWdzW2RpbWVuc2lvbisiWSJdOwogICAgbGV0IGhleE1hdGhWYXIgPSBNYXRoLlBJIC8gNjsKICAgIGxldCB4U3BhY2luZ1BsdXMgPSB4UG9zICsgc2NhbGVWYXIgKyAoMSArIE1hdGguY29zKGhleE1hdGhWYXIpKTsKICAgIGxldCB4U3BhY2luZ01pbnVzID0geFBvcyAtIChzY2FsZVZhciArICgxICsgTWF0aC5jb3MoaGV4TWF0aFZhcikpKTsKICAgIGxldCB5U3BhY2luZ1RvcCA9IE1hdGguZmxvb3IoaGV4LnRhZ3Muc2NhbGUpICsgeVBvczsKICAgIGxldCB5U3BhY2luZ1VwID0geVBvcyArIHNjYWxlVmFyICogTWF0aC5zaW4oaGV4TWF0aFZhcik7CiAgICBsZXQgeVNwYWNpbmdEb3duID0geVBvcyAtIHNjYWxlVmFyICogTWF0aC5zaW4oaGV4TWF0aFZhcik7CiAgICBsZXQgeVNwYWNpbmdCb3R0b20gPSB5UG9zIC0gTWF0aC5mbG9vcihoZXgudGFncy5zY2FsZSk7CiAgICBsZXQgeENoZWNrID0gW3hQb3MsIHhTcGFjaW5nUGx1cywgeFNwYWNpbmdQbHVzLCB4UG9zLCB4U3BhY2luZ01pbnVzLCB4U3BhY2luZ01pbnVzXTsKICAgIGxldCB5Q2hlY2sgPSBbeVNwYWNpbmdUb3AsIHlTcGFjaW5nVXAsIHlTcGFjaW5nRG93biwgeVNwYWNpbmdCb3R0b20sIHlTcGFjaW5nRG93biwgeVNwYWNpbmdVcF07CiAgICBsZXQgdG90YWxOZWlnaGJvcnMgPSAwOwogICAgbGV0IG5laWdoYm9yQXJyYXkgPSBbXQoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKQogICAgewogICAgICAgIGxldCBoZXhOZWlnaGJvciA9IGdldEJvdChieU1vZCh7CiAgICAgICAgICAgIFtkaW1lbnNpb25dOiB0cnVlLCAKICAgICAgICAgICAgW2RpbWVuc2lvbisiWCJdOiB4ID0+IHggPiB4Q2hlY2tbaV0gLSBzY2FsZVZhciAmJiB4IDwgeENoZWNrW2ldICsgc2NhbGVWYXIsIAogICAgICAgICAgICBbZGltZW5zaW9uKyJZIl06IHkgPT4geSA+IHlDaGVja1tpXSAtIHNjYWxlVmFyICYmIHkgPCB5Q2hlY2tbaV0gKyBzY2FsZVZhciwKICAgICAgICAgICAgb3JpZ2luOiBoZXgudGFncy5vcmlnaW4sCiAgICAgICAgICAgIHBvcnRhbEhleDogdHJ1ZQogICAgICAgIH0pKTsKCiAgICAgICAgaWYgKCFoZXhOZWlnaGJvcikKICAgICAgICB7CiAgICAgICAgICAgIG5laWdoYm9yQXJyYXkucHVzaCgiZW1wdHkiKTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgbmVpZ2hib3JBcnJheS5wdXNoKGhleE5laWdoYm9yKTsKICAgICAgICAgICAgdG90YWxOZWlnaGJvcnMrKzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKHRvdGFsTmVpZ2hib3JzID09IDApCiAgICB7CiAgICAgICAgdmFyIHRhcmdldCA9IDA7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdmFyIGVtcHR5ID0gZmFsc2U7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNjsgaisrKQogICAgICAgIHsKICAgICAgICAgICAgbGV0IG5leHRFbXB0eSA9IG5laWdoYm9yQXJyYXlbal07CgogICAgICAgICAgICBpZiAobmV4dEVtcHR5ID09ICJlbXB0eSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGVtcHR5ID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoaiA9PSA1KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSA1OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKG5leHRFbXB0eSAhPSAiZW1wdHkiICYmIGVtcHR5KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gai0xOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gdGFyZ2V0Owp9JwD58OnJAriNAQlwb2ludGFibGUCBAD58OnJAve/AQR0cnVlJwD58OnJAriNAQtvbkdyaWRDbGljawIEAPnw6ckC/L8BkwFAaWYgKHRhZ3MuZm9ybSAhPSAicG9ydGFsIikKewogICAgcmV0dXJuOwp9CgpsZXQgcG9ydGFsQ2xpY2sgPSB0aGlzQm90LnBvcnRhbFBvc2l0aW9uQ2hlY2sodGhhdCk7CgppZiAoIXBvcnRhbENsaWNrKQp7CiAgICB0aGlzQm90LmNsb3NlUG9ydGFsKCk7Cn0nAPnw6ckCuI0BC2Nsb3NlUG9ydGFsAgQA+fDpyQKQwQFqQHdoaXNwZXIobGlua3MucG9ydGFsSGV4Qm90cywgInBvcnRhbFJlc2V0Iik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CgpjbGVhclRhZ01hc2tzKHRoaXNCb3QpOycA+fDpyQK4jQEKcG9ydGFsTWVudQIEAPnw6ckC+8EB5wdAc2hvdXQoImFiMVBvcnRhbE1lbnVSZXNldCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWIxUG9ydGFsTWVudSI7CgpsZXQgbWVudUJ1dHRvbiA9IHt9OwoKbWVudUJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwptZW51QnV0dG9uLmFiMVBvcnRhbE1lbnUgPSB0cnVlOwptZW51QnV0dG9uLmFiMVBvcnRhbE1lbnVSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbi5jb2xvciA9IHRhZ3MuY29sb3I7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IGDwn6esIHsiYm9yZGVyLXJhZGl1cyI6ICI5cHggOXB4IDlweCA5cHgiLCAibWFyZ2luLXRvcCI6ICI2cHgifWA7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAiY2VudGVyIjsKbWVudUJ1dHRvbi5sYWJlbCA9IHRhZ3MucG9ydGFsQWRkcmVzczsKCmNyZWF0ZShtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZWRpdCI7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWwgPSAiZWRpdCBkaW1lbnNpb24iOwptZW51QnV0dG9uLnRhcmdldCA9IHRoaXNCb3QuaWQ7Cm1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIucG9ydGFsQ2hhbmdlRGltZW5zaW9uKCk7YDsKCmNyZWF0ZShtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYXJyb3dfZm9yd2FyZCI7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWwgPSAiZ28gdG8gZGltZW5zaW9uIjsKbWVudUJ1dHRvbi50YXJnZXQgPSB0YWdzLmZvcm1BZGRyZXNzOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWIxUG9ydGFsTWVudVJlc2V0Iik7Cgpjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gbGlua3MubWFuYWdlci50YWdzLnBvcnRhbEFkZHJlc3M7YDsKCmNyZWF0ZShtZW51QnV0dG9uKTsnAPnw6ckCuI0BCG9uQ3JlYXRlAgQA+fDpyQLhyQE+QGlmICghdGFncy5wb3J0YWxBZGRyZXNzKQp7CiAgICB0YWdzLnBvcnRhbEFkZHJlc3MgPSB1dWlkKCk7Cn0nAPnw6ckCuI0BE3BvcnRhbFBvc2l0aW9uQ2hlY2sCBAD58OnJAqDKAaQWQGxldCBjdXJyZW50RGltID0gdGhhdC5kaW1lbnNpb24gPyB0aGF0LmRpbWVuc2lvbiA6IHRoYXQudG8uZGltZW5zaW9uOwpsZXQgcG9zWSA9IHRoYXQucG9zaXRpb24gPyB0aGF0LnBvc2l0aW9uLnkgOiB0aGF0LnRvLnk7CmxldCBwb3NYID0gdGhhdC5wb3NpdGlvbiA/IHRoYXQucG9zaXRpb24ueCA6IHRoYXQudG8ueDsKbGV0IHBvcnRhbEhleEJvdHMgPSBsaW5rcy5wb3J0YWxIZXhCb3RzOwpsZXQgcG9ydGFsRW50cnkgPSBmYWxzZTsKCmZvciAobGV0IGkgPSAwOyBpIDwgcG9ydGFsSGV4Qm90cy5sZW5ndGg7IGkrKykgCnsKICAgIGxldCBjdXJyZW50SGV4ID0gcG9ydGFsSGV4Qm90c1tpXTsKICAgIGxldCBtYXhZID0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWSJdICsgY3VycmVudEhleC50YWdzLnNjYWxlIC8gMjsKICAgIGxldCBtaW5ZID0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWSJdIC0gY3VycmVudEhleC50YWdzLnNjYWxlIC8gMjsKCiAgICBpZiAocG9zWSA8PSBtYXhZICYmIHBvc1kgPj0gbWluWSkgewoKICAgICAgICAvL1NFVFVQIEEgQ0hFQ0sgRk9SIFdIRU4gWCA9IERFQ0sgWAogICAgICAgIGxldCBtYXhYID0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWCJdICsgY3VycmVudEhleC50YWdzLnNjYWxlIC8gMiArIDAuNTsKICAgICAgICBsZXQgbWluWCA9IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlgiXSAtIGN1cnJlbnRIZXgudGFncy5zY2FsZSAvIDIgLSAwLjU7CgogICAgICAgIGlmIChwb3NYIDw9IG1heFggJiYgcG9zWCA+PSBtaW5YKSB7CiAgICAgICAgICAgIGlmIChwb3NYIDw9IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlgiXSArIDAuMyAmJiBwb3NYID49IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlgiXSAtIDAuMykvL25vdCBwZXJmZWN0IHBhcnQgb2YgYWxnCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChwb3NZID49IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlkiXSAtIGN1cnJlbnRIZXgudGFncy5zY2FsZSAvIDIgJiYgcG9zWSA8PSBjdXJyZW50SGV4LnRhZ3NbY3VycmVudERpbSArICJZIl0gKyBjdXJyZW50SGV4LnRhZ3Muc2NhbGUgLyAyKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3J0YWxFbnRyeSA9IHRydWU7CgogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgbWlkWCA9IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlgiXTsKICAgICAgICAgICAgbGV0IG1pZFkgPSBjdXJyZW50SGV4LnRhZ3NbY3VycmVudERpbSArICJZIl07CiAgICAgICAgICAgIGNvbnN0IGEgPSBNYXRoLnBvdyhjdXJyZW50SGV4LnRhZ3Muc2NhbGUgLyAyLCAyKTsKICAgICAgICAgICAgY29uc3QgYiA9IE1hdGgucG93KGEgLyAyLCAyKTsKICAgICAgICAgICAgY29uc3QgbWF4RGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5hYnMoYSAtIGIpKTsKICAgICAgICAgICAgbGV0IHNsb3BlOwoKICAgICAgICAgICAgaWYgKChwb3NYID4gbWlkWCAmJiBwb3NZID4gbWlkWSkgfHwgKHBvc1ggPCBtaWRYICYmIHBvc1kgPCBtaWRZKSkgCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHNsb3BlID0gKG1heFkgLSBtaW5ZKSAvIChtYXhYIC0gbWluWCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAocG9zWCA+IG1pZFgpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc2xvcGUgPSAobWF4WCAtIG1pblgpIC8gKG1heFkgLSBtaW5ZKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc2xvcGUgPSAxIC8gKG1heFggLSBtaW5YKSAvIChtYXhZIC0gbWluWSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBjMSA9IG1heFkgLSAobWF4WCAqIHNsb3BlKTsKICAgICAgICAgICAgbGV0IGMyID0gcG9zWSAtIChwb3NYICogc2xvcGUpOwogICAgICAgICAgICBsZXQgYWN0dWFsRGlzdGFuY2UgPSBNYXRoLmFicyhjMiAtIGMxKSAvIE1hdGguc3FydChNYXRoLnBvdyhzbG9wZSwgMikgKyAxKTsKCiAgICAgICAgICAgIGlmIChhY3R1YWxEaXN0YW5jZSA8PSBtYXhEaXN0YW5jZSkgCiAgICAgICAgICAgIHsgICAKICAgICAgICAgICAgICAgIHBvcnRhbEVudHJ5ID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvL05PVCBTVVJFIE9GIFRISVMgQ09ERVMgTkVFRD8KICAgIC8vIGlmICh0aGF0LnBvcnRhbElEKSAKICAgIC8vIHsKICAgIC8vICAgICBpZiAodGhhdC5wb3J0YWxJRCA9PSBjdXJyZW50SGV4LnRhZ3Mub3JpZ2luKSAKICAgIC8vICAgICB7CiAgICAvLyAgICAgICAgIHBvcnRhbEVudHJ5ID0gdHJ1ZTsKCiAgICAvLyAgICAgICAgIGJyZWFrOwogICAgLy8gICAgIH0KICAgIC8vIH0KfQoKLy8gbGV0IHBvcnRhbEJvdHMgPSBnZXRCb3RzKCJwb3J0YWxIZXhCb3RzIik7Ly9DSEVDSyBUTyBTRUUgSUYgVEhFUkUgQVJFIE9USEVSIE9QRU4gUE9SVEFMIChub3Qgc3VyZSBJIG5lZWQgdGhpcykKCi8vIGZvciAobGV0IGkgPSAwOyBpIDwgcG9ydGFsQm90cy5sZW5ndGg7IGkrKykgCi8vIHsKLy8gICAgIGlmIChwb3J0YWxCb3RzW2ldLmlkICE9IHRoaXNCb3QuaWQpIAovLyAgICAgewovLyAgICAgICAgIHdoaXNwZXIocG9ydGFsQm90c1tpXSwgImNsb3NlUG9ydGFsIik7Ci8vICAgICB9Ci8vIH0KCnJldHVybiBwb3J0YWxFbnRyeTsnAPnw6ckCuI0BDG9uQW55Qm90RHJvcAIEAPnw6ckCxeAB1QRAaWYgKHRoYXQuZHJhZ0JvdC5pZCA9PSB0aGlzQm90LmlkKQp7CiAgICBjbGVhckludGVydmFsKHRhZ3MuaW50ZXJ2YWwpOwoKICAgIG1hc2tzLmludGVydmFsID0gbnVsbDsKCiAgICByZXR1cm47Cn0KCmlmICh0YWdzLmZvcm0gIT0gInBvcnRhbCIpCnsKICAgIHJldHVybjsKfQoKY29uc3QgY3VycmVudERpbSA9IHRoYXQudG8uZGltZW5zaW9uOwpjb25zdCBwb3J0YWxEcm9wID0gYXdhaXQgdGhpc0JvdC5wb3J0YWxQb3NpdGlvbkNoZWNrKHRoYXQpOwoKaWYgKHBvcnRhbERyb3ApIAp7CiAgICBsZXQgbmV3RGltID0gdGFncy5wb3J0YWxBZGRyZXNzOwoKICAgIHRoYXQuZHJhZ0JvdC50YWdzW25ld0RpbV0gPSB0cnVlOwogICAgdGhhdC5kcmFnQm90LnRhZ3NbbmV3RGltICsgIlgiXSA9IHRoYXQuZHJhZ0JvdC50YWdzW2N1cnJlbnREaW0gKyAiWCJdIC0gdGFnc1tjdXJyZW50RGltICsgIlgiXTsKICAgIHRoYXQuZHJhZ0JvdC50YWdzW25ld0RpbSArICJZIl0gPSB0aGF0LmRyYWdCb3QudGFnc1tjdXJyZW50RGltICsgIlkiXSAtIHRhZ3NbY3VycmVudERpbSArICJZIl07CiAgICB0aGF0LmRyYWdCb3QudGFnc1tjdXJyZW50RGltXSA9IG51bGw7Cn0nAPnw6ckCuI0BBm9uRHJhZwIEAPnw6ckCm+UBXkBpZiAoIXRhZ3MuaW50ZXJ2YWwpCnsKICAgIG1hc2tzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpc0JvdC5wb3NpdGlvbkNoZWNrKCksIDEwMCk7Cn0nAPnw6ckCuI0BFXBvcnRhbENoYW5nZURpbWVuc2lvbgIEAPnw6ckC+uUBvgFAY29uc3QgbmV3RGltZW5zaW9uID0gYXdhaXQgb3Muc2hvd0lucHV0KHRhZ3MucG9ydGFsQWRkcmVzcywgewogICAgdGl0bGU6ICJlZGl0IGRpbWVuc2lvbiIKfSk7CgppZiAoIW5ld0RpbWVuc2lvbikKewogICAgcmV0dXJuOwp9OwoKdGFncy5wb3J0YWxBZGRyZXNzID0gbmV3RGltZW5zaW9uOwoKdGhpc0JvdC5wb3J0YWxNZW51KCk7JwD58OnJAriNAQ1wb3NpdGlvbkNoZWNrAgQA+fDpyQK55wGoDEBsZXQgaGVpZ2h0ID0gZ3JpZFBvcnRhbEJvdC50YWdzLnBpeGVsSGVpZ2h0OwpsZXQgYm90VGhpcmQgPSBoZWlnaHQgLSAoaGVpZ2h0IC8gOCk7CmxldCBwb2ludGVyWSA9IGdyaWRQb3J0YWxCb3QudGFncy5wb2ludGVyUGl4ZWxZOwoKaWYgKHBvaW50ZXJZID4gYm90VGhpcmQpCnsKICAgIGlmIChjb25maWdCb3QudGFncy5taW5pR3JpZFBvcnRhbCAhPSB0YWdzLnBvcnRhbEFkZHJlc3MpCiAgICB7CiAgICAgICAgY29uZmlnQm90LnRhZ3MubWluaUdyaWRQb3J0YWwgPSB0YWdzLnBvcnRhbEFkZHJlc3M7CgogICAgICAgIG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MubWluaVBvcnRhbFdpZHRoID0gMTsKCiAgICAgICAgbWluaUdyaWRQb3J0YWxCb3QudGFncy5wb3J0YWxDb2xvciA9IHRhZ3MuY29sb3I7CiAgICB9Cn0KZWxzZQp7CiAgICBpZiAoY29uZmlnQm90LnRhZ3MubWluaUdyaWRQb3J0YWwgPT0gdGFncy5wb3J0YWxBZGRyZXNzKQogICAgewogICAgICAgIGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsID0gbnVsbDsKICAgICAgICBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLnBvcnRhbENvbG9yID0gbnVsbDsKICAgICAgICBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLm1pbmlQb3J0YWxXaWR0aCA9IG51bGw7CiAgICB9Cn0KCgoKCi8vIGlmICh0aGF0LmJvdC50YWdzLnByaW1pdGl2ZUlEKQovLyB7Ci8vICAgICBpZiAodGhhdC5ib3QudGFncy5wcmltaXRpdmVJRCA9PSAicG9ydGFsIikKLy8gICAgIHsKLy8gICAgICAgICBsZXQgcG9ydGFsQm90ID0gdGhhdC5ib3Q7CgovLyAgICAgICAgIGNsZWFySW50ZXJ2YWwocG9ydGFsQm90Lm1hc2tzLmludGVydmFsKTsKLy8gICAgICAgICBjbGVhclRhZ01hc2tzKHBvcnRhbEJvdCk7CgovLyAgICAgICAgIGlmICh0aGF0LnRvLmRpbWVuc2lvbiAhPSB0aGF0LmZyb20uZGltZW5zaW9uKQovLyAgICAgICAgIHsKLy8gICAgICAgICAgICAgaWYgKHRoYXQudG8uZGltZW5zaW9uID09IHBvcnRhbEJvdC50YWdzLnBvcnRhbEFkZHJlc3MpCi8vICAgICAgICAgICAgIHsKLy8gICAgICAgICAgICAgICAgIGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsID0gcG9ydGFsQm90LnRhZ3MucG9ydGFsQWRkcmVzczsKCi8vICAgICAgICAgICAgICAgICBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLm1pbmlQb3J0YWxXaWR0aCA9IDE7CgovLyAgICAgICAgICAgICAgICAgcG9ydGFsQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb24gKyAiWCJdID0gMDsKLy8gICAgICAgICAgICAgICAgIHBvcnRhbEJvdC50YWdzW3RoYXQudG8uZGltZW5zaW9uICsgIlkiXSA9IDA7Ci8vICAgICAgICAgICAgIH0KLy8gICAgICAgICAgICAgZWxzZSBpZiAoY29uZmlnQm90LnRhZ3MubWluaUdyaWRQb3J0YWwgPT0gcG9ydGFsQm90LnRhZ3MucG9ydGFsQWRkcmVzcyAmJiB0aGF0LnRvLmRpbWVuc2lvbiAhPSBwb3J0YWxCb3QudGFncy5wb3J0YWxBZGRyZXNzKQovLyAgICAgICAgICAgICB7Ci8vICAgICAgICAgICAgICAgICBjb25maWdCb3QudGFncy5taW5pR3JpZFBvcnRhbCA9IG51bGw7Ci8vICAgICAgICAgICAgIH0KLy8gICAgICAgICB9Ci8vICAgICB9Ci8vIH0A"}]}