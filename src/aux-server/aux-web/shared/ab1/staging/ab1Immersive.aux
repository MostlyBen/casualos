{"version":2,"updates":[{"id":0,"timestamp":1681331643204,"update":"AWaI1IHqAwAnAQRib3RzJGM0ODkxOThhLWY4OTktNGJlNi1iMWEwLWY0MjdkZjJmZjMzZAEnAIjUgeoDAAZzeXN0ZW0CBACI1IHqAwEWYWItMS5pbW1lcnNpdmUuaW1tZXJzZScAiNSB6gMAD29uUG9ydGFsQ2hhbmdlZAIEAIjUgeoDGMACQGlmICh0aGF0LmRpbWVuc2lvbiA9PSB0YWdzLnJvb3REaW1lbnNpb24gfHwgdGhhdC5kaW1lbnNpb24gPT0gIm1haW5TY2VuZSIpCnsKICAgIHRoaXNCb3QuaW5pdGlhbGl6ZSgpOwoKICAgIHJldHVybjsKfQoKaWYgKHRoYXQucG9ydGFsID09ICJsZWZ0V3Jpc3RQb3J0YWwiICYmIHRhZ3MuaW5pdGlhbGl6ZWQpCnsKICAgIGlmICh0aGF0LmRpbWVuc2lvbikKICAgIHsKICAgICAgICB0aGlzQm90Lm9uQUIxTGVmdFdyaXN0KCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgY29uZmlnQm90Lm1hc2tzLmxlZnRXcmlzdFBvcnRhbCA9IG51bGw7CiAgICB9Cn0nAIjUgeoDAARmb3JtAgQAiNSB6gPZAgdub3RoaW5nJwCI1IHqAwAMYWIxSW1tZXJzaXZlAgQAiNSB6gPhAgR0cnVlJwCI1IHqAwAOaW5pdGlhbGl6ZU1hdGgCBACI1IHqA+YC6Y8BQC8vID09PT09PT09PT0KLy8gbWF0aCB1dGlscwovLyA9PT09PT09PT09Cmdsb2JhbFRoaXMubWF0aFV0aWxzID0ge307CgptYXRoVXRpbHMuY2xhbXAgPSAodmFsdWUsIG1pbiwgbWF4KSA9PiB7CglyZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7Cn0KCm1hdGhVdGlscy5mbW9kID0gKGEsYikgPT4geyAKCXJldHVybiBOdW1iZXIoKGEgLSAoTWF0aC5mbG9vcihhIC8gYikgKiBiKSkudG9QcmVjaXNpb24oOCkpOyAKfQoKbWF0aFV0aWxzLndyYXBUbzJQaSA9IChhKSA9PiB7IAoJYSA9IG1hdGhVdGlscy5mbW9kKGEsIE1hdGguUEkgKiAyKTsKCXJldHVybiBhOwp9CgptYXRoVXRpbHMuZmxpcFlaID0gKHYsIHNpZ24pID0+IHsKICAgIGNvbnN0IHkgPSB2Lnk7CiAgICBjb25zdCB6ID0gdi56OwogICAgdi56ID0geTsKICAgIHYueSA9IHNpZ24gPyAteiA6IHo7Cn0KCi8vID09PT09PT09PT0KLy8gdmVjdG9yMwovLyA9PT09PT09PT09Cmdsb2JhbFRoaXMudmVjdG9yMyA9IHt9OwoKdmVjdG9yMy56ZXJvID0gKCkgPT4gewoJcmV0dXJuIHt4OiAwLCB5OiAwLCB6OiAwfQp9Cgp2ZWN0b3IzLnVwID0gKCkgPT4gewoJcmV0dXJuIHt4OiAwLCB5OiAxLCB6OiAwfQp9Cgp2ZWN0b3IzLm9uZSA9ICgpID0+IHsKCXJldHVybiB7eDogMSwgeTogMSwgejogMX0KfQoKdmVjdG9yMy5hcHBseVF1YXRlcm5pb24gPSAodiwgcSkgPT4gewoJCWNvbnN0IHggPSB2LngsIHkgPSB2LnksIHogPSB2Lno7CgkJY29uc3QgcXggPSBxLngsIHF5ID0gcS55LCBxeiA9IHEueiwgcXcgPSBxLnc7CgoJCS8vIGNhbGN1bGF0ZSBxdWF0ICogdmVjdG9yCgkJY29uc3QgaXggPSBxdyAqIHggKyBxeSAqIHogLSBxeiAqIHk7CgkJY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CgkJY29uc3QgaXogPSBxdyAqIHogKyBxeCAqIHkgLSBxeSAqIHg7CgkJY29uc3QgaXcgPSAtIHF4ICogeCAtIHF5ICogeSAtIHF6ICogejsKCgkJLy8gY2FsY3VsYXRlIHJlc3VsdCAqIGludmVyc2UgcXVhdAoJCXYueCA9IGl4ICogcXcgKyBpdyAqIC0gcXggKyBpeSAqIC0gcXogLSBpeiAqIC0gcXk7CgkJdi55ID0gaXkgKiBxdyArIGl3ICogLSBxeSArIGl6ICogLSBxeCAtIGl4ICogLSBxejsKCQl2LnogPSBpeiAqIHF3ICsgaXcgKiAtIHF6ICsgaXggKiAtIHF5IC0gaXkgKiAtIHF4OwoKCQlyZXR1cm4gdjsKfQoKdmVjdG9yMy5sZW5ndGhTcSA9ICh2KSA9PiB7CiAgICByZXR1cm4gdi54ICogdi54ICsgdi55ICogdi55ICsgdi56ICogdi56Owp9Cgp2ZWN0b3IzLmRvdCA9ICh2MSwgdjIpID0+IHsKICAgIHJldHVybiB2MS54ICogdjIueCArIHYxLnkgKiB2Mi55ICsgdjEueiAqIHYyLno7Cn0KCnZlY3RvcjMuYW5nbGUgPSAodjEsIHYyKSA9PiB7CgkJY29uc3QgZGVub21pbmF0b3IgPSBNYXRoLnNxcnQoIHZlY3RvcjMubGVuZ3RoU3EodjEpICogdmVjdG9yMy5sZW5ndGhTcSh2MikgKTsKCQlpZiAoIGRlbm9taW5hdG9yID09PSAwICkgcmV0dXJuIE1hdGguUEkgLyAyOwoKCQljb25zdCB0aGV0YSA9IHZlY3RvcjMuZG90KHYxLCB2MikgLyBkZW5vbWluYXRvcjsKCQkvLyBjbGFtcCwgdG8gaGFuZGxlIG51bWVyaWNhbCBwcm9ibGVtcwoJCXJldHVybiBNYXRoLmFjb3MobWF0aFV0aWxzLmNsYW1wKHRoZXRhLCAtIDEsIDEpKTsKfQoKdmVjdG9yMy5sZXJwID0gKHYxLCB2MiwgdCkgPT4gewogICAgcmV0dXJuIHsKICAgICAgICB4OiB2MS54ICsgKHYyLnggLSB2MS54KSAqIHQsCgkJeTogdjEueSArICh2Mi55IC0gdjEueSkgKiB0LAoJCXo6IHYxLnogKyAodjIueiAtIHYxLnopICogdAogICAgfQp9Cgp2ZWN0b3IzLmxlbmd0aCA9ICh2KSA9PiB7CglyZXR1cm4gTWF0aC5zcXJ0KHYueCAqIHYueCArIHYueSAqIHYueSArIHYueiAqIHYueik7Cn0KCnZlY3RvcjMubGVuZ3RoU3EgPSAodikgPT4gewoJcmV0dXJuIHYueCAqIHYueCArIHYueSAqIHYueSArIHYueiAqIHYuejsKfQoKdmVjdG9yMy5hcHBseU1hdHJpeDQgPSAodiwgbSkgPT4gewoJY29uc3QgeCA9IHYueCwgeSA9IHYueSwgeiA9IHYuejsKCWNvbnN0IHcgPSAxIC8gKG1bM10gKiB4ICsgbVs3XSAqIHkgKyBtWzExXSAqIHogKyBtWzE1XSk7CgoJdi54ID0gKG1bMF0gKiB4ICsgbVs0XSAqIHkgKyBtWzhdICogeiArIG1bMTJdKSAqIHc7Cgl2LnkgPSAobVsxXSAqIHggKyBtWzVdICogeSArIG1bOV0gKiB6ICsgbVsxM10pICogdzsKCXYueiA9IChtWzJdICogeCArIG1bNl0gKiB5ICsgbVsxMF0gKiB6ICsgbVsxNF0pICogdzsKCglyZXR1cm4gdjsKfQoKdmVjdG9yMy5tdWx0aXBseVNjYWxhciA9ICh2LCBzKSA9PiB7Cgl2LnggKj0gczsKCXYueSAqPSBzOwoJdi56ICo9IHM7CgoJcmV0dXJuIHY7Cn0KCnZlY3RvcjMuY3Jvc3NWZWN0b3JzID0gKGEsIGIpID0+IHsKCWNvbnN0IHYgPSB2ZWN0b3IzLnplcm8oKTsKCWNvbnN0IGF4ID0gYS54LCBheSA9IGEueSwgYXogPSBhLno7Cgljb25zdCBieCA9IGIueCwgYnkgPSBiLnksIGJ6ID0gYi56OwoKCXYueCA9IGF5ICogYnogLSBheiAqIGJ5OwoJdi55ID0gYXogKiBieCAtIGF4ICogYno7Cgl2LnogPSBheCAqIGJ5IC0gYXkgKiBieDsKCXJldHVybiB2Owp9Cgp2ZWN0b3IzLmFwcGx5RXVsZXIgPSAodiwgZXVsZXIsIG9yZGVyID0gJ1hZWicpID0+IHsKCXJldHVybiB2ZWN0b3IzLmFwcGx5UXVhdGVybmlvbih2LCBxdWF0ZXJuaW9uLmZyb21FdWxlcihldWxlciwgb3JkZXIpKTsKfQoKdmVjdG9yMy5hcHBseUF4aXNBbmdsZSA9ICh2LCBheGlzLCBhbmdsZSkgPT4gewoJcmV0dXJuIHZlY3RvcjMuYXBwbHlRdWF0ZXJuaW9uKCB2LCBxdWF0ZXJuaW9uLnNldEZyb21BeGlzQW5nbGUoIGF4aXMsIGFuZ2xlICkgKTsKfQoKdmVjdG9yMy5zZXRGcm9tUm90YXRpb25NYXRyaXggPSAobSwgb3JkZXIgPSAnWFlaJykgPT4gewoJLy8gYXNzdW1lcyB0aGUgdXBwZXIgM3gzIG9mIG0gaXMgYSBwdXJlIHJvdGF0aW9uIG1hdHJpeCAoaS5lLCB1bnNjYWxlZCkKCS8vIGNvbnNvbGUubG9nKGBbdmVjdG9yMy5zZXRGcm9tUm90YXRpb25NYXRyaXhdIDEuIG1hdHJpeGAsIEpTT04uc3RyaW5naWZ5KG0pKTsKCWNvbnN0IG0xMSA9IG1bMF0sIG0xMiA9IG1bNF0sIG0xMyA9IG1bOF07Cgljb25zdCBtMjEgPSBtWzFdLCBtMjIgPSBtWzVdLCBtMjMgPSBtWzldOwoJY29uc3QgbTMxID0gbVsyXSwgbTMyID0gbVs2XSwgbTMzID0gbVsxMF07Cgljb25zdCB2ID0gdmVjdG9yMy56ZXJvKCk7CgoJc3dpdGNoIChvcmRlcikgewoJCWNhc2UgJ1hZWic6CgkJCXYueSA9IE1hdGguYXNpbihtYXRoVXRpbHMuY2xhbXAobTEzLCAtIDEsIDEpKTsKCgkJCWlmIChNYXRoLmFicyhtMTMpIDwgMC45OTk5OTk5KSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKC0gbTIzLCBtMzMpOwoJCQkJdi56ID0gTWF0aC5hdGFuMigtIG0xMiwgbTExKTsKCQkJfSBlbHNlIHsKCQkJCXYueCA9IE1hdGguYXRhbjIobTMyLCBtMjIpOwoJCQkJdi56ID0gMDsKCQkJfQoJCQkvLyBjb25zb2xlLmxvZyhgW3ZlY3RvcjMuc2V0RnJvbVJvdGF0aW9uTWF0cml4XSAyLiBYWVogc3dpenpsZWAsIEpTT04uc3RyaW5naWZ5KHYpKTsKCQkJYnJlYWs7CgkJY2FzZSAnWVhaJzoKCQkJdi54ID0gTWF0aC5hc2luKC0gbWF0aFV0aWxzLmNsYW1wKG0yMywgLSAxLCAxKSk7CgoJCQlpZiAoTWF0aC5hYnMobTIzKSA8IDAuOTk5OTk5OSkgewoJCQkJdi55ID0gTWF0aC5hdGFuMihtMTMsIG0zMyk7CgkJCQl2LnogPSBNYXRoLmF0YW4yKG0yMSwgbTIyKTsKCQkJfSBlbHNlIHsKCQkJCXYueSA9IE1hdGguYXRhbjIoLSBtMzEsIG0xMSk7CgkJCQl2LnogPSAwOwoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ1pYWSc6CgkJCXYueCA9IE1hdGguYXNpbihtYXRoVXRpbHMuY2xhbXAobTMyLCAtIDEsIDEpKTsKCgkJCWlmIChNYXRoLmFicyhtMzIpIDwgMC45OTk5OTk5KSB7CgkJCQl2LnkgPSBNYXRoLmF0YW4yKC0gbTMxLCBtMzMpOwoJCQkJdi56ID0gTWF0aC5hdGFuMigtIG0xMiwgbTIyKTsKCQkJfSBlbHNlIHsKCQkJCXYueSA9IDA7CgkJCQl2LnogPSBNYXRoLmF0YW4yKG0yMSwgbTExKTsKCQkJfQoJCQlicmVhazsKCQljYXNlICdaWVgnOgoJCQl2LnkgPSBNYXRoLmFzaW4oLSBtYXRoVXRpbHMuY2xhbXAobTMxLCAtIDEsIDEpKTsKCgkJCWlmIChNYXRoLmFicyhtMzEpIDwgMC45OTk5OTk5KSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKG0zMiwgbTMzKTsKCQkJCXYueiA9IE1hdGguYXRhbjIobTIxLCBtMTEpOwoJCQl9IGVsc2UgewoJCQkJdi54ID0gMDsKCQkJCXYueiA9IE1hdGguYXRhbjIoLSBtMTIsIG0yMik7CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSAnWVpYJzoKCQkJdi56ID0gTWF0aC5hc2luKG1hdGhVdGlscy5jbGFtcChtMjEsIC0gMSwgMSkpOwoKCQkJaWYgKE1hdGguYWJzKG0yMSkgPCAwLjk5OTk5OTkpIHsKCQkJCXYueCA9IE1hdGguYXRhbjIoLSBtMjMsIG0yMik7CgkJCQl2LnkgPSBNYXRoLmF0YW4yKC0gbTMxLCBtMTEpOwoJCQl9IGVsc2UgewoJCQkJdi54ID0gMDsKCQkJCXYueSA9IE1hdGguYXRhbjIobTEzLCBtMzMpOwoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ1haWSc6CgkJCXYueiA9IE1hdGguYXNpbigtIG1hdGhVdGlscy5jbGFtcChtMTIsIC0gMSwgMSkpOwoKCQkJaWYgKE1hdGguYWJzKG0xMikgPCAwLjk5OTk5OTkpIHsKCQkJCXYueCA9IE1hdGguYXRhbjIobTMyLCBtMjIpOwoJCQkJdi55ID0gTWF0aC5hdGFuMihtMTMsIG0xMSk7CgkJCX0gZWxzZSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKC0gbTIzLCBtMzMpOwoJCQkJdi55ID0gMDsKCQkJfQoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQljb25zb2xlLndhcm4oJ1t2ZWN0b3IzLnNldEZyb21Sb3RhdGlvbk1hdHJpeF0gZW5jb3VudGVyZWQgYW4gdW5rbm93biBvcmRlcjogJyArIG9yZGVyKTsKCX0KCglyZXR1cm4gdjsKfQoKdmVjdG9yMy5zZXRGcm9tUXVhdGVybmlvbiA9IChxLCBvcmRlciA9ICdYWVonKSA9PiB7Cgljb25zdCBtID0gbWF0cml4NC5jb21wb3NlKHZlY3RvcjMuemVybygpLCBxLCB2ZWN0b3IzLm9uZSgpKTsKCXJldHVybiB2ZWN0b3IzLnNldEZyb21Sb3RhdGlvbk1hdHJpeChtLCBvcmRlcik7Cn0KCnZlY3RvcjMubG9jYWxUb1dvcmxkID0gKHZlY3RvciwgbWF0cml4V29ybGQpID0+IHsKCXJldHVybiB2ZWN0b3IzLmFwcGx5TWF0cml4NCh2ZWN0b3IsIG1hdHJpeFdvcmxkKTsKfQoKdmVjdG9yMy53b3JsZFRvTG9jYWwgPSAodmVjdG9yLCBtYXRyaXhXb3JsZCkgPT4gewoJY29uc3QgaW52ZXJzZU1hdHJpeCA9IG1hdHJpeDQuaW52ZXJ0KFsuLi5tYXRyaXhXb3JsZF0pOwoJcmV0dXJuIHZlY3RvcjMuYXBwbHlNYXRyaXg0KHZlY3RvciwgaW52ZXJzZU1hdHJpeCk7Cn0KCi8vID09PT09PT09PT0KLy8gcXVhdGVybmlvbgovLyA9PT09PT09PT09Cmdsb2JhbFRoaXMucXVhdGVybmlvbiA9IHt9OwoKcXVhdGVybmlvbi5pZGVudGl0eSA9ICgpID0+IHsKCXJldHVybiB7eDogMCwgeTogMCwgejogMCwgdzogMX07Cn0KCnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4ID0gKHEsIG0pID0+IHsKCS8vIGh0dHA6Ly93d3cuZXVjbGlkZWFuc3BhY2UuY29tL21hdGhzL2dlb21ldHJ5L3JvdGF0aW9ucy9jb252ZXJzaW9ucy9tYXRyaXhUb1F1YXRlcm5pb24vaW5kZXguaHRtCgkvLyBhc3N1bWVzIHRoZSB1cHBlciAzeDMgb2YgbSBpcyBhIHB1cmUgcm90YXRpb24gbWF0cml4IChpLmUsIHVuc2NhbGVkKQoKCWNvbnN0IG0xMSA9IG1bIDAgXSwgbTEyID0gbVsgNCBdLCBtMTMgPSBtWyA4IF07Cgljb25zdCBtMjEgPSBtWyAxIF0sIG0yMiA9IG1bIDUgXSwgbTIzID0gbVsgOSBdOwoJY29uc3QgbTMxID0gbVsgMiBdLCBtMzIgPSBtWyA2IF0sIG0zMyA9IG1bIDEwIF07CgoJY29uc3QgdHJhY2UgPSBtMTEgKyBtMjIgKyBtMzM7CgoJaWYgKCB0cmFjZSA+IDAgKSB7CgkJY29uc3QgcyA9IDAuNSAvIE1hdGguc3FydCggdHJhY2UgKyAxLjAgKTsKCgkJcS53ID0gMC4yNSAvIHM7CgkJcS54ID0gKCBtMzIgLSBtMjMgKSAqIHM7CgkJcS55ID0gKCBtMTMgLSBtMzEgKSAqIHM7CgkJcS56ID0gKCBtMjEgLSBtMTIgKSAqIHM7Cgl9IGVsc2UgaWYgKCBtMTEgPiBtMjIgJiYgbTExID4gbTMzICkgewoJCWNvbnN0IHMgPSAyLjAgKiBNYXRoLnNxcnQoIDEuMCArIG0xMSAtIG0yMiAtIG0zMyApOwoKCQlxLncgPSAoIG0zMiAtIG0yMyApIC8gczsKCQlxLnggPSAwLjI1ICogczsKCQlxLnkgPSAoIG0xMiArIG0yMSApIC8gczsKCQlxLnogPSAoIG0xMyArIG0zMSApIC8gczsKCX0gZWxzZSBpZiAoIG0yMiA+IG0zMyApIHsKCQljb25zdCBzID0gMi4wICogTWF0aC5zcXJ0KCAxLjAgKyBtMjIgLSBtMTEgLSBtMzMgKTsKCgkJcS53ID0gKCBtMTMgLSBtMzEgKSAvIHM7CgkJcS54ID0gKCBtMTIgKyBtMjEgKSAvIHM7CgkJcS55ID0gMC4yNSAqIHM7CgkJcS56ID0gKCBtMjMgKyBtMzIgKSAvIHM7Cgl9IGVsc2UgewoJCWNvbnN0IHMgPSAyLjAgKiBNYXRoLnNxcnQoIDEuMCArIG0zMyAtIG0xMSAtIG0yMiApOwoKCQlxLncgPSAoIG0yMSAtIG0xMiApIC8gczsKCQlxLnggPSAoIG0xMyArIG0zMSApIC8gczsKCQlxLnkgPSAoIG0yMyArIG0zMiApIC8gczsKCQlxLnogPSAwLjI1ICogczsKCX0KCglyZXR1cm4gcTsKfQkKCnF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZSA9IChheGlzLCBhbmdsZSkgPT4gewoJLy8gaHR0cDovL3d3dy5ldWNsaWRlYW5zcGFjZS5jb20vbWF0aHMvZ2VvbWV0cnkvcm90YXRpb25zL2NvbnZlcnNpb25zL2FuZ2xlVG9RdWF0ZXJuaW9uL2luZGV4Lmh0bQoJLy8gYXNzdW1lcyBheGlzIGlzIG5vcm1hbGl6ZWQKCWNvbnN0IHEgPSBxdWF0ZXJuaW9uLmlkZW50aXR5KCk7Cgljb25zdCBoYWxmQW5nbGUgPSBhbmdsZSAvIDIsIHMgPSBNYXRoLnNpbiggaGFsZkFuZ2xlICk7CgoJcS54ID0gYXhpcy54ICogczsKCXEueSA9IGF4aXMueSAqIHM7CglxLnogPSBheGlzLnogKiBzOwoJcS53ID0gTWF0aC5jb3MoaGFsZkFuZ2xlKTsKCglyZXR1cm4gcTsKfQoKcXVhdGVybmlvbi5mcm9tRXVsZXIgPSAoZXVsZXIsIG9yZGVyID0gJ1hZWicpID0+IHsKCWNvbnN0IHEgPSBxdWF0ZXJuaW9uLmlkZW50aXR5KCk7Cgljb25zdCB4ID0gZXVsZXIueCwgeSA9IGV1bGVyLnksIHogPSBldWxlci56OwoKCS8vIGh0dHA6Ly93d3cubWF0aHdvcmtzLmNvbS9tYXRsYWJjZW50cmFsL2ZpbGVleGNoYW5nZS8KCS8vIAkyMDY5Ni1mdW5jdGlvbi10by1jb252ZXJ0LWJldHdlZW4tZGNtLWV1bGVyLWFuZ2xlcy1xdWF0ZXJuaW9ucy1hbmQtZXVsZXItdmVjdG9ycy9jb250ZW50L1NwaW5DYWxjLm0KCWNvbnN0IGMxID0gTWF0aC5jb3MoIHggLyAyICk7Cgljb25zdCBjMiA9IE1hdGguY29zKCB5IC8gMiApOwoJY29uc3QgYzMgPSBNYXRoLmNvcyggeiAvIDIgKTsKCgljb25zdCBzMSA9IE1hdGguc2luKCB4IC8gMiApOwoJY29uc3QgczIgPSBNYXRoLnNpbiggeSAvIDIgKTsKCWNvbnN0IHMzID0gTWF0aC5zaW4oIHogLyAyICk7CgoJc3dpdGNoICggb3JkZXIgKSB7CgkJY2FzZSAnWFlaJzoKCQkJcS54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwoJCQlxLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CgkJCXEueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKCQkJcS53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwoJCQlicmVhazsKCQljYXNlICdZWFonOgoJCQlxLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CgkJCXEueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKCQkJcS56ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwoJCQlxLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CgkJCWJyZWFrOwoJCWNhc2UgJ1pYWSc6CgkJCXEueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKCQkJcS55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwoJCQlxLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CgkJCXEudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKCQkJYnJlYWs7CgkJY2FzZSAnWllYJzoKCQkJcS54ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwoJCQlxLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CgkJCXEueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKCQkJcS53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwoJCQlicmVhazsKCQljYXNlICdZWlgnOgoJCQlxLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CgkJCXEueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKCQkJcS56ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwoJCQlxLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CgkJCWJyZWFrOwoJCWNhc2UgJ1haWSc6CgkJCXEueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKCQkJcS55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwoJCQlxLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CgkJCXEudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJY29uc29sZS53YXJuKCAnW3F1YXRlcm5pb24uZnJvbUV1bGVyXSBlbmNvdW50ZXJlZCBhbiB1bmtub3duIG9yZGVyOiAnICsgb3JkZXIpOwoJfQoKCXJldHVybiBxOwp9CgpxdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnMgPSAoYSwgYikgPT4gewoJLy8gZnJvbSBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9hbGdlYnJhL3JlYWxOb3JtZWRBbGdlYnJhL3F1YXRlcm5pb25zL2NvZGUvaW5kZXguaHRtCgljb25zb2xlLmxvZyhgW3F1YXRlcm5pb24ubXVsdGlwbHlRdWF0ZXJuaW9uc10gYTpgLCBKU09OLnN0cmluZ2lmeShhKSk7Cgljb25zb2xlLmxvZyhgW3F1YXRlcm5pb24ubXVsdGlwbHlRdWF0ZXJuaW9uc10gYjpgLCBKU09OLnN0cmluZ2lmeShiKSk7Cgljb25zdCBxID0gcXVhdGVybmlvbi5pZGVudGl0eSgpOwoJY29uc3QgcWF4ID0gYS54LCBxYXkgPSBhLnksIHFheiA9IGEueiwgcWF3ID0gYS53OwoJY29uc3QgcWJ4ID0gYi54LCBxYnkgPSBiLnksIHFieiA9IGIueiwgcWJ3ID0gYi53OwoKCXEueCA9IHFheCAqIHFidyArIHFhdyAqIHFieCArIHFheSAqIHFieiAtIHFheiAqIHFieTsKCXEueSA9IHFheSAqIHFidyArIHFhdyAqIHFieSArIHFheiAqIHFieCAtIHFheCAqIHFiejsKCXEueiA9IHFheiAqIHFidyArIHFhdyAqIHFieiArIHFheCAqIHFieSAtIHFheSAqIHFieDsKCXEudyA9IHFhdyAqIHFidyAtIHFheCAqIHFieCAtIHFheSAqIHFieSAtIHFheiAqIHFiejsKCglyZXR1cm4gcTsKfQoKcXVhdGVybmlvbi5sZW5ndGggPSAocSkgPT4gewoJcmV0dXJuIE1hdGguc3FydCggcS54ICogcS54ICsgcS55ICogcS55ICsgcS56ICogcS56ICsgcS53ICogcS53ICk7Cn0KCnF1YXRlcm5pb24ubm9ybWFsaXplID0gKHEpID0+IHsKCWxldCBsID0gcXVhdGVybmlvbi5sZW5ndGgocSk7CgoJaWYgKGwgPT09IDApIHsKCQlxLnggPSAwOwoJCXEueSA9IDA7CgkJcS56ID0gMDsKCQlxLncgPSAxOwoJfSBlbHNlIHsKCQlsID0gMSAvIGw7CgoJCXEueCA9IHEueCAqIGw7CgkJcS55ID0gcS55ICogbDsKCQlxLnogPSBxLnogKiBsOwoJCXEudyA9IHEudyAqIGw7Cgl9CgoJcmV0dXJuIHE7Cn0KCnF1YXRlcm5pb24uaW52ZXJ0ID0gKHEpID0+IHsKCS8vIHF1YXRlcm5pb24gaXMgYXNzdW1lZCB0byBoYXZlIHVuaXQgbGVuZ3RoCglyZXR1cm4gcXVhdGVybmlvbi5jb25qdWdhdGUocSk7Cn0KCnF1YXRlcm5pb24uY29uanVnYXRlID0gKHEpID0+IHsKCXEueCAqPSAtIDE7CglxLnkgKj0gLSAxOwoJcS56ICo9IC0gMTsKCglyZXR1cm4gcTsKfQoKLy8gPT09PT09PT09PQovLyBtYXRyaXg0Ci8vID09PT09PT09PT0KZ2xvYmFsVGhpcy5tYXRyaXg0ID0ge307CgptYXRyaXg0LmlkZW50aXR5ID0gKCkgPT4gewoJcmV0dXJuIFsKCQkxLCAwLCAwLCAwLAoJCTAsIDEsIDAsIDAsCgkJMCwgMCwgMSwgMCwKCQkwLCAwLCAwLCAxCgldOwp9CgptYXRyaXg0Lm11bHRpcGx5TWF0cmljZXMgPSAobSwgYSwgYikgPT4gewoJY29uc3QgYTExID0gYVswXSwgYTEyID0gYVs0XSwgYTEzID0gYVs4XSwgYTE0ID0gYVsxMl07Cgljb25zdCBhMjEgPSBhWzFdLCBhMjIgPSBhWzVdLCBhMjMgPSBhWzldLCBhMjQgPSBhWzEzXTsKCWNvbnN0IGEzMSA9IGFbMl0sIGEzMiA9IGFbNl0sIGEzMyA9IGFbMTBdLCBhMzQgPSBhWzE0XTsKCWNvbnN0IGE0MSA9IGFbM10sIGE0MiA9IGFbN10sIGE0MyA9IGFbMTFdLCBhNDQgPSBhWzE1XTsKCgljb25zdCBiMTEgPSBiWzBdLCBiMTIgPSBiWzRdLCBiMTMgPSBiWzhdLCBiMTQgPSBiWzEyXTsKCWNvbnN0IGIyMSA9IGJbMV0sIGIyMiA9IGJbNV0sIGIyMyA9IGJbOV0sIGIyNCA9IGJbMTNdOwoJY29uc3QgYjMxID0gYlsyXSwgYjMyID0gYls2XSwgYjMzID0gYlsxMF0sIGIzNCA9IGJbMTRdOwoJY29uc3QgYjQxID0gYlszXSwgYjQyID0gYls3XSwgYjQzID0gYlsxMV0sIGI0NCA9IGJbMTVdOwoKCW1bMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzEgKyBhMTQgKiBiNDE7CgltWzRdID0gYTExICogYjEyICsgYTEyICogYjIyICsgYTEzICogYjMyICsgYTE0ICogYjQyOwoJbVs4XSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMyArIGExNCAqIGI0MzsKCW1bMTJdID0gYTExICogYjE0ICsgYTEyICogYjI0ICsgYTEzICogYjM0ICsgYTE0ICogYjQ0OwoKCW1bMV0gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzEgKyBhMjQgKiBiNDE7CgltWzVdID0gYTIxICogYjEyICsgYTIyICogYjIyICsgYTIzICogYjMyICsgYTI0ICogYjQyOwoJbVs5XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMyArIGEyNCAqIGI0MzsKCW1bMTNdID0gYTIxICogYjE0ICsgYTIyICogYjI0ICsgYTIzICogYjM0ICsgYTI0ICogYjQ0OwoKCW1bMl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzEgKyBhMzQgKiBiNDE7CgltWzZdID0gYTMxICogYjEyICsgYTMyICogYjIyICsgYTMzICogYjMyICsgYTM0ICogYjQyOwoJbVsxMF0gPSBhMzEgKiBiMTMgKyBhMzIgKiBiMjMgKyBhMzMgKiBiMzMgKyBhMzQgKiBiNDM7CgltWzE0XSA9IGEzMSAqIGIxNCArIGEzMiAqIGIyNCArIGEzMyAqIGIzNCArIGEzNCAqIGI0NDsKCgltWzNdID0gYTQxICogYjExICsgYTQyICogYjIxICsgYTQzICogYjMxICsgYTQ0ICogYjQxOwoJbVs3XSA9IGE0MSAqIGIxMiArIGE0MiAqIGIyMiArIGE0MyAqIGIzMiArIGE0NCAqIGI0MjsKCW1bMTFdID0gYTQxICogYjEzICsgYTQyICogYjIzICsgYTQzICogYjMzICsgYTQ0ICogYjQzOwoJbVsxNV0gPSBhNDEgKiBiMTQgKyBhNDIgKiAJYjI0ICsgYTQzICogYjM0ICsgYTQ0ICogYjQ0OwoKCXJldHVybiBtOwp9CgptYXRyaXg0LmludmVydCA9IChtKSA9PiB7CgkvLyBiYXNlZCBvbiBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9hbGdlYnJhL21hdHJpeC9mdW5jdGlvbnMvaW52ZXJzZS9mb3VyRC9pbmRleC5odG0KCWNvbnN0IG4xMSA9IG1bMF0sIG4yMSA9IG1bMV0sIG4zMSA9IG1bMl0sIG40MSA9IG1bM107Cgljb25zdCBuMTIgPSBtWzRdLCBuMjIgPSBtWzVdLCBuMzIgPSBtWzZdLCBuNDIgPSBtWzddOwoJY29uc3QgbjEzID0gbVs4XSwgbjIzID0gbVs5XSwgbjMzID0gbVsxMF0sIG40MyA9IG1bMTFdOwoJY29uc3QgbjE0ID0gbVsxMl0sIG4yNCA9IG1bMTNdLCBuMzQgPSBtWzE0XSwgbjQ0ID0gbVsxNV07CgoJY29uc3QgdDExID0gbjIzICogbjM0ICogbjQyIC0gbjI0ICogbjMzICogbjQyICsgbjI0ICogbjMyICogbjQzIC0gbjIyICogbjM0ICogbjQzIC0gbjIzICogbjMyICogbjQ0ICsgbjIyICogbjMzICogbjQ0OwoJY29uc3QgdDEyID0gbjE0ICogbjMzICogbjQyIC0gbjEzICogbjM0ICogbjQyIC0gbjE0ICogbjMyICogbjQzICsgbjEyICogbjM0ICogbjQzICsgbjEzICogbjMyICogbjQ0IC0gbjEyICogbjMzICogbjQ0OwoJY29uc3QgdDEzID0gbjEzICogbjI0ICogbjQyIC0gbjE0ICogbjIzICogbjQyICsgbjE0ICogbjIyICogbjQzIC0gbjEyICogbjI0ICogbjQzIC0gbjEzICogbjIyICogbjQ0ICsgbjEyICogbjIzICogbjQ0OwoJY29uc3QgdDE0ID0gbjE0ICogbjIzICogbjMyIC0gbjEzICogbjI0ICogbjMyIC0gbjE0ICogbjIyICogbjMzICsgbjEyICogbjI0ICogbjMzICsgbjEzICogbjIyICogbjM0IC0gbjEyICogbjIzICogbjM0OwoKCWNvbnN0IGRldCA9IG4xMSAqIHQxMSArIG4yMSAqIHQxMiArIG4zMSAqIHQxMyArIG40MSAqIHQxNDsKCglpZiAoZGV0ID09PSAwKSByZXR1cm4gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwoKCWNvbnN0IGRldEludiA9IDEgLyBkZXQ7CgoJbVswXSA9IHQxMSAqIGRldEludjsKCW1bMV0gPSAobjI0ICogbjMzICogbjQxIC0gbjIzICogbjM0ICogbjQxIC0gbjI0ICogbjMxICogbjQzICsgbjIxICogbjM0ICogbjQzICsgbjIzICogbjMxICogbjQ0IC0gbjIxICogbjMzICogbjQ0KSAqIGRldEludjsKCW1bMl0gPSAobjIyICogbjM0ICogbjQxIC0gbjI0ICogbjMyICogbjQxICsgbjI0ICogbjMxICogbjQyIC0gbjIxICogbjM0ICogbjQyIC0gbjIyICogbjMxICogbjQ0ICsgbjIxICogbjMyICogbjQ0KSAqIGRldEludjsKCW1bM10gPSAobjIzICogbjMyICogbjQxIC0gbjIyICogbjMzICogbjQxIC0gbjIzICogbjMxICogbjQyICsgbjIxICogbjMzICogbjQyICsgbjIyICogbjMxICogbjQzIC0gbjIxICogbjMyICogbjQzKSAqIGRldEludjsKCgltWzRdID0gdDEyICogZGV0SW52OwoJbVs1XSA9IChuMTMgKiBuMzQgKiBuNDEgLSBuMTQgKiBuMzMgKiBuNDEgKyBuMTQgKiBuMzEgKiBuNDMgLSBuMTEgKiBuMzQgKiBuNDMgLSBuMTMgKiBuMzEgKiBuNDQgKyBuMTEgKiBuMzMgKiBuNDQpICogZGV0SW52OwoJbVs2XSA9IChuMTQgKiBuMzIgKiBuNDEgLSBuMTIgKiBuMzQgKiBuNDEgLSBuMTQgKiBuMzEgKiBuNDIgKyBuMTEgKiBuMzQgKiBuNDIgKyBuMTIgKiBuMzEgKiBuNDQgLSBuMTEgKiBuMzIgKiBuNDQpICogZGV0SW52OwoJbVs3XSA9IChuMTIgKiBuMzMgKiBuNDEgLSBuMTMgKiBuMzIgKiBuNDEgKyBuMTMgKiBuMzEgKiBuNDIgLSBuMTEgKiBuMzMgKiBuNDIgLSBuMTIgKiBuMzEgKiBuNDMgKyBuMTEgKiBuMzIgKiBuNDMpICogZGV0SW52OwoKCW1bOF0gPSB0MTMgKiBkZXRJbnY7CgltWzldID0gKG4xNCAqIG4yMyAqIG40MSAtIG4xMyAqIG4yNCAqIG40MSAtIG4xNCAqIG4yMSAqIG40MyArIG4xMSAqIG4yNCAqIG40MyArIG4xMyAqIG4yMSAqIG40NCAtIG4xMSAqIG4yMyAqIG40NCkgKiBkZXRJbnY7CgltWzEwXSA9IChuMTIgKiBuMjQgKiBuNDEgLSBuMTQgKiBuMjIgKiBuNDEgKyBuMTQgKiBuMjEgKiBuNDIgLSBuMTEgKiBuMjQgKiBuNDIgLSBuMTIgKiBuMjEgKiBuNDQgKyBuMTEgKiBuMjIgKiBuNDQpICogZGV0SW52OwoJbVsxMV0gPSAobjEzICogbjIyICogbjQxIC0gbjEyICogbjIzICogbjQxIC0gbjEzICogbjIxICogbjQyICsgbjExICogbjIzICogbjQyICsgbjEyICogbjIxICogbjQzIC0gbjExICogbjIyICogbjQzKSAqIGRldEludjsKCgltWzEyXSA9IHQxNCAqIGRldEludjsKCW1bMTNdID0gKG4xMyAqIG4yNCAqIG4zMSAtIG4xNCAqIG4yMyAqIG4zMSArIG4xNCAqIG4yMSAqIG4zMyAtIG4xMSAqIG4yNCAqIG4zMyAtIG4xMyAqIG4yMSAqIG4zNCArIG4xMSAqIG4yMyAqIG4zNCkgKiBkZXRJbnY7CgltWzE0XSA9IChuMTQgKiBuMjIgKiBuMzEgLSBuMTIgKiBuMjQgKiBuMzEgLSBuMTQgKiBuMjEgKiBuMzIgKyBuMTEgKiBuMjQgKiBuMzIgKyBuMTIgKiBuMjEgKiBuMzQgLSBuMTEgKiBuMjIgKiBuMzQpICogZGV0SW52OwoJbVsxNV0gPSAobjEyICogbjIzICogbjMxIC0gbjEzICogbjIyICogbjMxICsgbjEzICogbjIxICogbjMyIC0gbjExICogbjIzICogbjMyIC0gbjEyICogbjIxICogbjMzICsgbjExICogbjIyICogbjMzKSAqIGRldEludjsKCglyZXR1cm4gbTsKfQoKbWF0cml4NC5jb21wb3NlID0gKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBzY2FsZSkgPT4gewoJY29uc3QgbSA9IG1hdHJpeDQuaWRlbnRpdHkoKTsKCgljb25zdCB4ID0gcXVhdGVybmlvbi54LCB5ID0gcXVhdGVybmlvbi55LCB6ID0gcXVhdGVybmlvbi56LCB3ID0gcXVhdGVybmlvbi53OwoJY29uc3QgeDIgPSB4ICsgeCwJeTIgPSB5ICsgeSwgejIgPSB6ICsgejsKCWNvbnN0IHh4ID0geCAqIHgyLCB4eSA9IHggKiB5MiwgeHogPSB4ICogejI7Cgljb25zdCB5eSA9IHkgKiB5MiwgeXogPSB5ICogejIsIHp6ID0geiAqIHoyOwoJY29uc3Qgd3ggPSB3ICogeDIsIHd5ID0gdyAqIHkyLCB3eiA9IHcgKiB6MjsKCgljb25zdCBzeCA9IHNjYWxlLngsIHN5ID0gc2NhbGUueSwgc3ogPSBzY2FsZS56OwoKCW1bMF0gPSAoIDEgLSAoIHl5ICsgenogKSApICogc3g7CgltWzFdID0gKCB4eSArIHd6ICkgKiBzeDsKCW1bMl0gPSAoIHh6IC0gd3kgKSAqIHN4OwoJbVszXSA9IDA7CgoJbVs0XSA9ICggeHkgLSB3eiApICogc3k7CgltWzVdID0gKCAxIC0gKCB4eCArIHp6ICkgKSAqIHN5OwoJbVs2XSA9ICggeXogKyB3eCApICogc3k7CgltWzddID0gMDsKCgltWzhdID0gKCB4eiArIHd5ICkgKiBzejsKCW1bOV0gPSAoIHl6IC0gd3ggKSAqIHN6OwoJbVsxMF0gPSAoIDEgLSAoIHh4ICsgeXkgKSApICogc3o7CgltWzExXSA9IDA7CgoJbVsxMl0gPSBwb3NpdGlvbi54OwoJbVsxM10gPSBwb3NpdGlvbi55OwoJbVsxNF0gPSBwb3NpdGlvbi56OwoJbVsxNV0gPSAxOwoKCXJldHVybiBtOwp9CgptYXRyaXg0LmRlY29tcG9zZSA9IChtKSA9PiB7Cgljb25zdCBwID0gdmVjdG9yMy56ZXJvKCk7Cgljb25zdCBxID0gcXVhdGVybmlvbi5pZGVudGl0eSgpOwoJY29uc3QgcyA9IHZlY3RvcjMuemVybygpOwoKCWxldCBzeCA9IHZlY3RvcjMubGVuZ3RoKHt4OiBtWzBdLCB5OiBtWzFdLCB6OiBtWzJdfSk7Cgljb25zdCBzeSA9IHZlY3RvcjMubGVuZ3RoKHt4OiBtWzRdLCB5OiBtWzVdLCB6OiBtWzZdfSk7Cgljb25zdCBzeiA9IHZlY3RvcjMubGVuZ3RoKHt4OiBtWzhdLCB5OiBtWzldLCB6OiBtWzEwXX0pOwoKCS8vIGlmIGRldGVybWluZSBpcyBuZWdhdGl2ZSwgd2UgbmVlZCB0byBpbnZlcnQgb25lIHNjYWxlCgljb25zdCBkZXQgPSBtYXRyaXg0LmRldGVybWluYW50KG0pOwoJaWYgKCBkZXQgPCAwICkgc3ggPSAtIHN4OwoKCXAueCA9IG1bMTJdOwoJcC55ID0gbVsxM107CglwLnogPSBtWzE0XTsKCgkvLyBzY2FsZSB0aGUgcm90YXRpb24gcGFydAoJbGV0IG0xID0gWy4uLm1dOwoKCWNvbnN0IGludlNYID0gMSAvIHN4OwoJY29uc3QgaW52U1kgPSAxIC8gc3k7Cgljb25zdCBpbnZTWiA9IDEgLyBzejsKCgltMVswXSAqPSBpbnZTWDsKCW0xWzFdICo9IGludlNYOwoJbTFbMl0gKj0gaW52U1g7CgoJbTFbNF0gKj0gaW52U1k7CgltMVs1XSAqPSBpbnZTWTsKCW0xWzZdICo9IGludlNZOwoKCW0xWzhdICo9IGludlNaOwoJbTFbOV0gKj0gaW52U1o7CgltMVsxMF0gKj0gaW52U1o7CgoJcXVhdGVybmlvbi5zZXRGcm9tUm90YXRpb25NYXRyaXgocSwgbTEpOwoKCXMueCA9IHN4OwoJcy55ID0gc3k7CglzLnogPSBzejsKCglyZXR1cm4gewoJCXBvc2l0aW9uOiBwLAoJCXF1YXRlcm5pb246IHEsCgkJc2NhbGU6IHMsCgl9Cn0KCm1hdHJpeDQuZGV0ZXJtaW5hbnQgPSAobSkgPT4gewoJY29uc3QgbjExID0gbVsgMCBdLCBuMTIgPSBtWyA0IF0sIG4xMyA9IG1bIDggXSwgbjE0ID0gbVsgMTIgXTsKCWNvbnN0IG4yMSA9IG1bIDEgXSwgbjIyID0gbVsgNSBdLCBuMjMgPSBtWyA5IF0sIG4yNCA9IG1bIDEzIF07Cgljb25zdCBuMzEgPSBtWyAyIF0sIG4zMiA9IG1bIDYgXSwgbjMzID0gbVsgMTAgXSwgbjM0ID0gbVsgMTQgXTsKCWNvbnN0IG40MSA9IG1bIDMgXSwgbjQyID0gbVsgNyBdLCBuNDMgPSBtWyAxMSBdLCBuNDQgPSBtWyAxNSBdOwoKCS8vVE9ETzogbWFrZSB0aGlzIG1vcmUgZWZmaWNpZW50CgkvLyggYmFzZWQgb24gaHR0cDovL3d3dy5ldWNsaWRlYW5zcGFjZS5jb20vbWF0aHMvYWxnZWJyYS9tYXRyaXgvZnVuY3Rpb25zL2ludmVyc2UvZm91ckQvaW5kZXguaHRtICkKCXJldHVybiAoCgkJbjQxICogKAoJCQkrIG4xNCAqIG4yMyAqIG4zMgoJCQkJLSBuMTMgKiBuMjQgKiBuMzIKCQkJCS0gbjE0ICogbjIyICogbjMzCgkJCQkrIG4xMiAqIG4yNCAqIG4zMwoJCQkJKyBuMTMgKiBuMjIgKiBuMzQKCQkJCS0gbjEyICogbjIzICogbjM0CgkJKSArCgkJbjQyICogKAoJCQkrIG4xMSAqIG4yMyAqIG4zNAoJCQkJLSBuMTEgKiBuMjQgKiBuMzMKCQkJCSsgbjE0ICogbjIxICogbjMzCgkJCQktIG4xMyAqIG4yMSAqIG4zNAoJCQkJKyBuMTMgKiBuMjQgKiBuMzEKCQkJCS0gbjE0ICogbjIzICogbjMxCgkJKSArCgkJbjQzICogKAoJCQkrIG4xMSAqIG4yNCAqIG4zMgoJCQkJLSBuMTEgKiBuMjIgKiBuMzQKCQkJCS0gbjE0ICogbjIxICogbjMyCgkJCQkrIG4xMiAqIG4yMSAqIG4zNAoJCQkJKyBuMTQgKiBuMjIgKiBuMzEKCQkJCS0gbjEyICogbjI0ICogbjMxCgkJKSArCgkJbjQ0ICogKAoJCQktIG4xMyAqIG4yMiAqIG4zMQoJCQkJLSBuMTEgKiBuMjMgKiBuMzIKCQkJCSsgbjExICogbjIyICogbjMzCgkJCQkrIG4xMyAqIG4yMSAqIG4zMgoJCQkJLSBuMTIgKiBuMjEgKiBuMzMKCQkJCSsgbjEyICogbjIzICogbjMxCgkJKQoJKTsKfQoKbWF0cml4NC5sb29rQXQgPSAobSwgZXllLCB0YXJnZXQsIHVwKSA9PiB7CglsZXQgeCwgeSwgejsKCgl6ID0gbWF0aC5zdWJ0cmFjdFZlY3RvcnModGFyZ2V0LCBleWUpOwoKCWlmICggdmVjdG9yMy5sZW5ndGhTcSh6KSA9PT0gMCApIHsKCQkvLyBleWUgYW5kIHRhcmdldCBhcmUgaW4gdGhlIHNhbWUgcG9zaXRpb24KCQl6LnogPSAxOwoJfQoKCXogPSBtYXRoLm5vcm1hbGl6ZVZlY3Rvcih6KTsKCXggPSB2ZWN0b3IzLmNyb3NzVmVjdG9ycyh1cCwgeik7CgoJaWYgKCB2ZWN0b3IzLmxlbmd0aFNxKHgpID09PSAwICkgewoJCS8vIHVwIGFuZCB6IGFyZSBwYXJhbGxlbAoJCWlmIChNYXRoLmFicyh1cC56KSA9PT0gMSkgewoJCQl6LnggKz0gMC4wMDAxOwoJCX0gZWxzZSB7CgkJCXoueiArPSAwLjAwMDE7CgkJfQoKCQl6ID0gbWF0aC5ub3JtYWxpemVWZWN0b3Ioeik7CgkJeCA9IHZlY3RvcjMuY3Jvc3NWZWN0b3JzKHVwLCB6KTsKCX0KCgl4ID0gbWF0aC5ub3JtYWxpemVWZWN0b3IoeCk7Cgl5ID0gdmVjdG9yMy5jcm9zc1ZlY3RvcnMoeiwgeCk7CgoJbVswXSA9IHgueDsgbVs0XSA9IHkueDsgbVs4XSA9IHoueDsKCW1bMV0gPSB4Lnk7IG1bNV0gPSB5Lnk7IG1bOV0gPSB6Lnk7CgltWzJdID0geC56OyBtWzZdID0geS56OyBtWzEwXSA9IHouejsKCglyZXR1cm4gbTsKfQoKbWF0cml4NC5sb2NhbE1hdHJpeEZyb21Cb3QgPSAoYm90LCBkaW1lbnNpb24pID0+IHsKCWNvbnN0IHAgPSB7CgkJeDogYm90LnRhZ3NbZGltZW5zaW9uICsgIlgiXSA/PyAwLAoJCXk6IGJvdC50YWdzW2RpbWVuc2lvbiArICJZIl0gPz8gMCwKCQl6OiBib3QudGFnc1tkaW1lbnNpb24gKyAiWiJdID8/IDAsCgl9OwoJY29uc3QgciA9IHsKCQl4OiBib3QudGFnc1tkaW1lbnNpb24gKyAiUm90YXRpb25YIl0gPz8gMCwKCQl5OiBib3QudGFnc1tkaW1lbnNpb24gKyAiUm90YXRpb25ZIl0gPz8gMCwKCQl6OiBib3QudGFnc1tkaW1lbnNpb24gKyAiUm90YXRpb25aIl0gPz8gMCwKCX07Cgljb25zdCBxID0gcXVhdGVybmlvbi5mcm9tRXVsZXIocik7Cgljb25zdCBzID0gewoJCXg6IGJvdC50YWdzWyJzY2FsZVgiXSA/PyAxLAoJCXk6IGJvdC50YWdzWyJzY2FsZVkiXSA/PyAxLAoJCXo6IGJvdC50YWdzWyJzY2FsZVkiXSA/PyAxLAoJfTsKCWNvbnN0IHNjYWxhciA9IGJvdC50YWdzWyJzY2FsZSJdID8/IDE7Cgl2ZWN0b3IzLm11bHRpcGx5U2NhbGFyKHMsIHNjYWxhcik7CgoJcmV0dXJuIG1hdHJpeDQuY29tcG9zZShwLCBxLCBzKTsKfQoKbWF0cml4NC53b3JsZE1hdHJpeEZyb21Cb3QgPSAoYm90LCBkaW1lbnNpb24pID0+IHsKCWxldCBtYXRyaXhXb3JsZCA9IG1hdHJpeDQuaWRlbnRpdHkoKTsKCWNvbnN0IG1hdHJpeExvY2FsID0gbWF0cml4NC5sb2NhbE1hdHJpeEZyb21Cb3QoYm90LCBkaW1lbnNpb24pOwoKCWNvbnN0IHBhcmVudElkID0gYm90LnRhZ3MudHJhbnNmb3JtZXI7CglsZXQgcGFyZW50ID0gcGFyZW50SWQgPyBnZXRCb3QoJ2lkJywgcGFyZW50SWQpIDogbnVsbDsKCglpZiAoIXBhcmVudCkgewoJCW1hdHJpeFdvcmxkID0gbWF0cml4TG9jYWw7Cgl9IGVsc2UgewoJCWNvbnN0IHBhcmVudE1hdHJpeFdvcmxkID0gbWF0cml4NC53b3JsZEZyb21Cb3QocGFyZW50LCBkaW1lbnNpb24pOwoJCW1hdHJpeFdvcmxkID0gbWF0cml4NC5tdWx0aXBseU1hdHJpY2VzKG1hdHJpeFdvcmxkLCBwYXJlbnRNYXRyaXhXb3JsZCwgbWF0cml4TG9jYWwpOwoJfQoKCXJldHVybiBtYXRyaXhXb3JsZDsKfScAiNSB6gMACmluaXRpYWxpemUCBACI1IHqA9CSAaANQGlmICh0YWdzLmluaXRpYWxpemVkKSB7CiAgICByZXR1cm47Cn0KCm1hc2tzLmluaXRpYWxpemVkID0gdHJ1ZTsKCmdyaWRQb3J0YWxCb3QudGFncy5wb3J0YWxDYW1lcmFUeXBlID0gJ3BlcnNwZWN0aXZlJzsKbGVmdFdyaXN0UG9ydGFsQm90LnRhZ3MucG9ydGFsR3JpZFNjYWxlID0gMC4wMjU7CnJpZ2h0V3Jpc3RQb3J0YWxCb3QudGFncy5wb3J0YWxHcmlkU2NhbGUgPSAwLjAyNTsKCi8vKioqIERPIFdFIE5FRUQgVEhJUz8/PyBJbml0aWFsaXplIGNvbmZpZyBib3Qgd2l0aCBjdXN0b20gdGFncyBhbmQgYWN0aW9ucy4KY29uZmlnQm90LnRhZ3MuaW5WUiA9IGZhbHNlOwoKY29uZmlnQm90LnRhZ3Mub25FbnRlclZSID0gYEAKICAgIHRhZ3MuaW5WUiA9IHRydWU7CmA7CmNvbmZpZ0JvdC50YWdzLm9uRXhpdFZSID0gYEAKICAgIHRhZ3MuaW5WUiA9IGZhbHNlOwpgOwpjb25maWdCb3QudGFncy5pbkFSID0gZmFsc2U7CmNvbmZpZ0JvdC50YWdzLm9uRW50ZXJBUiA9IGBACiAgICB0YWdzLmluQVIgPSB0cnVlOwpgOwpjb25maWdCb3QudGFncy5vbkV4aXRBUiA9IGBACiAgICB0YWdzLmluQVIgPSBmYWxzZTsKYDsKCmlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkfGlQaG9uZXxpUGFkfFdpbmRvd3MgUGhvbmV8TW9iaWxlL2kpKSB7CiAgICBjb25maWdCb3QudGFncy5pc01vYmlsZSA9IHRydWU7Cn0gZWxzZSB7CiAgICBjb25maWdCb3QudGFncy5pc01vYmlsZSA9IGZhbHNlOwp9CgovLyBDcmVhdGUgdGhlIG1haW4gc2NlbmUgZGltZW5zaW9uIGJvdC4KZ2xvYmFsVGhpcy5tYWluU2NlbmVCb3QgPSBjcmVhdGUoewogICAgc3BhY2U6ICd0ZW1wTG9jYWwnLAogICAgZm9ybTogJ2RpbWVuc2lvbicsCiAgICBmb3JtQWRkcmVzczogdGFncy5tYWluU2NlbmVEaW1lbnNpb24sCiAgICBbdGFncy5yb290RGltZW5zaW9uXTogdHJ1ZSwKICAgIFtgJHt0YWdzLnJvb3REaW1lbnNpb259WGBdOiAwLAogICAgW2Ake3RhZ3Mucm9vdERpbWVuc2lvbn1ZYF06IDAsCiAgICBbYCR7dGFncy5yb290RGltZW5zaW9ufVpgXTogMCwKICAgIFtgJHt0YWdzLnJvb3REaW1lbnNpb259Um90YXRpb25YYF06IDAsCiAgICBbYCR7dGFncy5yb290RGltZW5zaW9ufVJvdGF0aW9uWWBdOiAwLAogICAgW2Ake3RhZ3Mucm9vdERpbWVuc2lvbn1Sb3RhdGlvblpgXTogMCwKfSk7CgppZiAodGFncy5zaG93Q29tcGFzcyA9PT0gdHJ1ZSkgewogICAgY3JlYXRlKHsKICAgICAgICBzcGFjZTogJ3RlbXBMb2NhbCcsCiAgICAgICAgZm9ybTogJ3Nwcml0ZScsCiAgICAgICAgZm9ybUFkZHJlc3M6ICdodHRwczovL2J1aWxkZXItbHRtLWZpbGVzLnMzLmFtYXpvbmF3cy5jb20vMDE3NDRkNDc3NDNhYmI4MjcyNzViN2JiODY1ZjI2ZTQzODYwMzk3OThkOTc1M2Q1MjEzOTk1MTVkYzM3MGZhYi5wbmcnLAogICAgICAgIGRyYWdnYWJsZTogZmFsc2UsCiAgICAgICAgcG9pbnRhYmxlOiBmYWxzZSwKICAgICAgICBbdGFncy5tYWluU2NlbmVEaW1lbnNpb25dOiB0cnVlLAogICAgICAgIFtgJHt0YWdzLm1haW5TY2VuZURpbWVuc2lvbn1aYF06IC0xLjUsCiAgICAgICAgc2NhbGU6IDMsCiAgICB9KTsKfQoKZ2xvYmFsVGhpcy5pbW1lcnNpdmVNYW5hZ2VyID0gdGhpc0JvdDsKCnRoaXNCb3QuY29tcGlsZUNTUygpOwoKdGhpc0JvdC5vbkluaXRpYWxpemUoKTsKCmxpbmtzLmZydXN0dW0uZW5hYmxlRnJ1c3R1bSgpOycAiNSB6gMADXJvb3REaW1lbnNpb24CBACI1IHqA/GfAQdpbW1lcnNlJwCI1IHqAwASbWFpblNjZW5lRGltZW5zaW9uAgQAiNSB6gP5nwEEaG9tZScAiNSB6gMADG9uSW5pdGlhbGl6ZQIEAIjUgeoD/p8ByxFAdGhpc0JvdC5tb3VudCgpOwoKdGhpc0JvdC5pbml0aWFsaXplTWF0aCgpOwoKZ2xvYmFsVGhpcy50cmFuc2Zvcm0gPSB7fTsKCnRyYW5zZm9ybS5nZXRCb3RQb3NpdGlvbiA9IChib3QsIGRpbWVuc2lvbikgPT4gewogICAgcmV0dXJuIHsKICAgICAgICB4OiBib3QudGFnc1tgJHtkaW1lbnNpb259WGBdLAogICAgICAgIHk6IGJvdC50YWdzW2Ake2RpbWVuc2lvbn1ZYF0sCiAgICAgICAgejogYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVpgXSwKICAgIH0KfQoKdHJhbnNmb3JtLnNldEJvdFBvc2l0aW9uID0gKGJvdCwgZGltZW5zaW9uLCBwb3NpdGlvbikgPT4gewogICAgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVhgXSA9IHBvc2l0aW9uLng7CiAgICBib3QudGFnc1tgJHtkaW1lbnNpb259WWBdID0gcG9zaXRpb24ueTsKICAgIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1aYF0gPSBwb3NpdGlvbi56Owp9Cgp0cmFuc2Zvcm0uZ2V0Qm90Um90YXRpb24gPSAoYm90LCBkaW1lbnNpb24pID0+IHsKICAgIGNvbnN0IHJvdGF0aW9uID0gYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uYF07CiAgICBpZiAocm90YXRpb24pIHsKICAgICAgICByZXR1cm4gcm90YXRpb247CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHg6IGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblhgXSwKICAgICAgICAgICAgeTogYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWWBdLAogICAgICAgICAgICB6OiBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25aYF0sCiAgICAgICAgfQogICAgfQp9Cgp0cmFuc2Zvcm0uc2V0Qm90Um90YXRpb24gPSAoYm90LCBkaW1lbnNpb24sIHJvdGF0aW9uKSA9PiB7CiAgICBpZiAocm90YXRpb24ucXVhdGVybmlvbikgewogICAgICAgIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvbmBdID0gcm90YXRpb247CiAgICAgICAgZGVsZXRlIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblhgXTsKICAgICAgICBkZWxldGUgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWWBdOwogICAgICAgIGRlbGV0ZSBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25aYF07CiAgICB9IGVsc2UgewogICAgICAgIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblhgXSA9IHJvdGF0aW9uLng7CiAgICAgICAgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWWBdID0gcm90YXRpb24ueTsKICAgICAgICBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25aYF0gPSByb3RhdGlvbi56OwogICAgfQp9Cgp0cmFuc2Zvcm0uZ2V0Qm90U2NhbGUgPSAoYm90KSA9PiB7CiAgICByZXR1cm4gewogICAgICAgIHg6IGJvdC50YWdzW2BzY2FsZVhgXSwKICAgICAgICB5OiBib3QudGFnc1tgc2NhbGVZYF0sCiAgICAgICAgejogYm90LnRhZ3NbYHNjYWxlWmBdLAogICAgfQp9Cgp0cmFuc2Zvcm0uc2V0Qm90U2NhbGUgPSAoYm90LCBzY2FsZSkgPT4gewogICAgYm90LnRhZ3NbYHNjYWxlWGBdID0gc2NhbGUueDsKICAgIGJvdC50YWdzW2BzY2FsZVlgXSA9IHNjYWxlLnk7CiAgICBib3QudGFnc1tgc2NhbGVaYF0gPSBzY2FsZS56Owp9Cgp0cmFuc2Zvcm0ubG9va0F0UG9pbnQgPSAoZXllQm90LCBleWVCb3REaW1lbnNpb24sIHBvaW50KSA9PiB7CiAgICBjb25zdCB0YXJnZXRQb3MgPSB7Li4ucG9pbnR9OwogICAgY29uc3QgZXllUG9zID0gdHJhbnNmb3JtLmdldEJvdFBvc2l0aW9uKGV5ZUJvdCwgZXllQm90RGltZW5zaW9uKTsKICAgIAogICAgY29uc3QgZGlyZWN0aW9uID0gbWF0aC5zdWJ0cmFjdFZlY3RvcnModGFyZ2V0UG9zLCBleWVQb3MpOwoKICAgIGNvbnN0IGxvb2tSb3RhdGlvbiA9IG5ldyBSb3RhdGlvbih7CiAgICAgICAgZGlyZWN0aW9uLAogICAgICAgIHVwd2FyZHM6IG5ldyBWZWN0b3IzKDAsIDAsIDEpLAogICAgICAgIGVycm9ySGFuZGxpbmc6ICdudWRnZScsCiAgICB9KQoKICAgIHRyYW5zZm9ybS5zZXRCb3RSb3RhdGlvbihleWVCb3QsIGV5ZUJvdERpbWVuc2lvbiwgbG9va1JvdGF0aW9uKTsKfQoKdHJhbnNmb3JtLmxvb2tBdEJvdCA9ICggZXllQm90LCBleWVCb3REaW1lbnNpb24sIHRhcmdldEJvdCwgdGFyZ2V0RGltZW5zaW9uICkgPT4gewogICAgY29uc3QgdGFyZ2V0UG9zID0gdHJhbnNmb3JtLmdldEJvdFBvc2l0aW9uKCB0YXJnZXRCb3QsIHRhcmdldERpbWVuc2lvbiApOwogICAgdHJhbnNmb3JtLmxvb2tBdFBvaW50KGV5ZUJvdCwgZXllQm90RGltZW5zaW9uLCB0YXJnZXRQb3MpOwp9JwCI1IHqAwAKY29tcGlsZUNTUwIEAIjUgeoDyrEBvQRAZ2xvYmFsVGhpcy5jb21waWxlQ1NTID0gKGJvdHMpID0+IHsKICAgIGJvdHMgPSBBcnJheS5pc0FycmF5KGJvdHMpID8gYm90cyA6IFtib3RzXTsKCiAgICBsZXQgY3NzID0gW107CgogICAgZm9yIChsZXQgYm90IG9mIGJvdHMpIHsKICAgICAgICBmb3IgKGxldCBrZXkgaW4gYm90LnRhZ3MpIHsKICAgICAgICAgICAgaWYgKGtleS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKCdjc3MnKSkgewogICAgICAgICAgICAgICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW2NvbXBpbGVDU1NdIGZvdW5kIENTUyBrZXk6ICR7a2V5fWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3NzLnB1c2goYm90LnRhZ3Nba2V5XSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgY29uc3QgY29tcGlsZWQgPSBjc3Muam9pbignXG5cbicpOwogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgW2NvbXBpbGVDU1NdIGNvbXBpbGVkIENTUzpcblxuYCwgY29tcGlsZWQpOwogICAgfQoKICAgIHJldHVybiBjb21waWxlZDsKfTsnAIjUgeoDAA5vbkFCMUxlZnRXcmlzdAIEAIjUgeoDiLYBpwNAY29uZmlnQm90Lm1hc2tzLmxlZnRXcmlzdFBvcnRhbCA9IHRhZ3MubGVmdFdyaXN0UG9ydGFsTmFtZQoKbGVmdFdyaXN0UG9ydGFsQm90LnRhZ3Mud3Jpc3RQb3J0YWxXaWR0aCA9IC0xOwpsZWZ0V3Jpc3RQb3J0YWxCb3QudGFncy53cmlzdFBvcnRhbEhlaWdodCA9IC0xOwoKLy8gQ29tcGFzcyBDYWxpYnJhdGlvbiBCdXR0b24KY3JlYXRlKHRoaXNCb3QuYnV0dG9uKHsKICAgIHNwYWNlOiAndGVtcExvY2FsJywKICAgIGRpbWVuc2lvbjogdGFncy5sZWZ0V3Jpc3RQb3J0YWxOYW1lLAogICAgZGltZW5zaW9uWDogNS41LAogICAgZGltZW5zaW9uWTogMywKICAgIGxhYmVsOiAnQ29tcGFzcyBDYWxpYnJhdGlvbicsCiAgICBvbkNsaWNrOiBgQAogICAgICAgIGltbWVyc2l2ZU1hbmFnZXIuY29tcGFzc0NhbGlicmF0aW9uKCk7CiAgICBgCn0pKTsnAIjUgeoDAAlvbkRlc3Ryb3kCBACI1IHqA7C5AYYBQGdsb2JhbFRoaXMuY29tcGlsZUNTUyA9IHVuZGVmaW5lZDsKZ2xvYmFsVGhpcy5tYXRoVXRpbHMgPSB1bmRlZmluZWQ7Cmdsb2JhbFRoaXMudHJhbnNmb3JtID0gdW5kZWZpbmVkOwoKY2xlYXJJbnRlcnZhbCh0YWdzLmludGVydmFsKTsnAIjUgeoDAANBcHACBACI1IHqA7e6AaIIQGNvbnN0IGNzcyA9IGNvbXBpbGVDU1MoWyB0aGlzQm90IF0pCmNvbnN0IHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gPSBvcy5hcHBIb29rczsKCmNvbnN0IEVudGVyWFJCdXR0b24gPSAoeyBtb2RlLCBvbkNsaWNrIH0pID0+IHsKICAgIGlmIChtb2RlICE9PSAndnInICYmIG1vZGUgIT09ICdhcicpIHsKICAgICAgICBjb25zb2xlLndhcm4oYFtFbnRlclhSQnV0dG9uXSBVbmtub3duIG1vZGUgJHttb2RlfSwgZGVmYXVsdGluZyB0byB2cmApOwogICAgICAgIG1vZGUgPSAndnInOwogICAgfQoKICAgIHJldHVybiAoCiAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9J2VudGVyLXhyLWJ1dHRvbicgb25DbGljaz17b25DbGlja30+RW50ZXIge21vZGUudG9VcHBlckNhc2UoKX08L2J1dHRvbj4KICAgICkKfQoKY29uc3QgQXBwID0gKCkgPT4gewogICAgY29uc3Qgb25FbnRlclZSQ2xpY2sgPSAoKSA9PiB7CiAgICAgICAgb3MuZW5hYmxlVlIoKTsKICAgIH0KCiAgICBjb25zdCBvbkVudGVyQVJDbGljayA9ICgpID0+IHsKICAgICAgICBvcy5lbmFibGVBUigpOwogICAgfQoKICAgIGxldCBzdXBwb3J0c0FSID0gb3MuZGV2aWNlKCkuc3VwcG9ydHNBUjsKICAgIGxldCBzdXBwb3J0c1ZSID0gb3MuZGV2aWNlKCkuc3VwcG9ydHNWUjsKCiAgICByZXR1cm4gKAogICAgICAgIDw+ICAKICAgICAgICAgICAgPHN0eWxlPntjc3N9PC9zdHlsZT4KICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2VudGVyLXhyLWJ1dHRvbnMnPgogICAgICAgICAgICAgICAgeyBzdXBwb3J0c0FSICYmCiAgICAgICAgICAgICAgICAgICAgPEVudGVyWFJCdXR0b24gbW9kZT0nYXInIG9uQ2xpY2s9e29uRW50ZXJBUkNsaWNrfS8+CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB7IHN1cHBvcnRzVlIgJiYgCiAgICAgICAgICAgICAgICAgICAgPEVudGVyWFJCdXR0b24gbW9kZT0ndnInIG9uQ2xpY2s9e29uRW50ZXJWUkNsaWNrfS8+CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAKICAgICAgICA8Lz4KICAgICkKfQoKcmV0dXJuIEFwcDsnAIjUgeoDAAVtb3VudAIEAIjUgeoD2sIBmAFAaWYgKCF0aGlzQm90LnZhcnMuYXBwSW5zdGFuY2UpIHsKICAgIHRoaXNCb3QudmFycy5hcHBJbnN0YW5jZSA9IHRoaXNCb3QuQXBwKCk7CiAgICBhd2FpdCBvcy5yZWdpc3RlckFwcCh0YWdzLmFwcElkLCB0aGlzQm90KTsKCiAgICB0aGlzQm90LnJlZnJlc2goKTsKfScAiNSB6gMAB3JlZnJlc2gCBACI1IHqA/PDAVtAY29uc3QgQXBwID0gdGhpc0JvdC52YXJzLmFwcEluc3RhbmNlOwoKaWYgKEFwcCkgewogICAgb3MuY29tcGlsZUFwcCh0YWdzLmFwcElkLCA8QXBwLz4pOwp9JwCI1IHqAwAHdW5tb3VudAIEAIjUgeoDz8QBkQFAaWYgKHRoaXNCb3QudmFycy5hcHBJbnN0YW5jZSkgewogICAgdGhpc0JvdC52YXJzID0ge307CiAgICBjbGVhclRhZ01hc2tzU3RhcnRpbmdXaXRoKHRoaXNCb3QsICdhcHBfJyk7CiAgICBhd2FpdCBvcy51bnJlZ2lzdGVyQXBwKHRhZ3MuYXBwSWQpOwp9JwCI1IHqAwAHQXBwLmNzcwIEAIjUgeoD4cUB2wQuZW50ZXIteHItYnV0dG9ucyB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IHJvdzsKICAgIHdpZHRoOiAxMDAlOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBjb2x1bW4tZ2FwOiA0MHB4OwogICAgYm90dG9tOiAxNXZoOwp9CgouZW50ZXIteHItYnV0dG9ucyBidXR0b24gewogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICBjb2xvcjogd2hpdGU7CiAgICBmb250LXNpemU6IDEuMjVlbTsKICAgIHBhZGRpbmc6IDE0cHggMjhweDsKICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgIGJvcmRlci1zdHlsZTogc29saWQ7CiAgICBib3JkZXItd2lkdGg6IDJweDsKICAgIGJvcmRlci1jb2xvcjogd2hpdGU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQoKQG1lZGlhIChob3ZlcikgewogICAgLmVudGVyLXhyLWJ1dHRvbnMgYnV0dG9uOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjY2OwogICAgfQp9CgouZW50ZXIteHItYnV0dG9ucyBidXR0b246YWN0aXZlIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICM4ODg7Cn0nAIjUgeoDAAVhcHBJZAIEAIjUgeoDvcoBA2FwcCcAiNSB6gMAG2xlZnRXcmlzdENhbGlicmF0aW9uQnV0dG9ucwIEAIjUgeoDwcoBBHRydWUnAIjUgeoDAAtzaG93Q29tcGFzcwIEAIjUgeoDxsoBBHRydWUnAIjUgeoDAA9mcm9tVG9EaW1lbnNpb24CBACI1IHqA8vKAYQDQGNvbnN0IHsgYm90LCBmcm9tLCB0byB9ID0gdGhhdDsKCmJvdC50YWdzW2Zyb21dID0gbnVsbDsKYm90LnRhZ3NbdG9dID0gdHJ1ZTsKCmNvbnN0IGZyb21Qb3NpdGlvbiA9IHRyYW5zZm9ybS5nZXRCb3RQb3NpdGlvbihib3QsIGZyb20pOwpjb25zdCBmcm9tUm90YXRpb24gPSB0cmFuc2Zvcm0uZ2V0Qm90Um90YXRpb24oYm90LCBmcm9tKTsKY29uc3QgZnJvbVNjYWxlID0gdHJhbnNmb3JtLmdldEJvdFNjYWxlKGJvdCwgZnJvbSk7Cgp0cmFuc2Zvcm0uc2V0Qm90UG9zaXRpb24oYm90LCB0bywgZnJvbVBvc2l0aW9uKTsKdHJhbnNmb3JtLnNldEJvdFJvdGF0aW9uKGJvdCwgdG8sIGZyb21Sb3RhdGlvbik7CnRyYW5zZm9ybS5zZXRCb3RTY2FsZShib3QsIHRvLCBmcm9tU2NhbGUpOycAiNSB6gMADG9uQW55Qm90RHJhZwIEAIjUgeoD0M0BoQdAaWYgKCF0YWdzLmluaXRpYWxpemVkKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IGRpbSA9IHRoYXQuZnJvbS5kaW1lbnNpb247CmNvbnN0IGRyYWdCb3QgPSB0aGF0LmJvdDsKCi8vTUFZIE5FRUQgVE8gUkVGSU5FIFRISVMKY29uc3QgaXNGcm9tSGFuZGxlZERpbWVuc2lvbiA9IGRpbSA9PT0gJ2hvbWUnIHx8IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGltID09PSBtYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzcyB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpbSA9PT0gdGFncy5sZWZ0V3Jpc3RQb3J0YWxOYW1lOwoKaWYgKCFpc0Zyb21IYW5kbGVkRGltZW5zaW9uKSB7CiAgICByZXR1cm47Cn0KCmNvbnN0IGlzVG9CZUlnbm9yZWQgPSBkcmFnQm90LnRhZ3MuaWdub3JlTWFpblNjZW5lSGFuZGxlcjsKaWYgKGlzVG9CZUlnbm9yZWQpIHsKICAgIHJldHVybjsKfQoKZHJhZ0JvdC50YWdzLm1haW5TY2VuZUhhbmRsZXJPYnNlcnZpbmcgPSB0cnVlOwoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX1dIGFkZCBkcm9wIGdyaWRzYCk7Cn0KCm9zLmFkZERyb3BHcmlkKAogICAgewogICAgICAgIHBvcnRhbEJvdDogbWFpblNjZW5lQm90LAogICAgICAgIHNob3dHcmlkOiBmYWxzZSwKICAgICAgICBwcmlvcml0eTogMTAwLAogICAgICAgIGJvdW5kczogeyB4OiAxMDAwMCwgeTogMTAwMDAgfQogICAgfSwKICAgIHsKICAgICAgICBwb3J0YWxCb3Q6IGNvbmZpZ0JvdCwKICAgICAgICBwb3J0YWxUYWc6ICdsZWZ0V3Jpc3RQb3J0YWwnLAogICAgICAgIHByaW9yaXR5OiAyMDAsCiAgICAgICAgc2hvd0dyaWQ6IHRydWUsCiAgICAgICAgcG9zaXRpb246IHsgeDogMywgeTogMiwgejogMCB9LAogICAgICAgIGJvdW5kczogeyB4OiAxMCwgeTogMTAgfQogICAgfQopCicAiNSB6gMADG9uQW55Qm90RHJvcAIEAIjUgeoD8tQBngVAaWYgKCF0YWdzLmluaXRpYWxpemVkKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IGRyYWdCb3QgPSB0aGF0LmJvdDsKCmlmIChkcmFnQm90LnRhZ3MubWFpblNjZW5lSGFuZGxlck9ic2VydmluZykgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19XSBvbiBoYW5kbGVkIGJvdCBkcm9wcGVkYCk7CiAgICB9CgogICAgZHJhZ0JvdC50YWdzLm1haW5TY2VuZUhhbmRsZXJPYnNlcnZpbmcgPSBudWxsOwogICAgCiAgICBjb25zdCBib3RJbkhvbWUgPSBkcmFnQm90LnRhZ3MuaG9tZSA9PT0gdHJ1ZTsKICAgIGNvbnN0IGJvdEluTWFpblNjZW5lID0gZHJhZ0JvdC50YWdzW21haW5TY2VuZUJvdC50YWdzLmZvcm1BZGRyZXNzXSA9PT0gdHJ1ZTsKCiAgICBpZiAoYm90SW5Ib21lICYmICFib3RJbk1haW5TY2VuZSkgewogICAgICAgIC8vIElmIGEgYm90IHRoYXQgd2FzIGJlaW5nIGhhbmRsZWQgc29tZWhvdyBlbmRzIHVwIGluIHRoZSBob21lIGRpbWVuc2lvbiwgdGhlbiBtb3ZlIGl0IGJhY2sgdG8gdGhlIG1haW5TY2VuZSBkaW1lbnNpb24uCiAgICAgICAgdGhpc0JvdC5mcm9tVG9EaW1lbnNpb24oeyBib3Q6IGRyYWdCb3QsIGZyb206ICdob21lJywgdG86IG1haW5TY2VuZUJvdC50YWdzLmZvcm1BZGRyZXNzIH0pOwogICAgfQp9JwCI1IHqAwALb25BbnlDcmVhdGUCBACI1IHqA5HaAe4MQGlmICghdGFncy5pbml0aWFsaXplZCkKewogICAgcmV0dXJuOwp9Cgpjb25zdCB7IGJvdCB9ID0gdGhhdDsKCmxldCBjcmVhdGVkQnlBQjEgPSBmYWxzZTsKbGV0IGlzQUIxQm90ID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYjFCb3QgPyBib3QuaWQgPT09IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWIxQm90LmlkIDogZmFsc2U7IC8vYm90LnRhZ3MuYWIxID09PSB0cnVlIHx8IGJvdC50YWdzLmFiMUlEOwoKaWYgKGJvdC50YWdzLmNyZWF0b3IpIHsKICAgIGNvbnN0IGNyZWF0b3JCb3QgPSBnZXRCb3QoJ2lkJywgYm90LnRhZ3MuY3JlYXRvcik7CiAgICBjcmVhdGVkQnlBQjEgPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCA/IGNyZWF0b3JCb3QuaWQgPT09IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWIxQm90LmlkIDogZmFsc2U7Cn0KCmlmIChnbG9iYWxUaGlzLm1haW5TY2VuZUJvdCkgewogICAgY29uc3QgYm90SW5Ib21lID0gYm90LnRhZ3MuaG9tZSA9PT0gdHJ1ZTsKICAgIGNvbnN0IGJvdEluTWFpblNjZW5lID0gYm90LnRhZ3NbbWFpblNjZW5lQm90LnRhZ3MuZm9ybUFkZHJlc3NdID09PSB0cnVlOwoKICAgIGlmIChib3RJbkhvbWUgJiYgIWJvdEluTWFpblNjZW5lKSB7CiAgICAgICAgaWYgKGNyZWF0ZWRCeUFCMSkgewogICAgICAgICAgICBpZiAodGFncy5tb3ZlQm90c0NyZWF0ZWRCeUFCMSkgewogICAgICAgICAgICAgICAgLy8gSWYgZW5hYmxlZCwgYWxsIGJvdHMgY3JlYXRlZCBieSBhYjEgaW4gdGhlIGhvbWUgZGltZW5zaW9uIHNob3VsZCBiZSBtb3ZlZCB0byB0aGUgbWFpblNjZW5lIGRpbWVuc2lvbi4KICAgICAgICAgICAgICAgIHRoaXNCb3QuZnJvbVRvRGltZW5zaW9uKHsgYm90LCBmcm9tOiAnaG9tZScsIHRvOiBtYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzcyB9KTsKCiAgICAgICAgICAgICAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX1dIG1vdmVkIGFiMSBjcmVhdGVkIGJvdCAke2JvdC5pZH0gZnJvbSBob21lIHRvICR7bWFpblNjZW5lQm90LnRhZ3MuZm9ybUFkZHJlc3N9IGRpbWVuc2lvbmApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHRhZ3MubW92ZUJvdHNDcmVhdGVkQnlPdGhlciAmJiAhaXNBQjFCb3QpIHsKICAgICAgICAgICAgICAgIC8vIElmIGVuYWJsZWQsIGFsbCBib3RzIGNyZWF0ZWQgaW4gdGhlIGhvbWUgZGltZW5zaW9uIHNob3VsZCBiZSBtb3ZlZCB0byB0aGUgbWFpblNjZW5lIGRpbWVuc2lvbi4KICAgICAgICAgICAgICAgIHRoaXNCb3QuZnJvbVRvRGltZW5zaW9uKHsgYm90LCBmcm9tOiAnaG9tZScsIHRvOiBtYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzcyB9KTsKCiAgICAgICAgICAgICAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX1dIG1vdmVkIGNyZWF0ZWQgYm90ICR7Ym90LmlkfSBmcm9tIGhvbWUgdG8gJHttYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzc30gZGltZW5zaW9uYCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0nAIjUgeoDAAVkZWJ1ZwIEAIjUgeoDgOcBBHRydWUnAIjUgeoDABRtb3ZlQm90c0NyZWF0ZWRCeUFCMQIEAIjUgeoDhecBBHRydWUnAIjUgeoDABZtb3ZlQm90c0NyZWF0ZWRCeU90aGVyAgQAiNSB6gOK5wEFZmFsc2UnAIjUgeoDAAZidXR0b24CBACI1IHqA5DnAZ8IQGNvbnN0IHsgCiAgICBzcGFjZT0gJ3RlbXBMb2NhbCcsCiAgICBsYWJlbCA9ICdCdXR0b24nLAogICAgb25DbGljayA9IGBAb3MudG9hc3QoJ2J1dHRvbiBjbGlja2VkJylgLAogICAgZGltZW5zaW9uLAogICAgZGltZW5zaW9uWCA9IDAsCiAgICBkaW1lbnNpb25ZID0gMCwKICAgIGRpbWVuc2lvblogPSAwLAogICAgb25BZGRlZCwKfSA9IHRoYXQ7Cgphc3NlcnQoZGltZW5zaW9uLCAnW2J1dHRvbl0gZGltZW5zaW9uIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwoKY29uc3QgYnV0dG9uTW9kID0gewogICAgc3BhY2UsCiAgICBsYWJlbCwKICAgIG9uQnV0dG9uQ2xpY2s6IG9uQ2xpY2ssCiAgICBzY2FsZVg6IDEuOSwKICAgIHNjYWxlWTogMC45LAogICAgc2NhbGVaOiAwLjMsCiAgICBkcmFnZ2FibGU6IGZhbHNlLAogICAgW2RpbWVuc2lvbl06IHRydWUsCiAgICBbZGltZW5zaW9uICsgJ1gnXTogZGltZW5zaW9uWCwKICAgIFtkaW1lbnNpb24gKyAnWSddOiBkaW1lbnNpb25ZLAogICAgW2RpbWVuc2lvbiArICdaJ106IGRpbWVuc2lvblosCiAgICBvbkFkZGVkLAogICAgb25Cb3RBZGRlZDogYEAKICAgICAgICB3aGlzcGVyKHRoaXNCb3QsICdvbkFkZGVkJyk7CiAgICBgLAogICAgb25DbGljazogYEAKICAgICAgICB3aGlzcGVyKHRoaXNCb3QsICdvbkJ1dHRvbkNsaWNrJyk7CiAgICAgICAgbWFza3MuY29sb3IgPSBudWxsOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IG51bGw7CiAgICBgLAogICAgb25Qb2ludGVyRG93bjogYEAKICAgICAgICBtYXNrcy5jb2xvciA9ICdyb3lhbGJsdWUnOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IDAuMTsKICAgIGAsCiAgICBvblBvaW50ZXJVcDogYEAKICAgICAgICBtYXNrcy5zY2FsZVogPSBudWxsOwogICAgYCwKICAgIG9uUG9pbnRlckVudGVyOiBgQAogICAgICAgIG1hc2tzLmNvbG9yID0gJ3NreWJsdWUnOwogICAgYCwKICAgIG9uUG9pbnRlckV4aXQ6IGBACiAgICAgICAgbWFza3MuY29sb3IgPSBudWxsOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IG51bGw7CiAgICBgLAp9CgpyZXR1cm4gWyBidXR0b25Nb2QgXTsnAIjUgeoDABJjb21wYXNzQ2FsaWJyYXRpb24CBACI1IHqA7DvAf8CQGlmICghZ2xvYmFsVGhpcy5tYWluU2NlbmVCb3QpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ0NvbXBhc3MgY2FsaWJyYXRpb24gbmVlZHMgbWFpblNjZW5lQm90IHRvIGJlIGxvYWRlZC4nKTsKICAgIHJldHVybjsKfQoKY29uc3QgZGltID0gb3MuZ2V0Q3VycmVudERpbWVuc2lvbigpOwpjb25zdCBjYW1Qb3MgPSBvcy5nZXRDYW1lcmFQb3NpdGlvbignZ3JpZCcpOwoKbWFpblNjZW5lQm90LnRhZ3NbYCR7ZGltfVhgXSA9IGNhbVBvcy54OwptYWluU2NlbmVCb3QudGFnc1tgJHtkaW19WWBdID0gY2FtUG9zLnk7Cgpjb25zdCBjYW1Sb3QgPSBvcy5nZXRDYW1lcmFSb3RhdGlvbignZ3JpZCcpOwptYWluU2NlbmVCb3QudGFnc1tgJHtkaW19Um90YXRpb25aYF0gPSBjYW1Sb3QuejsoAIjUgeoDAA1hYjFCb3RWZXJzaW9uAX0GJwCI1IHqAwAJYWIxSWdub3JlAgQAiNSB6gOx8gEEdHJ1ZScAiNSB6gMAB2ZydXN0dW0CBACI1IHqA7byASjwn5SXZjg1YWQwYTAtMjA0ZC00YmNkLWIyMTgtN2EyMzM3NGI1MDk4JwCI1IHqAwANbWFuaWZlc3RhdGlvbgIEAIjUgeoD3fIBKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAIjUgeoDAApvbkJvdEFkZGVkAgQAiNSB6gOE8wG4AUBhd2FpdCBvcy5zbGVlcCg1MDApOwoKbGV0IHN1cHBvcnRzQVIgPSBvcy5kZXZpY2UoKS5zdXBwb3J0c0FSOwpsZXQgc3VwcG9ydHNWUiA9IG9zLmRldmljZSgpLnN1cHBvcnRzVlI7CgppZiAoc3VwcG9ydHNBUiB8fCBzdXBwb3J0c1ZSKQp7CiAgICBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gImltbWVyc2l2ZSI7Cn0nAQRib3RzJGY4NWFkMGEwLTIwNGQtNGJjZC1iMjE4LTdhMjMzNzRiNTA5OAEnAIjUgeoDvfQBD19fZnJ1c3R1bVVwZGF0ZQIEAIjUgeoDvvQB4QtAaWYgKCAhZ2xvYmFsVGhpcy5tYXRyaXg0IHx8ICFnbG9iYWxUaGlzLnRyYW5zZm9ybSApIHsKICAgIC8vIE5lZWQgdG8gd2FpdCBmb3IgdGhlIG1hdGggYW5kIHRyYW5zZm9ybSBsaWJyYXJpZXMgdG8gYmUgbG9hZGVkLgogICAgcmV0dXJuOwp9Cgpjb25zdCBjYW1Qb3MgPSB7CiAgICB4OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25YLAogICAgeTogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVBvc2l0aW9uWSwKICAgIHo6IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFQb3NpdGlvblosCn07Cgpjb25zdCBjYW1Sb3QgPSBuZXcgUm90YXRpb24oewogICAgZXVsZXI6IHsKICAgICAgICB4OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUm90YXRpb25YLAogICAgICAgIHk6IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFSb3RhdGlvblksCiAgICAgICAgejogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVJvdGF0aW9uWiwKICAgIH0KfSk7Cgpjb25zdCBmcnVzdHVtRGltID0gdGFncy5jdXJyZW50RGltZW5zaW9uOwoKaWYgKCBnbG9iYWxUaGlzLm1haW5TY2VuZUJvdCAmJiBmcnVzdHVtRGltID09PSBsaW5rcy5pbW1lcnNpdmVNYW5hZ2VyLnRhZ3MubWFpblNjZW5lRGltZW5zaW9uICkgewogICAgLy8gVHJhbnNsYXRlIGNhbWVyYSdzIGdyaWRQb3J0YWwgcG9zaXRpb24gdG8gYmUgaW4gbWFpblNjZW5lIGxvY2FsIHNwYWNlLgogICAgY29uc3QgbXNNYXRyaXggPSBtYXRyaXg0LndvcmxkTWF0cml4RnJvbUJvdCggbWFpblNjZW5lQm90LCAnaG9tZScgKTsKICAgIGNvbnN0IGNhbUxvY2FsUG9zID0gdmVjdG9yMy53b3JsZFRvTG9jYWwoIHsuLi5jYW1Qb3N9LCBtc01hdHJpeCApOwogICAgdHJhbnNmb3JtLnNldEJvdFBvc2l0aW9uKCB0aGlzQm90LCBmcnVzdHVtRGltLCBjYW1Mb2NhbFBvcyApOwoKICAgIC8vIEZpbmQgcG9pbnQgaW4gZnJvbnQgb2YgY2FtZXJhIHRoYXQgd2UgY2FuOgogICAgLy8gMS4gVHJhbnNsYXRlIHRvIG1haW5TY2VuZSBsb2NhbCBzcGFjZS4KICAgIC8vIDIuIENhbGN1bGF0ZSBhIGxvb2sgcm90YXRpb24gd2l0aC4KICAgIGNvbnN0IGNhbUZvcndhcmQgPSBtYXRoLmdldEZvcndhcmREaXJlY3Rpb24oIGNhbVJvdCApOwogICAgbGV0IGxvb2tQb2ludCA9IG1hdGguYWRkVmVjdG9ycyggey4uLmNhbVBvc30sIG1hdGguc2NhbGVWZWN0b3IoIGNhbUZvcndhcmQsIDQpICk7CiAgICBsb29rUG9pbnQgPSB2ZWN0b3IzLndvcmxkVG9Mb2NhbCggey4uLmxvb2tQb2ludH0sIG1zTWF0cml4ICk7CgogICAgdHJhbnNmb3JtLmxvb2tBdFBvaW50KHRoaXNCb3QsIGZydXN0dW1EaW0sIGxvb2tQb2ludCk7Cn0gZWxzZSB7CiAgICAvLyBVc2UgY2FtZXJhJ3MgZ3JpZFBvcnRhbCBwb3NpdGlvbiBhcy1pcy4KICAgIHRyYW5zZm9ybS5zZXRCb3RQb3NpdGlvbiggdGhpc0JvdCwgZnJ1c3R1bURpbSwgY2FtUG9zICk7CiAgICB0cmFuc2Zvcm0uc2V0Qm90Um90YXRpb24oIHRoaXNCb3QsIGZydXN0dW1EaW0sIGNhbVJvdCApOwp9CicAiNSB6gO99AEKX19vbkNyZWF0ZQIEAIjUgeoDoIACWkBtYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHdoaXNwZXIodGhpc0JvdCwgJ2ZydXN0dW1VcGRhdGUnKSwgdGFncy51cGRhdGVSYXRlTVMpOygAiNSB6gO99AELX19vbkRlc3Ryb3kBficAiNSB6gO99AERX19vblBvcnRhbENoYW5nZWQCBACI1IHqA/yAAoYEQGlmICh0aGF0LnBvcnRhbCA9PT0gJ2dyaWRQb3J0YWwnKSB7CiAgICBpZiAodGhhdC5kaW1lbnNpb24gPT09ICdpbW1lcnNlJykgewogICAgICAgIC8vIFJlbWFwIGhvbWUgZGltZW5zaW9uIHRvIG1haW5TY2VuZURpbWVuc2lvbi4KICAgICAgICAvLyBUaGUgaG9tZSBkaW1lbnNpb25zIGlzIG9ubHkgdXNlZCB0byB0aGUgbWFpblNjZW5lRGltZW5zaW9uIHRvIG1vdmUKICAgICAgICAvLyBhcm91bmQgaW4gc28gd2UgZG9udCB3YW50IHRvIG1vdmUgb3VyIGZydXN0dW0gdGhlcmUsIHdlIHdhbnQgdG8ga2VlcCBwdXQgaXQgaW4gbWFpblNjZW5lRGltZW5zaW9uLgogICAgICAgIHRoYXQuZGltZW5zaW9uID0gbGlua3MuaW1tZXJzaXZlTWFuYWdlci50YWdzLm1haW5TY2VuZURpbWVuc2lvbjsKICAgIH0KCiAgICB0YWdzW3RhZ3MuY3VycmVudERpbWVuc2lvbl0gPSBudWxsOwogICAgdGFncy5jdXJyZW50RGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CiAgICB0YWdzW3RoYXQuZGltZW5zaW9uXSA9IHRydWU7Cn0nAIjUgeoDvfQBDl9fdXBkYXRlUmF0ZU1TAgQAiNSB6gODhQIDMjUwJwCI1IHqA730AQphYklET3JpZ2luAgQAiNSB6gOHhQILcmMteHItYWxwaGEnAIjUgeoDvfQBDWF1eENvZGVPcmlnaW4CBACI1IHqA5OFAgVyYy14cicAiNSB6gO99AEOZGlzYWJsZUZydXN0dW0CBACI1IHqA5mFAtQCQC8vIFtSeWFuXSBOZWVkIHRvIGluY2x1ZGUgc2FtZSBzbGVlcCB0aW1lIGFzIGVuYWJsZUZydXN0dW0gdG8gZW5zdXJlIGl0IHJ1bnMgaW4KLy8gdGhlIHNhbWUgb3JkZXIgaWYgYm90aCBhcmUgY2FsbGVkLgphd2FpdCBvcy5zbGVlcCg1MDApOwoKLy8gRGVzdHJveSBwcmV2aW91cyBmcnVzdHVtIGlmIGl0IGV4aXN0cy4KaWYgKG1hc2tzLmZydXN0dW1Cb3RJZCkgewogICAgY29uc29sZS5sb2coYFtyZW1vdGVGcnVzdHVtXSBkaXNhYmxlIGZydXN0dW1gKTsKICAgIGRlc3Ryb3koZ2V0Qm90KCdpZCcsIG1hc2tzLmZydXN0dW1Cb3RJZCkpOwogICAgbWFza3MuZnJ1c3R1bUJvdElkID0gbnVsbDsKfScAiNSB6gO99AENZW5hYmxlRnJ1c3R1bQIEAIjUgeoD7ocC6QtAbGV0IHByZXZpb3VzRnJ1c3R1bUJvdCA9IG1hc2tzLmZydXN0dW1Cb3RJZCA/IGdldEJvdCgnaWQnLCBtYXNrcy5mcnVzdHVtQm90SWQpIDogbnVsbDsKaWYgKHByZXZpb3VzRnJ1c3R1bUJvdCkgewogICAgLy8gRnJ1c3R1bSBib3QgaXMgYWxyZWFkeSBhY3RpdmUuCiAgICByZXR1cm47Cn0KCmNvbnNvbGUubG9nKGBbcmVtb3RlRnJ1c3R1bV0gZW5hYmxlIGZydXN0dW1gKTsKCi8vIFtSeWFuXSBGb3Igc29tZSByZWFzb24gd2FpdGluZyBoYWxmIGEgc2Vjb25kIGhlcmUgZml4ZXMgYSBidWcKLy8gdGhhdCBjYXVzZXMgQVVYIHRvIHB1dCB0aGUgZmlyc3QgdXNlcidzIGZydXN0dW0gaW4gdGhlICJzaGFyZWQiIHNwYWNlLgphd2FpdCBvcy5zbGVlcCg1MDApOwoKY29uc3QgZGltID0gbGlua3MuaW1tZXJzaXZlTWFuYWdlci50YWdzLm1haW5TY2VuZURpbWVuc2lvbjsKY29uc3QgZnJ1c3R1bU1vZCA9IHt9OwoKZnJ1c3R1bU1vZC5zcGFjZSA9ICJ0ZW1wU2hhcmVkIjsKZnJ1c3R1bU1vZC5mbWZydXN0dW0gPSB0cnVlOwpmcnVzdHVtTW9kLmZydXN0dW1JRCA9IGNvbmZpZ0JvdC5pZDsKZnJ1c3R1bU1vZC5mb3JtID0gImZydXN0dW0iOwpmcnVzdHVtTW9kLnBvaW50YWJsZSA9IGZhbHNlOwpmcnVzdHVtTW9kLm1haW5TY2VuZURpbWVuc2lvbiA9IGxpbmtzLmltbWVyc2l2ZU1hbmFnZXIudGFncy5tYWluU2NlbmVEaW1lbnNpb247CmZydXN0dW1Nb2QuY3VycmVudERpbWVuc2lvbiA9IGRpbTsKCmZydXN0dW1Nb2RbZGltXSA9IHRydWU7CmZydXN0dW1Nb2RbZGltKyJSb3RhdGlvbiJdID0gYPCflIEwLDAsMCwxYDsKZnJ1c3R1bU1vZFtkaW0rIlgiXSA9IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFQb3NpdGlvblg7CmZydXN0dW1Nb2RbZGltKyJZIl0gPSBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25ZOwpmcnVzdHVtTW9kW2RpbSsiWiJdID0gZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVBvc2l0aW9uWjsKZnJ1c3R1bU1vZC5pbW1lcnNpdmVNYW5hZ2VyID0gdGFncy5pbW1lcnNpdmVNYW5hZ2VyOwpmcnVzdHVtTW9kLnVwZGF0ZVJhdGVNUyA9IHRhZ3MuX191cGRhdGVSYXRlTVM7CmZydXN0dW1Nb2Qub25DcmVhdGUgPSB0YWdzLl9fb25DcmVhdGU7CmZydXN0dW1Nb2Qub25EZXN0cm95ID0gdGFncy5fX29uRGVzdHJveTsKZnJ1c3R1bU1vZC5mcnVzdHVtVXBkYXRlID0gdGFncy5fX2ZydXN0dW1VcGRhdGU7CmZydXN0dW1Nb2Qub25Qb3J0YWxDaGFuZ2VkID0gdGFncy5fX29uUG9ydGFsQ2hhbmdlZDsKCmNvbnN0IGZydXN0dW1Cb3QgPSBjcmVhdGUoZnJ1c3R1bU1vZCk7CgovLyBTdG9yZSBpZCBvZiBmcnVzdHVtIGJvdCBsb2NhbGx5LCBzbyB0aGF0IHdlIG1heSBkZXN0cm95IGl0IGxhdGVyIGlmIG5lZWRlZC4KbWFza3MuZnJ1c3R1bUJvdElkID0gZnJ1c3R1bUJvdC5pZDsKCi8vIE1ha2UgaW52aXNpYmxlIHRvIGxvY2FsIHVzZXIuCmZydXN0dW1Cb3QubWFza3MuZm9ybSA9ICdub25lJzsKZnJ1c3R1bUJvdC5tYXNrcy5jb2xvciA9ICdjbGVhcic7JwCI1IHqA730ARJtYWluU2NlbmVEaW1lbnNpb24CBACI1IHqA9aTAgltYWluU2NlbmUnAIjUgeoDvfQBBnN5c3RlbQIEAIjUgeoD4JMCHGFiLTEuaW1tZXJzaXZlLnJlbW90ZUZydXN0dW0nAIjUgeoDvfQBBHJjeHICBACI1IHqA/2TAgR0cnVlJwCI1IHqA730AQRmb3JtAgQAiNSB6gOClAIHbm90aGluZygAiNSB6gO99AENYWIxQm90VmVyc2lvbgF9BicAiNSB6gO99AEMYWIxSW1tZXJzaXZlAgQAiNSB6gOLlAIEdHJ1ZScAiNSB6gO99AEJYWIxSWdub3JlAgQAiNSB6gOQlAIEdHJ1ZSgAiNSB6gO99AEHZnJ1c3R1bQF+JwCI1IHqA730ARBpbW1lcnNpdmVNYW5hZ2VyAgQAiNSB6gOWlAIo8J+Ul2M0ODkxOThhLWY4OTktNGJlNi1iMWEwLWY0MjdkZjJmZjMzZAA="}]}