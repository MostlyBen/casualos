{"version":2,"updates":[{"id":0,"timestamp":1680190315889,"update":"AYYB9eC86wcAJwEEYm90cyQxNzQxMGQ4My03ZWVlLTRhMWUtYjYzOC02NTQ2Mzc0ZDE3YzMBJwD14LzrBwAGc3lzdGVtAgQA9eC86wcBE2FiLTEuaW50ZXJmYWNlLnNjYW4nAPXgvOsHAARmb3JtAgQA9eC86wcVB25vdGhpbmcnAPXgvOsHAAxhYjFJbnRlcmZhY2UCBAD14LzrBx0EdHJ1ZScA9eC86wcACWFiMUlnbm9yZQIEAPXgvOsHIgR0cnVlKAD14LzrBwANYWIxQm90VmVyc2lvbgF9BicA9eC86wcAD29uUVJDb2RlU2Nhbm5lZAIEAPXgvOsHKJMNQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfQoKYWIxLmxvZygiYWItMSBzY2FuIiArIHRoYXQpOwoKaWYgKGNvbmZpZ0JvdC50YWdzLnV1YWJTY2FuKQp7CiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICBsaW5rcy5zdG9yZS5hYjFQdWJsaXNoVVVBQih0aGF0KTsKfQplbHNlIGlmIChjb25maWdCb3QudGFncy5wdWJsaXNoU2NhbikKewogICAgb3MuY2xvc2VRUkNvZGVTY2FubmVyKCk7CgogICAgbGlua3Muc3RvcmUuYWIxUVJQdWJsaXNoKHRoYXQpOwp9CmVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbikKewogICAgbGV0IHNjYW5uZWRVUkw7CgogICAgY29uZmlnQm90LnRhZ3MucHJhY3RpY2VQZXJtaXRTY2FuID0gbnVsbDsKCiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICB0cnkKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKQogICAgewogICAgICAgIG9zLnRvYXN0KCJub3QgYSByZWNvZ25pemVkIHByYWN0aWNlIHBlcm1pdCIpOwoKICAgICAgICBjb25zb2xlLmxvZyhlKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBwaENoZWNrID0gc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuaGFzKCJwaCIpOwogICAgbGV0IGluc3RDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiaW5zdCIpOwogICAgbGV0IGFiQ2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImFiIik7CiAgICBsZXQgY3dDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiY3ciKTsKCiAgICBpZiAocGhDaGVjayAmJiBpbnN0Q2hlY2sgJiYgYWJDaGVjayAmJiBjd0NoZWNrKQogICAgewogICAgICAgIG9zLmdvVG9VUkwodGhhdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgb3MudG9hc3QoIm5vdCBhIHJlY29nbml6ZWQgcHJhY3RpY2UgcGVybWl0Iik7CiAgICB9CgogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7Cn0KZWxzZSBpZiAoY29uZmlnQm90LnRhZ3MuYWIxU2NhbikKewogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgogICAgY29uZmlnQm90LnRhZ3MuYWIxU2NhbiA9IG51bGw7CiAgICAKICAgIG9zLmNsb3NlUVJDb2RlU2Nhbm5lcigpOwoKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIHRyeSAKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKSAKICAgIHsKICAgICAgICBsaW5rcy5zZWFyY2guYWIxTFRNU2VhcmNoKHthYklEOiB0aGF0fSk7CgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZihzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5nZXQoImFiIikgPT0gImVnZ0NhcnRvbiIpCiAgICB7CiAgICAgICAgb3MuZ29Ub1VSTCh0aGF0KTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7CiAgICAgICAgICAgIGxldCBuZXdUYWcgPSBrZXk7CiAgICAgICAgICAgIGxldCBuZXdWYWx1ZSA9IHZhbHVlOwoKICAgICAgICAgICAgY29uZmlnQm90LnRhZ3NbbmV3VGFnXSA9IG5ld1ZhbHVlOwogICAgICAgIH0pOwoKICAgICAgICBsaW5rcy5zZWFyY2guYWIxTFRNU2VhcmNoKHthYklEOiBjb25maWdCb3QudGFncy5hYn0pOwogICAgfQp9JwD14LzrBwAFc3RvcmUCBAD14LzrB7wNKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPXgvOsHAAZzZWFyY2gCBAD14LzrB+MNKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPXgvOsHABFhYjFDb3JlTWVudUFjdGlvbgIEAPXgvOsHig44QG9zLm9wZW5RUkNvZGVTY2FubmVyKCk7Cgpjb25maWdCb3QudGFncy5hYjFTY2FuID0gdHJ1ZTsnAPXgvOsHABBhYjFDb3JlTWVudUxhYmVsAgQA9eC86wfDDgRzY2FuJwD14LzrBwAPYWIxQ29yZU1lbnVJY29uAgQA9eC86wfIDg9xcl9jb2RlX3NjYW5uZXInAPXgvOsHABRhYjFDb3JlTWVudVNvcnRPcmRlcgIEAPXgvOsH2A4BMycBBGJvdHMkNGFhZjY5OWUtYWJiZi00NGE4LTg1ZTEtNjhjYmI1ZGYwZTFmAScA9eC86wfaDgZzeXN0ZW0CBAD14LzrB9sOFWFiLTEuaW50ZXJmYWNlLm51Z2dldCcA9eC86wfaDgRmb3JtAgQA9eC86wfxDgdub3RoaW5nJwD14LzrB9oODGFiMUludGVyZmFjZQIEAPXgvOsH+Q4EdHJ1ZScA9eC86wfaDglhYjFJZ25vcmUCBAD14LzrB/4OBHRydWUoAPXgvOsH2g4NYWIxQm90VmVyc2lvbgF9BycA9eC86wfaDg1hYjFMb2FkTnVnZ2V0AgQA9eC86weED5kCQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXROYW1lOwpsZXQgZm9ybWF0dGVkTnVnZ2V0QUIgPSAibnVnXyIrbnVnZ2V0TmFtZTsKbGV0IGxvYWRlZE51Z2dldCA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCMUVnZ3Moe2FiSUQ6IGZvcm1hdHRlZE51Z2dldEFCLCBhYlZlcnNpb246IHRoYXQudmVyc2lvbiwgcmV0dXJuVHlwZTogImRhdGEifSk7Cgpsb2FkZWROdWdnZXQgPSBsb2FkZWROdWdnZXQuc3RhdGVbbnVnZ2V0TmFtZV0ubnVnZ2V0OwoKcmV0dXJuIGxvYWRlZE51Z2dldDsnAPXgvOsH2g4QYWIxUHVibGlzaE51Z2dldAIEAPXgvOsHnhHvAkAvL3Nob3V0KCJhYjFQdWJsaXNoTnVnZ2V0Iiwge251ZzogIm51Z05hbWUiLCBkYXRhOiBkYXRhfSk7ICBBREQgRUdHIElEIEVWRU5UVUFMTFkKbGV0IHRlc3ROdWdnZXQgPSB0aGF0LmRhdGE7CmxldCBmb3JtYXR0ZWROdWdnZXQgPSB7aWQ6IHRoYXQubnVnLCBudWdnZXQ6IHRlc3ROdWdnZXR9OwpsZXQgdGVzdE51Z2dldE5hbWUgPSB0aGF0Lm51ZzsKbGV0IGZvcm1hdHRlZE51Z2dldEFCID0gIm51Z18iK3Rlc3ROdWdnZXROYW1lOwoKbWFza3MubnVnZ2V0VG9QdWJsaXNoID0gZm9ybWF0dGVkTnVnZ2V0QUI7CgpsaW5rcy5zdG9yZS5hYjFQdWJsaXNoQUIoe2FiOiBmb3JtYXR0ZWROdWdnZXRBQiwgdGFyZ2V0OiBmb3JtYXR0ZWROdWdnZXR9KTsnAPXgvOsH2g4PaW1wbGVtZW50TnVnZ2V0AgQA9eC86weOFLIHQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXQ7CmxldCBudWdnZXRWZXJzaW9uQ2hlY2sgPSBudWdnZXROYW1lLmluZGV4T2YoIi52Iik7CmxldCB2ZXJzaW9uOwoKaWYgKG51Z2dldFZlcnNpb25DaGVjayAhPSAtMSkKewogICAgbnVnZ2V0TmFtZSA9IG51Z2dldE5hbWUuc3Vic3RyaW5nKDAsIG51Z2dldFZlcnNpb25DaGVjayk7CgogICAgbGV0IHZlcnNpb25DaGVjayA9IHRoYXQubnVnZ2V0LnN1YnN0cmluZyhudWdnZXRWZXJzaW9uQ2hlY2sgKyAyKTsKCiAgICBpZiAoaXNOYU4odmVyc2lvbkNoZWNrKSkKICAgIHsKICAgICAgICBjb25zb2xlLmxvZyh2ZXJzaW9uQ2hlY2ssICJ2ZXJzaW9uIGlzIG5vdCBhIG51bWJlciIpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHZlcnNpb24gPSBOdW1iZXIodmVyc2lvbkNoZWNrKTsKICAgIH0KfQpjb25zb2xlLmxvZyhudWdnZXROYW1lLCB2ZXJzaW9uKTsKbGV0IG51Z0RhdGEgPSBhd2FpdCB0aGlzQm90LmFiMUxvYWROdWdnZXQoe251Z2dldE5hbWU6IG51Z2dldE5hbWUsIHZlcnNpb246IHZlcnNpb259KTsKCmlmIChudWdEYXRhID09ICJhYklEIG5vdCBmb3VuZCIpCnsKICAgIG9zLnRvYXN0KCJudWdnZXQgbm90IGZvdW5kIik7Cn0KZWxzZQp7CiAgICBsZXQgdGFyZ2V0Qm90ID0gZ2V0Qm90KCJpZCIsIHRoYXQuYm90KTsKICAgIGxldCB0YXJnZXRUYWcgPSB0YXJnZXRCb3QucmF3W3RoYXQudGFnXS50b1N0cmluZygpOwogICAgbGV0IHRhcmdldE51ZyA9ICJ7IiArIHRoYXQubnVnZ2V0ICsgIn0iOyAKICAgIGxldCBudWdQb3MgPSB0YXJnZXRUYWcuaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKICAgIGluc2VydFRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCBudWdEYXRhKTsKfScA9eC86wfaDgxudWdnZXRCdXR0b24CBAD14LzrB8Eb9QxAbGV0IHRhZ1ZhbHVlID0gdGhhdC50YWdWYWx1ZTsKbGV0IHJlZ2V4ID0gL1xuL2dpOwpsZXQgYnJlYWtDaGVjazsKbGV0IGJyZWFrQXJyYXkgPSBbMF07Ci8vbGV0IGNyZWF0ZWRCdXR0b25zID0gW107Cgp3aGlsZSAoYnJlYWtDaGVjayA9IHJlZ2V4LmV4ZWModGFnVmFsdWUpKQp7CiAgICBicmVha0FycmF5LnB1c2goYnJlYWtDaGVjay5pbmRleCk7Cn0KCmxldCBuZXdOdWdnZXRCdXR0b24gPSB7fTsKCm5ld051Z2dldEJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpuZXdOdWdnZXRCdXR0b24uZm9ybSA9ICJjb2RlQnV0dG9uIjsKbmV3TnVnZ2V0QnV0dG9uLnRhcmdldEJvdCA9IHRoYXQuYm90LmlkOwpuZXdOdWdnZXRCdXR0b24udGFyZ2V0VGFnID0gdGhhdC50YWc7Cm5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJsb2FkIG51Z2dldCI7Cm5ld051Z2dldEJ1dHRvbi5udWdnZXRSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbmV3TnVnZ2V0QnV0dG9uW3RoYXQuYm90LmlkICsgIi4iICsgdGhhdC50YWddID0gdHJ1ZTsKbmV3TnVnZ2V0QnV0dG9uLm51Z2dldE1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwpuZXdOdWdnZXRCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm51Z2dldE1hbmFnZXIuaW1wbGVtZW50TnVnZ2V0KHtib3Q6IHRhZ3MudGFyZ2V0Qm90LCBudWdnZXQ6IHRhZ3MudGFyZ2V0TnVnZ2V0LCB0YWc6IHRhZ3MudGFyZ2V0VGFnfSk7CgpkZXN0cm95KHRoaXNCb3QpO2A7Cgpmb3IgKGxldCBudWdzID0gMDsgbnVncyA8IHRoYXQubnVnZ2V0Lmxlbmd0aDsgbnVncysrKQp7CiAgICBsZXQgY3VycmVudE51Z2dldCA9IHRoYXQubnVnZ2V0W251Z3NdOwogICAgLy9sZXQgYnV0dG9uQ2hlY2sgPSBjcmVhdGVkQnV0dG9ucy5pbmRleE9mKGN1cnJlbnROdWdnZXQubnVnTmFtZSk7CgogICAgaWYgKCFjdXJyZW50TnVnZ2V0IHx8IGN1cnJlbnROdWdnZXQgPT0gdW5kZWZpbmVkKSAvL3x8IGJ1dHRvbkNoZWNrICE9IC0xCiAgICB7CiAgICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKGN1cnJlbnROdWdnZXQubnVnUHVibGlzaCkKICAgIHsKICAgICAgICBuZXdOdWdnZXRCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm51Z2dldE1hbmFnZXIucGFja2FnZU51Z2dldCh7Ym90OiB0YWdzLnRhcmdldEJvdCwgbnVnZ2V0OiB0YWdzLnRhcmdldE51Z2dldCwgdGFnOiB0YWdzLnRhcmdldFRhZ30pOwoKICAgICAgICBkZXN0cm95KHRoaXNCb3QpO2A7CgogICAgICAgIG5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJwdWJsaXNoICIgKyBjdXJyZW50TnVnZ2V0Lm51Z05hbWUgKyAiIG51Z2dldCI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbmV3TnVnZ2V0QnV0dG9uLmxhYmVsID0gImxvYWQgIiArIGN1cnJlbnROdWdnZXQubnVnTmFtZSArICIgbnVnZ2V0IjsKICAgIH0KCiAgICBuZXdOdWdnZXRCdXR0b24udGFyZ2V0TnVnZ2V0ID0gY3VycmVudE51Z2dldC5udWdOYW1lOwogICAgbmV3TnVnZ2V0QnV0dG9uW3RoYXQuYm90LmlkICsgIi4iICsgdGhhdC50YWcgKyAiU3RhcnQiXSA9IGN1cnJlbnROdWdnZXQubnVnU3RhcnQ7CgogICAgY3JlYXRlKG5ld051Z2dldEJ1dHRvbik7CgogICAgLy9jcmVhdGVkQnV0dG9ucy5wdXNoKGN1cnJlbnROdWdnZXQubnVnTmFtZSk7Cn0KCnJldHVybjsnAPXgvOsH2g4LbnVnZ2V0UGFyc2UCBAD14LzrB7Uopw9AY29uc3Qgb3JpZ2luYWxUYWdWYWx1ZSA9IHRoYXQuZWRpdGVkQm90LnJhd1t0aGF0LmVkaXRlZFRhZ107CmxldCB0YWdWYWx1ZSA9IG9yaWdpbmFsVGFnVmFsdWU7CgppZiAoIXRhZ1ZhbHVlKSAKewogICAgcmV0dXJuOwp9CmVsc2UgaWYgKHR5cGVvZiB0YWdWYWx1ZSAhPT0gInN0cmluZyIpIAp7CiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnRvU3RyaW5nKCk7Cn0KCmxldCBpbml0aWFsUG9zc2libGVOdWdQb3MgPSAwOwoKaWYgKGluaXRpYWxQb3NzaWJsZU51Z1BvcyA9PSAtMSkgCnsKICAgIHJldHVybjsKfQplbHNlCnsKICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxQb3NzaWJsZU51Z1Bvcyk7Cn0KCmxldCBwb3NzaWJsZU51Z3MgPSBvcmlnaW5hbFRhZ1ZhbHVlLnJlcGxhY2UoL1tee10vZywgIiIpLmxlbmd0aDsKbGV0IHRvdGFsTnVnQnJlYWtzID0gb3JpZ2luYWxUYWdWYWx1ZS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwpsZXQgYnJlYWtMZXZlbCA9IDA7CmxldCBudWdzVG9DaGVjayA9IFtdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU51Z3M7IGkrKykKewogICAgbGV0IGluaXRpYWxOdWdQb3MgPSB0YWdWYWx1ZS5pbmRleE9mKCJ7IikgKyAxOwogICAgbGV0IHBvc3NpYmxlTnVnRW5kID0gdGFnVmFsdWUuaW5kZXhPZigifSIpOwogICAgbGV0IHBvc3NpYmxlTnVnID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MsIHBvc3NpYmxlTnVnRW5kKTsKCiAgICBpZiAocG9zc2libGVOdWcuaW5kZXhPZigiICIpID09IC0xICYmIC9cbi9nLnRlc3QocG9zc2libGVOdWcpICE9IHRydWUgJiYgcG9zc2libGVOdWcubGVuZ3RoID4gMCAmJiBwb3NzaWJsZU51Zy5pbmRleE9mKCI6IikgPT0gLTEpCiAgICB7CiAgICAgICAgbGV0IG51Z0JyZWFrcyA9IHRhZ1ZhbHVlLnN1YnN0cmluZygwLCB0YWdWYWx1ZS5pbmRleE9mKCJ7Iitwb3NzaWJsZU51ZysifSIpKS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwogICAgICAgIGxldCBwdWJsaXNoQ2hlY2sgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbE51Z1BvcyAtIDYsIGluaXRpYWxOdWdQb3MgLSAyKTsKICAgICAgICBsZXQgbnVnUHVibGlzaCA9IG51bGw7CgogICAgICAgIGlmIChwdWJsaXNoQ2hlY2sgPT0gIi5udWciKQogICAgICAgIHsKICAgICAgICAgICAgbnVnUHVibGlzaCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBicmVha0xldmVsICs9IG51Z0JyZWFrczsKCiAgICAgICAgbnVnQnJlYWtzID0gdG90YWxOdWdCcmVha3MgLSAodG90YWxOdWdCcmVha3MgLSBicmVha0xldmVsKTsKICAgICAgICAKICAgICAgICAvL0NIRUNLIElGICQgYmVmb3JlIG51Z2dldAogICAgICAgIGlmICh0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbE51Z1BvcyAtIDIsIGluaXRpYWxOdWdQb3MgLSAxKSAhPSAiJCIpCiAgICAgICAgewogICAgICAgICAgICBudWdzVG9DaGVjay5wdXNoKHtudWdOYW1lOiBwb3NzaWJsZU51ZywgbnVnU3RhcnQ6IG51Z0JyZWFrcyArIDEsIG51Z1B1Ymxpc2g6IG51Z1B1Ymxpc2h9KTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGV0IG51Z0JyZWFrcyA9IHRhZ1ZhbHVlLnN1YnN0cmluZygwLCB0YWdWYWx1ZS5pbmRleE9mKCJ9IikpLnJlcGxhY2UoL1teXG5dL2csICIiKS5sZW5ndGg7CgogICAgICAgIGJyZWFrTGV2ZWwgKz0gbnVnQnJlYWtzOwoKICAgICAgICBudWdCcmVha3MgPSB0b3RhbE51Z0JyZWFrcyAtICh0b3RhbE51Z0JyZWFrcyAtIGJyZWFrTGV2ZWwpOwogICAgfQoKICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUuc3Vic3RyaW5nKHBvc3NpYmxlTnVnRW5kICsgMSk7Cn0KCnRoaXNCb3QubnVnZ2V0QnV0dG9uKHsgbnVnZ2V0OiBudWdzVG9DaGVjaywgYm90OiB0aGF0LmVkaXRlZEJvdCwgdGFnOiB0aGF0LmVkaXRlZFRhZywgdGFnVmFsdWU6IG9yaWdpbmFsVGFnVmFsdWV9KTsnAPXgvOsH2g4Nb25BQlB1Ymxpc2hlZAIEAPXgvOsH3TfBAUBjb25zb2xlLmxvZyh0aGF0LmFiLCB0YWdzLm51Z2dldFRvUHVibGlzaCkKCmlmICh0aGF0LmFiID09IHRhZ3MubnVnZ2V0VG9QdWJsaXNoKQp7CiAgICBvcy50b2FzdCgibnVnZ2V0IHB1Ymxpc2hlZCIpOwoKICAgIG1hc2tzLm51Z2dldFRvUHVibGlzaCA9IG51bGw7CgogICAgY29uZmlnQm90Lm1hc2tzLmFiVmVyc2lvbiA9IG51bGw7Cn0nAPXgvOsH2g4Qb25BbnlCb3RzQ2hhbmdlZAIEAPXgvOsHnzm3BEBpZiAoY29uZmlnQm90ICYmIHRoYXRbMF0uYm90LmlkICE9IHRoaXNCb3QuaWQpIAp7CiAgICBpZiAoIWNvbmZpZ0JvdC50YWdzLmVkaXRpbmdCb3QpIHJldHVybjsgLy8gSWdub3JlIGlmIHRoZSBjb25maWdCb3QgaXNuJ3QgcmVhZHkgeWV0LgoKICAgIGNvbnN0IGVkaXRlZEJvdElEID0gY29uZmlnQm90LnRhZ3MuZWRpdGluZ0JvdC5yZXBsYWNlKCLwn5SXIiwgIiIpOwoKICAgIGlmICghdGhhdC5maW5kKHggPT4geC5ib3QuaWQgPT0gZWRpdGVkQm90SUQpKSByZXR1cm47IC8vIElmIHRoZSBib3QgY2hhbmdlZCB3YXNuJ3QgYmVpbmcgZWRpdGVkIGJ5IHRoZSB1c2VyIGlnbm9yZSBpdC4KCiAgICBjb25zdCBlZGl0ZWRUYWcgPSBjb25maWdCb3QudGFncy5lZGl0aW5nVGFnOwogICAgY29uc3QgZWRpdGVkQm90ID0gZ2V0Qm90KCJpZCIsIGVkaXRlZEJvdElEKTsKCiAgICBpZiAoZWRpdGVkQm90ICYmIGVkaXRlZFRhZykgCiAgICB7CiAgICAgICAgc2hvdXQoIm51Z2dldFJlc2V0Iik7CgogICAgICAgIHRoaXNCb3QubnVnZ2V0UGFyc2UoeyBlZGl0ZWRCb3QsIGVkaXRlZFRhZyB9KTsKICAgIH0KfScA9eC86wfaDghvbkNyZWF0ZQIEAPXgvOsH1T1MQHRhZ3MubGlzdGVuaW5nID0gZmFsc2U7CgovL3NldFRhZ01hc2sodGhpc0JvdCwgImxpc3RlbmluZyIsIHRydWUsICJsb2NhbCIpOycA9eC86wfaDg1wYWNrYWdlTnVnZ2V0AgQA9eC86weiPvkGQGNvbnN0IHRhcmdldEJvdCA9IGdldEJvdCgiaWQiLCB0aGF0LmJvdCk7CmNvbnN0IHRhZ1RleHQgPSB0YXJnZXRCb3QucmF3W3RoYXQudGFnXTsKCmlmIChjb25maWdCb3QudGFncy5jdXJzb3JTdGFydEluZGV4IHx8IGNvbmZpZ0JvdC50YWdzLmN1cnNvckVuZEluZGV4KQp7CiAgICBsZXQgc3RhcnRQb3MgPSBjb25maWdCb3QudGFncy5jdXJzb3JTdGFydEluZGV4OwogICAgbGV0IGVuZFBvcyA9IGNvbmZpZ0JvdC50YWdzLmN1cnNvckVuZEluZGV4OwoKICAgIGlmIChzdGFydFBvcyA9PSBlbmRQb3MpCiAgICB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgZWxzZSBpZiAoc3RhcnRQb3MgPiBlbmRQb3MpCiAgICB7CiAgICAgICAgbGV0IG5ld1N0YXJ0UG9zID0gZW5kUG9zOwogICAgICAgIGxldCBuZXdFbmRQb3MgPSBzdGFydFBvczsKCiAgICAgICAgc3RhcnRQb3MgPSBuZXdTdGFydFBvczsKICAgICAgICBlbmRQb3MgPSBuZXdFbmRQb3M7CiAgICB9CgogICAgbGV0IGRhdGEgPSB0YWdUZXh0LnN1YnN0cmluZyhzdGFydFBvcywgZW5kUG9zICsgMSk7CgogICAgc2hvdXQoImFiMVB1Ymxpc2hOdWdnZXQiLCB7bnVnOiB0aGF0Lm51Z2dldCwgZGF0YTogZGF0YX0pOwoKICAgIG9zLnRvYXN0KCJudWcgaXMgcHVibGlzaGluZyIsIDEwKTsKCiAgICBsZXQgdGFyZ2V0TnVnID0gIi5udWcgeyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10uaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJjYW5ub3QgcmVhZCBudWdnZXQgdG8gYmUgcHVibGlzaGVkIikKfScA9eC86wfaDghyZW1lbWJlcgIEAPXgvOsHnEUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA9eC86wfaDgZzZWFyY2gCBAD14LzrB8NFKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPXgvOsH2g4Fc3RvcmUCBAD14LzrB+pFKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPXgvOsH2g4JbGlzdGVuaW5nAgQA9eC86weRRgVmYWxzZScBBGJvdHMkYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiAScA9eC86weXRgZzeXN0ZW0CBAD14LzrB5hGE2FiLTEuaW50ZXJmYWNlLm1lbnUnAPXgvOsHl0YEZm9ybQIEAPXgvOsHrEYHbm90aGluZycA9eC86weXRgtkZXNjcmlwdGlvbgIEAPXgvOsHtEYmVGhpcyBza2lsbCBpcyBkZXNpZ25lZCBmb3IgbWVudSBzdHVmZi4oAPXgvOsHl0YMYWIxSW50ZXJmYWNlAXgnAPXgvOsHl0YLYWIxT3Blbk1lbnUCBAD14LzrB9xG6glAY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWIxTWVudSI7CgpsZXQgbWVudVR5cGUgPSB0aGF0ID8gImFiMSIgKyB0aGF0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhhdC5zbGljZSgxKSArICJNZW51IjogImFiMUNvcmVNZW51IjsgLy9zZXQgdXAgYSBjaGVjayB0byBzZWUgd2hhdCB0eXBlIG9mIG1lbnUgc2hvdWxkIGJlIG9jY3VyaW5nIFtjb3JlLCBib3QsIGdyaWQsIGluc3RdCmxldCBtZW51U2tpbGxzID0gZ2V0Qm90cyhtZW51VHlwZSArICJBY3Rpb24iKTsKbGV0IG1heE9wdGlvbnMgPSBtZW51VHlwZSA9PSAiaW5zdCIgPyA3IDogNTsKbGV0IGFiMU1lbnVCdXR0b24gPSB7fTsKCmFiMU1lbnVCdXR0b24uYWIxTWVudSA9IHRydWU7CmFiMU1lbnVCdXR0b24uYWIxTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLmJhc2VTa2lsbC4ke21lbnVUeXBlICsgIkFjdGlvbiJ9KCk7YDsKCmZvciAobGV0IGkgPSAwOyBpIDwgbWVudVNraWxscy5sZW5ndGg7IGkrKykvL0FERCBMT0dJQyBGT1IgTU9SRSBPUFRJT05TIFRIQU4gNSA6IG1heE9wdGlvbnMKewogICAgbGV0IGN1cnJlbnRTa2lsbCA9IG1lbnVTa2lsbHNbaV07CgogICAgYWIxTWVudUJ1dHRvbi5iYXNlU2tpbGwgPSAi8J+UlyIgKyBjdXJyZW50U2tpbGwuaWQ7CiAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiTGFiZWwiXTsKICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJJY29uIl07CiAgICBhYjFNZW51QnV0dG9uLm9uQ3JlYXRlID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiT25HZW5lcmF0ZSJdOwogICAgYWIxTWVudUJ1dHRvbi5hYjFNZW51U29ydE9yZGVyID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiU29ydE9yZGVyIl07CiAgICBhYjFNZW51QnV0dG9uLmNvbG9yID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiQ29sb3IiXSA/IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkNvbG9yIl0gOiBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKCiAgICB0aGlzQm90LmFiMUNyZWF0ZU1lbnVCdXR0b24oYWIxTWVudUJ1dHRvbik7Cn0KCnRoaXNCb3QubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYjFDbGljaygpOyI7JwD14LzrB5dGE2FiMUNyZWF0ZU1lbnVCdXR0b24CBAD14LzrB8VQlgNAbGV0IGFkZGl0aW9uYWxUYWdzID0gdGhhdDsKbGV0IG5ld01lbnVCdXR0b24gPSB7fTsKCm5ld01lbnVCdXR0b24uc3BhY2UgPSAidGVtcExvY2FsIjsKbmV3TWVudUJ1dHRvbi5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwpuZXdNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImxlZnQiOwpuZXdNZW51QnV0dG9uLm1lbnVJdGVtU3R5bGUgPSB7ICJib3JkZXItcmFkaXVzIjoiOHB4IiwgIm1hcmdpbi10b3AiOiIzcHgifTsKCmZvciAoY29uc3QgdGFnIGluIGFkZGl0aW9uYWxUYWdzKQp7CiAgICBuZXdNZW51QnV0dG9uW3RhZ10gPSBhZGRpdGlvbmFsVGFnc1t0YWddOwp9CgpuZXdNZW51QnV0dG9uID0gY3JlYXRlKG5ld01lbnVCdXR0b24pOwoKcmV0dXJuIG5ld01lbnVCdXR0b247JwD14LzrB5dGDmFiMU1lbnVSZWZyZXNoAgQA9eC86wfcUz5AY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBudWxsOycA9eC86weXRghyZW1lbWJlcgIEAPXgvOsHm1Qo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA9eC86weXRg1tYW5pZmVzdGF0aW9uAgQA9eC86wfCVCjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwD14LzrB5dGEmFiMUVudmlyb25tZW50TWVudQIEAPXgvOsH6VSFJ0BzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiMU1lbnUiOwoKbGV0IGFiMU1lbnVCdXR0b24gPSB7fTsKCmFiMU1lbnVCdXR0b24uYWIxTWVudSA9IHRydWU7CmFiMU1lbnVCdXR0b24uYWIxTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiMU1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKYWIxTWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CmFiMU1lbnVCdXR0b24ubGVhcm4gPSB0YWdzLmxlYXJuOwoKZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKQp7CiAgICBzd2l0Y2ggKGkpCiAgICB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImhpZGUiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gInZpc2liaWxpdHlfb2ZmIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7CiAgICAgICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWIxQm90ID0gbnVsbDsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJjb2xvciI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAicGFsZXR0ZSI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIG9zLnNob3dJbnB1dEZvclRhZyhsaW5rcy5yZW1lbWJlciwgImFiMUJhc2VDb2xvciIsIHsKICAgICAgICAgICAgdHlwZTogJ2NvbG9yJywKICAgICAgICAgICAgdGl0bGU6ICdwaWNrIGEgY29sb3InCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7CiAgICAgICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWIxQm90ID0gbnVsbDsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJzbGVlcCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAibmlnaHRzX3N0YXkiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYjFCb3QpOwoKICAgICAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5tYXNrcy5hYjFCb3QgPSBudWxsOwogICAgICAgICAgICBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgPSBmYWxzZTsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJjaGF0IjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjaGF0IjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgb3Muc2hvd0NoYXQoKTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gIm51Z2dldHMiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm51Z01hbmFnZXIgPSB0YWdzLm51Z2dldDsKCiAgICAgICAgICAgIGlmIChsaW5rcy5udWdnZXQudGFncy5saXN0ZW5pbmcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9ICJAIHNob3V0KCdhYjFNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7IHNldFRhZ01hc2sobGlua3MubnVnTWFuYWdlciwgJ2xpc3RlbmluZycsIG51bGwpOyI7CiAgICAgICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNoZWNrX2JveCI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYjFDbGljaygpOyBzZXRUYWdNYXNrKGxpbmtzLm51Z01hbmFnZXIsICdsaXN0ZW5pbmcnLCB0cnVlLCAnbG9jYWwnKTsiOwogICAgICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjaGVja19ib3hfb3V0bGluZV9ibGFuayI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNToKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJzeXN0ZW1Qb3J0YWw9dHJ1ZSI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAic2V0dGluZ3NfYXBwbGljYXRpb25zIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgY29uZmlnQm90LnRhZ3Muc3lzdGVtUG9ydGFsID0gdHJ1ZTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBpZiAoIWxpbmtzLmdwdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ubGFiZWwgPSAiZWRpdCBhYi0xIHByb21wdCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZWRpdF9ub3RlIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5ncHRCb3QgPSB0YWdzLmdwdDsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImdyaWQgc25hcCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRTbmFwU3RhdGUgPyAiY2hlY2tfYm94IiA6ICJjaGVja19ib3hfb3V0bGluZV9ibGFuayI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxR3JpZFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRTbmFwU3RhdGU7CiAgICAgICAgICAgIAogICAgICAgICAgICB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYjFHcmlkU25hcFN0YXRlID8gImNoZWNrX2JveCIgOiAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiOwogICAgICAgICAgICBgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImJvdCBzbmFwIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQm90U25hcFN0YXRlID8gImNoZWNrX2JveCIgOiAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZSA/ICJjaGVja19ib3giIDogImNoZWNrX2JveF9vdXRsaW5lX2JsYW5rIjsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgOToKICAgICAgICAgICAgLy9VUERBVEUgTEFCRUwKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJkZWxldGUgYWItMSI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZGVsZXRlX2ZvcmV2ZXIiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmNvbG9yID0gIiNENjZENUUiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsZXQgYWxsQm90cyA9IGdldEJvdHMoInNwYWNlIiwgInNoYXJlZCIpOwoKICAgICAgICAgICAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbEJvdHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChhbGxCb3RzW2ldLnRhZ3Muc3lzdGVtKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmIChhbGxCb3RzW2ldLnRhZ3Muc3lzdGVtLmluY2x1ZGVzKCJhYi0xIikpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBkZXN0cm95KGFsbEJvdHNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBgOwoKICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgIAogICAgfQoKICAgIGFiMU1lbnVCdXR0b24uYWIxTWVudVNvcnRPcmRlciA9IGk7CgogICAgdGhpc0JvdC5hYjFDcmVhdGVNZW51QnV0dG9uKGFiMU1lbnVCdXR0b24pOwp9Cgp0aGlzQm90Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiMU1lbnVSZWZyZXNoJyk7IGxpbmtzLm1hbmlmZXN0YXRpb24uYWIxQ2xpY2soKTsiOwoKLy8gYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJjb2xsYWIgcG92IjsKLy8gLy9DSEVDSyBGT1IgSUNPTgovLyBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gInZpc2liaWxpdHlfb2ZmIjsKLy8gYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgb3MudG9hc3QoJ3dvcmsgaW4gcHJvZ3Jlc3MnKSI7CgovLyBhYjFNZW51QnV0dG9uLmxhYmVsID0gIm51Z2dldHMiOwovLyAvL0NIRUNLIEZPUiBJQ09OCi8vIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2hlY2tfYm94IjsKLy8gYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgb3MudG9hc3QoJ3dvcmsgaW4gcHJvZ3Jlc3MnKSI7JwD14LzrB5dGBWxlYXJuAgQA9eC86wfveyjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwD14LzrB5dGA2dwdAIEAPXgvOsHlnwo8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycA9eC86weXRglhYjFJZ25vcmUCBAD14LzrB718BHRydWUoAPXgvOsHl0YNYWIxQm90VmVyc2lvbgF9CycA9eC86weXRhJhYjFJbml0aWFsQm9vdE1lbnUCBAD14LzrB8N87wtAY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWIxSW5pdGlhbE1lbnUiOwoKbWFza3MuYWIxTWVudVJlZnJlc2ggPSAiQCBtYXNrcy5vbkdyaWRDbGljayA9IG51bGw7IjsKbWFza3Mub25HcmlkQ2xpY2sgPSAiQCBtYXNrcy5vbkdyaWRDbGljayA9IG51bGw7IGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsiOwoKbGV0IG1lbnVCdXR0b24gPSB7fTsKCm1lbnVCdXR0b24uYWIxSW5pdGlhbE1lbnUgPSB0cnVlOwptZW51QnV0dG9uLmdyaWRDbGljayA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbi5hYjFNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbgptZW51QnV0dG9uLmxlYXJuID0gdGFncy5sZWFybjsKbWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwptZW51QnV0dG9uLnNlYXJjaCA9IHRhZ3Muc2VhcmNoOwptZW51QnV0dG9uLmxhYmVsID0gImJ1aWxkIjsKbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjdWJlIjsKbWVudUJ1dHRvbi5jb2xvciA9ICIjOTA4QkZDIjsKbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7YDsKCnRoaXNCb3QuYWIxQ3JlYXRlTWVudUJ1dHRvbihtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24ubGFiZWwgPSAic2VhcmNoIjsKbWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKbWVudUJ1dHRvbi5jb2xvciA9ICIjOTA4QkZDIjsKbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJzZWFyY2giOwptZW51QnV0dG9uLm9uU3VibWl0ID0gYEAgbGV0IGFiSUQgPSB0aGF0LnRleHQ7CiAgICBzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCiAgICBsaW5rcy5zZWFyY2gub25Mb29rdXBBQjFFZ2dzKHthYklEOiBhYklEfSk7YDsKCnRoaXNCb3QuYWIxQ3JlYXRlTWVudUJ1dHRvbihtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAicXJfY29kZV9zY2FubmVyIjsKbWVudUJ1dHRvbi5mb3JtID0gbnVsbDsKbWVudUJ1dHRvbi5sYWJlbCA9ICJzY2FuIjsKbWVudUJ1dHRvbi5jb2xvciA9ICIjOTA4QkZDIjsKbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QudGFncy5wcmFjdGljZVBlcm1pdFNjYW4gPSB0cnVlOwoKb3Mub3BlblFSQ29kZVNjYW5uZXIoKTtgOwoKdGhpc0JvdC5hYjFDcmVhdGVNZW51QnV0dG9uKG1lbnVCdXR0b24pOwoKbWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKbWVudUJ1dHRvbi5sYWJlbCA9ICJlbnRlciBqb2luIGNvZGUiOwptZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImdyb3VwX2FkZCI7Cm1lbnVCdXR0b24uY29sb3IgPSAiIzkwOEJGQyI7Cm1lbnVCdXR0b24ub25TdWJtaXQgPSBgQCBzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmxpbmtzLmxlYXJuLmFiMUpvaW5Ib3N0KHRoYXQpO2A7Cgp0aGlzQm90LmFiMUNyZWF0ZU1lbnVCdXR0b24obWVudUJ1dHRvbik7JwD14LzrB5dGBnNlYXJjaAIEAPXgvOsHs4gBKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPXgvOsHl0YGbnVnZ2V0AgQA9eC86wfaiAEo8J+UlzRhYWY2OTllLWFiYmYtNDRhOC04NWUxLTY4Y2JiNWRmMGUxZicBBGJvdHMkZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkAScA9eC86weBiQEGc3lzdGVtAgQA9eC86weCiQEcYWItMS5pbnRlcmZhY2UubWFuaWZlc3RhdGlvbicA9eC86weBiQEEZm9ybQIEAPXgvOsHn4kBB25vdGhpbmcoAPXgvOsHgYkBDGFiMUludGVyZmFjZQF4JwD14LzrB4GJAQtkZXNjcmlwdGlvbgIEAPXgvOsHqIkBOlRoaXMgc2tpbGwgY29udHJvbHMgdGhlIGFjdHVhbCBib3QgZm9yIHRoZSBhYi0xIGludGVyZmFjZS4nAPXgvOsHgYkBCm9uQm90QWRkZWQCBAD14LzrB+OJAbcBQC8vTU9WRSBUTyBXSEVOIE1FTlUgSVMgT1BFTkVEIEZPUiBGSVJTVCBUSU1FPz8/ICBPUiBXSEVOIFNVTU1PTkVEPwpsaW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxQWN0aW9uIik7CgpsaW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxRmFjdG9yeSIpOwoKLy9saW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxRXhwZXJpbWVudGFsIik7JwD14LzrB4GJAQVsZWFybgIEAPXgvOsHm4sBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAPXgvOsHgYkBD29uUG9ydGFsQ2hhbmdlZAIEAPXgvOsHwosBxgVAaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgfHwgdGhhdC5wb3J0YWwgPT0gInRhZ1BvcnRhbCIpCnsKICAgIHJldHVybjsKfQoKbGV0IHBvcnRhbEFycmF5ID0gWyJtaW5pR3JpZFBvcnRhbCIsICJncmlkUG9ydGFsIiwgIm1hcFBvcnRhbCIsICJtaW5pTWFwUG9ydGFsIiwgImxlZnRXcmlzdFBvcnRhbCIsICJyaWdodFdyaXN0UG9ydGFsIl07CgppZiAocG9ydGFsQXJyYXkuaW5kZXhPZih0aGF0LnBvcnRhbCkgIT0gLTEgJiYgdGhhdC5kaW1lbnNpb24pCnsKICAgIHRoaXNCb3QuYWIxTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGhhdC5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OjAseTowfX0pOwp9CmVsc2UgaWYgKHBvcnRhbEFycmF5LmluZGV4T2YodGhhdC5wb3J0YWwpID09IC0xICYmICF0aGF0LmRpbWVuc2lvbiAmJiB0aGF0LnBvcnRhbCAhPSAibWVudVBvcnRhbCIpCnsKICAgIGxldCBzdW1tb25EaW1lbnNpb24gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwoKICAgIHRoaXNCb3QuYWIxTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogc3VtbW9uRGltZW5zaW9uLCBwb3NpdGlvbjp7eDowLHk6MH19KTsKfQplbHNlIGlmICh0aGF0LnBvcnRhbCAhPSAibWVudVBvcnRhbCIpCnsKICAgIGRlc3Ryb3kobGlua3MuYWIxQm90KTsKfScA9eC86weBiQEIcmVtZW1iZXICBAD14LzrB4mRASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD14LzrB4GJAQ5hYjFNYW5pZmVzdEJvdAIEAPXgvOsHsJEBmAlAaWYgKHRhZ3MuYWIxQm90KQp7CiAgICBkZXN0cm95KGxpbmtzLmFiMUJvdCk7Cn0KCmxldCBhYjEgPSB7fTsKCmFiMS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphYjEuY29sb3IgPSAiY2xlYXIiOwphYjEub25DbGljayA9ICJAIGxpbmtzLm1hbmFnZXIuYWIxQ2xpY2soKTsiOwphYjEuZGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CmFiMVt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwphYjFbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54OwphYjFbdGhhdC5kaW1lbnNpb24gKyAiWSJdID0gdGhhdC5wb3NpdGlvbi55OwphYjEuc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKYWIxLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwphYjEubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmFiMS5hbmltYXRlQm90ID0gYEAgY29uc3Qgcm90WiA9IHRhZ3MuZGltZW5zaW9uICsgIlJvdGF0aW9uWiI7CmxldCB0YXJnZXRTY2FsZSA9IDAuNjU7CgppZiAodGFncy5zY2FsZSA8PSAwLjY1MSkKewogICAgdGFyZ2V0U2NhbGUgPSAwLjk1Owp9Cgphd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsCnsKICAgIGZyb21WYWx1ZTogewogICAgICAgIFtyb3RaXTogMCwKICAgICAgICBzY2FsZTogdGFncy5zY2FsZQogICAgfSwKICAgIHRvVmFsdWU6IHsKICAgICAgICBbcm90Wl06IDMuMTUsLy82LjMsCiAgICAgICAgc2NhbGU6IHRhcmdldFNjYWxlCiAgICB9LAogICAgZWFzaW5nOiB7CiAgICAgICAgdHlwZTogInNpbnVzb2lkYWwiLAogICAgICAgIG1vZGU6ICJpbm91dCIKICAgIH0sCiAgICBkdXJhdGlvbjogMgp9KS5jYXRjaChlID0+IHt9KTsKYDsKYWIxLm9uQ3JlYXRlID0gYEAgdGhpc0JvdC5hbmltYXRlQm90KCk7CgptYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXNCb3QuYW5pbWF0ZUJvdCgpLCAyMDAwKTsKYDsKYWIxLm9uRGVzdHJveSA9IGBACmNsZWFySW50ZXJ2YWwodGFncy5pbnRlcnZhbCk7CgpzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKYDsKYWIxLmRyYWdnYWJsZSA9IGZhbHNlOwphYjEuc2NhbGUgPSAwLjk7CgpsZXQgYWIxTWFuaWZlc3RlZCA9IGF3YWl0IGNyZWF0ZShhYjEpOwoKbWFza3MuYWIxQm90ID0gIvCflJciICsgYWIxTWFuaWZlc3RlZC5pZDsnAPXgvOsHgYkBEGFiMU1hbmlmZXN0U3RhdGUCBAD14LzrB8WaAQVBd2FrZScA9eC86weBiQEdYWIxTWFuaWZlc3RTdGF0ZUFzbGVlcE9uRW50ZXICBAD14LzrB8uaAVlAZGVzdHJveShsaW5rcy5hYjFCb3QpOwoKbWFza3MuYWIxQm90ID0gbnVsbDsKCmxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQXdha2VTdGF0ZSA9IGZhbHNlOycA9eC86weBiQELb25HcmlkQ2xpY2sCBAD14LzrB6WbAYoIQGlmICghbGlua3MucmVtZW1iZXIudGFncy5hYjFBd2FrZVN0YXRlKQp7CiAgICByZXR1cm47Cn0KCnNob3V0KCJhYjFNZW51UmVmcmVzaCIpOwoKbGV0IGZvb3RwcmludCA9IHt9OwoKZm9vdHByaW50LnNwYWNlID0gInRlbXBMb2NhbCI7CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwpmb290cHJpbnQuZGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbiArICJYIl0gPSB0aGF0LnBvc2l0aW9uLng7CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbiArICJZIl0gPSB0aGF0LnBvc2l0aW9uLnk7CmZvb3RwcmludC5zY2FsZVogPSAwLjAxOwpmb290cHJpbnQub25DbGljayA9IGBAIHRhZ3NbdGFncy5kaW1lbnNpb25dID0gZmFsc2U7CgpsaW5rcy5tYW5hZ2VyLmFiMU1hbmlmZXN0Qm90KHRhZ3MucG9zaXRpb25JbmZvKTsKYDsKZm9vdHByaW50LnBvc2l0aW9uSW5mbyA9IHRoYXQ7CmZvb3RwcmludC5jb2xvciA9ICJjbGVhciI7CmZvb3RwcmludC5zdHJva2VDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwpmb290cHJpbnQuZHJhZ2dhYmxlID0gZmFsc2U7CmZvb3RwcmludC5tYW5hZ2VyID0gIvCflJciICsgdGhpc0JvdC5pZDsKZm9vdHByaW50Lm9uQ3JlYXRlID0gYEAgc2V0VGltZW91dCgoKSA9PiBkZXN0cm95KHRoaXNCb3QpLCA4MDApOwoKICAgIGF3YWl0IGFuaW1hdGVUYWcodGhpc0JvdCwgewogICAgICAgIGZyb21WYWx1ZTogewogICAgICAgICAgICBzY2FsZVg6IDAuMSwKICAgICAgICAgICAgc2NhbGVZOiAwLjEKICAgICAgICB9LAogICAgICAgIHRvVmFsdWU6IHsKICAgICAgICAgICAgc2NhbGVYOiAxLjEsCiAgICAgICAgICAgIHNjYWxlWTogMS4xCiAgICAgICAgfSwKICAgICAgICBkdXJhdGlvbjogMC41LAogICAgICAgIGVhc2luZzogewogICAgICAgICAgICB0eXBlOiAiZWxhc3RpYyIsCiAgICAgICAgICAgIG1vZGU6ICJvdXQiCiAgICAgICAgfQogICAgfSkuY2F0Y2goZSA9PiB7fSk7CmA7CgpjcmVhdGUoZm9vdHByaW50KTsnAPXgvOsHgYkBBG1lbnUCBAD14LzrB66jASjwn5SXYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiJwD14LzrB4GJAQhhYjFDbGljawIEAPXgvOsH1aMB9QhAY29uc3QgbWVudVR5cGUgPSB0aGF0ID8gdGhhdC5tZW51IDogImNvcmUiOwpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZiAobGlua3MuYWIxQm90LnRhZ3MuaW50ZXJ2YWwgfHwgc3RhdGUpCnsKICAgIGNsZWFySW50ZXJ2YWwobGlua3MuYWIxQm90LnRhZ3MuaW50ZXJ2YWwpOwoKICAgIGxpbmtzLmFiMUJvdC5tYXNrcy5pbnRlcnZhbCA9IG51bGw7CgogICAgY2xlYXJBbmltYXRpb25zKGxpbmtzLmFiMUJvdCk7CgogICAgY29uc3Qgcm90WiA9IGxpbmtzLmFiMUJvdC50YWdzLmRpbWVuc2lvbiArICJSb3RhdGlvbloiOwoKICAgIGlmIChzdGF0ZSAmJiBtZW51VHlwZSAhPSAibXVsdGlwbGVCb3QiKQogICAgewogICAgICAgIGxpbmtzLm1lbnUuYWIxRW52aXJvbm1lbnRNZW51KCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGlua3MubWVudS5hYjFPcGVuTWVudShtZW51VHlwZSk7CiAgICB9CgogICAgYXdhaXQgYW5pbWF0ZVRhZyhsaW5rcy5hYjFCb3QsCiAgICB7CiAgICAgICAgZnJvbVZhbHVlOiB7CiAgICAgICAgICAgIFtyb3RaXTogbGlua3MuYWIxQm90LnRhZ3Nbcm90Wl0sCiAgICAgICAgICAgIHNjYWxlOiBsaW5rcy5hYjFCb3QudGFncy5zY2FsZQogICAgICAgIH0sCiAgICAgICAgdG9WYWx1ZTogewogICAgICAgICAgICBbcm90Wl06IDAsCiAgICAgICAgICAgIHNjYWxlOiAwLjkKICAgICAgICB9LAogICAgICAgIGVhc2luZzogewogICAgICAgICAgICB0eXBlOiAic2ludXNvaWRhbCIsCiAgICAgICAgICAgIG1vZGU6ICJpbm91dCIKICAgICAgICB9LAogICAgICAgIGR1cmF0aW9uOiAwLjUKICAgIH0pLmNhdGNoKGUgPT4ge30pOwp9CmVsc2UKewogICAgbGlua3MuYWIxQm90LmFuaW1hdGVCb3QoKTsKCiAgICBsaW5rcy5hYjFCb3QubWFza3MubGluZVRvID0gbnVsbDsKCiAgICBpZiAobGlua3MuYWIxQm90LnRhZ3MuYXJtKQogICAgewogICAgICAgIGRlc3Ryb3kobGlua3MuYWIxQm90LmxpbmtzLmFybSk7CiAgICB9CgogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgogICAgbGlua3MuYWIxQm90Lm1hc2tzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gbGlua3MuYWIxQm90LmFuaW1hdGVCb3QoKSwgMjAwMCk7Cn0KJwD14LzrB4GJARxhYjFNYW5pZmVzdFN0YXRlQXdha2VPbkVudGVyAgQA9eC86wfLrAH2AUBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgPSB0cnVlOwoKbGV0IGRpbWVuc2lvbiA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CgppZiAoIWRpbWVuc2lvbikKewogICAgcmV0dXJuOwp9Cgp0aGlzQm90LmFiMU1hbmlmZXN0Qm90KHtkaW1lbnNpb246IGRpbWVuc2lvbiwgcG9zaXRpb246IHt4OiAwLCB5OiAwfX0pOycA9eC86weBiQEMb25BbnlCb3REcmFnAgQA9eC86wfCrgGsB0BpZiAodGhhdC5ib3QgIT0gbGlua3MuYWIxQm90KSByZXR1cm47CgppZiAobGlua3MuYWIxQm90LnRhZ3MuYXJtKQp7CiAgICBkZXN0cm95KGxpbmtzLmFiMUJvdC5saW5rcy5hcm0pOwp9CgppZiAoIXRoYXQuYm90LnRhZ3MuaW50ZXJ2YWwpCnsKICAgIHRoaXNCb3QuYWIxQ2xpY2soKTsKfQoKbGV0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKbGV0IGFybSA9IHt9OwoKYXJtLnNwYWNlID0gInRlbXBMb2NhbCI7CmFybVt0aGF0LmZyb20uZGltZW5zaW9uXSA9IHRydWU7CmFybS5kaW1lbnNpb24gPSB0aGF0LmZyb20uZGltZW5zaW9uOwphcm0uc2NhbGUgPSAwLjk7CmFybS5zY2FsZVogPSAwLjAxOwphcm0uY29sb3IgPSAiY2xlYXIiOwphcm0uc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKYXJtLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwphcm0ubGluZVRvID0gdGhhdC5ib3QuaWQ7CmFybS5tYW5hZ2VyID0gIvCflJciICsgdGhpc0JvdC5pZDsKYXJtLm9uQ2xpY2sgPSBgQCBkZXN0cm95KHRoaXNCb3QpOwoKbGlua3MubWFuYWdlci5hYjFNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiB0YWdzLmRpbWVuc2lvbiwgcG9zaXRpb246e3g6dGFnc1t0YWdzLmRpbWVuc2lvbiArICJYIl0seTp0YWdzW3RhZ3MuZGltZW5zaW9uICsgIlkiXX19KTtgOwoKaWYgKHN0YXRlKQp7CiAgICBhcm0ubXVsdGlTZWxlY3QgPSB0cnVlOwogICAgYXJtLmZvcm0gPSAic3BoZXJlIjsKICAgIGFybS5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwp9CgpsZXQgbmV3QXJtID0gYXdhaXQgY3JlYXRlKGFybSk7CgpsaW5rcy5hYjFCb3QubWFza3MuYXJtID0gIvCflJciICsgbmV3QXJtLmlkOwoKb3MucmVwbGFjZURyYWdCb3QobmV3QXJtKTsnAPXgvOsHgYkBEW9uQW55Qm90RHJvcEVudGVyAgQA9eC86wfrtQHFB0BpZiAoIXRhZ3MuYWIxQm90KSByZXR1cm47CmlmIChsaW5rcy5hYjFCb3QubGlua3MuYXJtICE9IHRoYXQuZHJhZ0JvdCkgcmV0dXJuOwoKaWYgKGxpbmtzLmFiMUJvdC5saW5rcy5hcm0udGFncy5tdWx0aVNlbGVjdCkKewogICAgaWYgKEFycmF5LmlzQXJyYXkobGlua3MuYWIxQm90LnRhZ3MubGluZVRvKSkKICAgIHsKICAgICAgICBsaW5rcy5hYjFCb3QubWFza3MubGluZVRvLnB1c2godGhhdC50by5ib3QuaWQpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxpbmtzLmFiMUJvdC5tYXNrcy5saW5lVG8gPSBbdGhhdC50by5ib3QuaWRdOwogICAgfQoKICAgIGxldCBuZXdMaW5rOwoKICAgIGlmICghbGlua3MuYWIxQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90cykKICAgIHsKICAgICAgICBuZXdMaW5rID0gZ2V0TGluayh0aGF0LnRvLmJvdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGV0IHByZXZpb3VzTGlua0JvdHMgPSBsaW5rcy5hYjFCb3QubGlua3MuYXJtLmxpbmtzLnNlbGVjdGVkQm90czsKCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHByZXZpb3VzTGlua0JvdHMpKQogICAgICAgIHsKICAgICAgICAgICAgcHJldmlvdXNMaW5rQm90cyA9IFtwcmV2aW91c0xpbmtCb3RzXQogICAgICAgIH0KCiAgICAgICAgcHJldmlvdXNMaW5rQm90cy5wdXNoKHRoYXQudG8uYm90KTsKCiAgICAgICAgbmV3TGluayA9IGdldExpbmsocHJldmlvdXNMaW5rQm90cyk7CiAgICB9CgogICAgbGlua3MuYWIxQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90cyA9IG5ld0xpbms7Cn0KZWxzZQp7CiAgICBsaW5rcy5hYjFCb3QubGlua3MuYXJtLm1hc2tzLnN0cm9rZUNvbG9yID0gImNsZWFyIjsKICAgIGxpbmtzLmFiMUJvdC5saW5rcy5hcm0ubWFza3MubGluZVRvID0gZmFsc2U7CgogICAgbGlua3MuYWIxQm90Lm1hc2tzLmxpbmVUbyA9IHRoYXQudG8uYm90LmlkOwp9JwD14LzrB4GJARBvbkFueUJvdERyb3BFeGl0AgQA9eC86wexvQGlAkBpZiAoIXRhZ3MuYWIxQm90KSByZXR1cm47CmlmIChsaW5rcy5hYjFCb3QubGlua3MuYXJtICE9IHRoYXQuZHJhZ0JvdCkgcmV0dXJuOwoKaWYgKCFsaW5rcy5hYjFCb3QubGlua3MuYXJtLi50YWdzLm11bHRpU2VsZWN0KQp7CiAgICBsaW5rcy5hYjFCb3QubGlua3MuYXJtLm1hc2tzLnN0cm9rZUNvbG9yID0gbnVsbDsKICAgIGxpbmtzLmFiMUJvdC5saW5rcy5hcm0ubWFza3MubGluZVRvID0gbnVsbDsKCiAgICBsaW5rcy5hYjFCb3QubWFza3MubGluZVRvID0gbGlua3MuYWIxQm90LmxpbmtzLmFybS5pZDsKfQoKJwD14LzrB4GJAQxvbkFueUJvdERyb3ACBAD14LzrB9e/AeoFQGlmICghdGFncy5hYjFCb3QpIHJldHVybjsKaWYgKGxpbmtzLmFiMUJvdC5saW5rcy5hcm0gIT0gdGhhdC5kcmFnQm90KSByZXR1cm47CgppZiAobGlua3MuYWIxQm90LmxpbmtzLmFybS50YWdzLm11bHRpU2VsZWN0KQp7CiAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYjFNdWx0aXBsZUJvdEZvY3VzID0gbGlua3MuYWIxQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90czsKCiAgICB0aGlzQm90LmFiMUNsaWNrKHttZW51OiAibXVsdGlwbGVCb3QifSk7CgogICAgZGVzdHJveShsaW5rcy5hYjFCb3QubGlua3MuYXJtKTsKfQplbHNlIGlmICh0aGF0LnRvLmJvdCkKewogICAgaWYgKHRoYXQudG8uYm90ID09IGxpbmtzLmFiMUJvdCkKICAgIHsKICAgICAgICBsaW5rcy5tZW51LmFiMUVudmlyb25tZW50TWVudSgpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiMUJvdEZvY3VzID0gIvCflJciICsgdGhhdC50by5ib3QuaWQ7CgogICAgICAgIHRoaXNCb3QuYWIxQ2xpY2soe21lbnU6ICJib3QifSk7CiAgICB9CgogICAgZGVzdHJveShsaW5rcy5hYjFCb3QubGlua3MuYXJtKTsKfQplbHNlCnsKICAgIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiMUdyaWRGb2N1cyA9IHtkaW1lbnNpb246IHRoYXQudG8uZGltZW5zaW9uLCBwb3NpdGlvbjoge3g6IHRoYXQudG8ueCwgeTogdGhhdC50by55fX07CgogICAgdGhpc0JvdC5hYjFDbGljayh7bWVudTogImdyaWQifSk7Cn0nAPXgvOsHgYkBCWFiMUlnbm9yZQIEAPXgvOsHwMUBBHRydWUoAPXgvOsHgYkBDWFiMUJvdFZlcnNpb24BfQsA"}]}