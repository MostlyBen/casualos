{"version":2,"updates":[{"id":0,"timestamp":1679427713967,"update":"AZoB56L71wcAJwEEYm90cyQwMjgzNjVhNC0wMzZmLTQxZDAtOWFmMS03MTVhZDRmMmFhN2EBJwDnovvXBwAGc3lzdGVtAgQA56L71wcBEmFiLTEuY29yZS5yZWd1bGF0ZScA56L71wcABGZvcm0CBADnovvXBxQHbm90aGluZycA56L71wcAB2FiMUNvcmUCBADnovvXBxwEdHJ1ZScA56L71wcADG9uQW55Qm90RHJhZwIEAOei+9cHIZQBQGlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRTbmFwU3RhdGUpCnsKICAgIG9zLmFkZERyb3BTbmFwKCJncmlkIik7Cn0KCmlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZSkKewogICAgb3MuYWRkRHJvcFNuYXAoImZhY2UiKTsKfScA56L71wcACHJlbWVtYmVyAgQA56L71we2ASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwEEYm90cyQzNGMzYzIxMC01YmYxLTQ5Y2YtYjE1MS1lZTJkMDdmMGU2NzMBJwDnovvXB90BBnN5c3RlbQIEAOei+9cH3gEQYWItMS5jb3JlLmNyZWF0ZSgA56L71wfdAQdhYjFDb3JlAXgnAOei+9cH3QEEZm9ybQIEAOei+9cH8AEHbm90aGluZycA56L71wfdAQtkZXNjcmlwdGlvbgIEAOei+9cH+AE9Qm90IHVzZWQgdG8gY3JlYXRlL21hbmlmZXN0IGJvdHMgaW50byBhbiBhY3R1YWwgc2NlbmUvcG9ydGFsLicA56L71wfdAQ1hYjFDcmVhdGVCb3RzAgQA56L71we2AqYZQC8vTkVFRCBUTyBVTkRFUlNUQU5EIFdIQVQgVE8gRE8gSUYgQU4gQVJSQVkgSVMgR0lWRU4KbGV0IGJvdERhdGEgPSB0aGF0LmJvdHM7CmxldCBvcmlnaW4gPSB0aGF0Lm9yaWdpbjsKbGV0IHZlcnNpb24gPSB0aGF0LnZlcnNpb247CmxldCBpZE1hcCA9IG5ldyBNYXAoKTsKbGV0IG5ld0JvdHMgPSBbXTsKCmZvciAoY29uc3QgcHJvcGVydHkgaW4gYm90RGF0YSkKewogICAgY29uc3QgbmV3Qm90ID0gYm90RGF0YVtwcm9wZXJ0eV07CiAgICBjb25zdCBib3RUb3RhbCA9IE9iamVjdC5rZXlzKGJvdERhdGEpLmxlbmd0aDsKICAgIGNvbnN0IGFiSURPcmlnaW4gPSB7YWJJRE9yaWdpbjogb3JpZ2lufTsKICAgIGNvbnN0IGFiMUdyaWRGb2N1cyA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxR3JpZEZvY3VzOwoKICAgIGlmIChuZXdCb3QudGFncykgCiAgICB7CiAgICAgICAgaWYgKG5ld0JvdC50YWdzLmNyZWF0b3IpIAogICAgICAgIHsKICAgICAgICAgICAgYWJJRE9yaWdpbi5vbGRDcmVhdG9yID0gbmV3Qm90LnRhZ3MuY3JlYXRvcjsKICAgICAgICB9CgogICAgICAgIGxldCB0YXJnZXRQb3NpdGlvbjsKCiAgICAgICAgdHJ5IAogICAgICAgIHsKICAgICAgICAgICAgaWYgKGJvdFRvdGFsIDwgMiAmJiBhYjFHcmlkRm9jdXMpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0RGltZW5zaW9uID0gYWIxR3JpZEZvY3VzLmRpbWVuc2lvbjsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdGFyZ2V0UG9zaXRpb24gPSB7IFt0YXJnZXREaW1lbnNpb25dOiB0cnVlLCBbdGFyZ2V0RGltZW5zaW9uICsgIlgiXTogYWIxR3JpZEZvY3VzLnBvc2l0aW9uLngsIFt0YXJnZXREaW1lbnNpb24gKyAiWSJdOiBhYjFHcmlkRm9jdXMucG9zaXRpb24ueSB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgYiA9IGNyZWF0ZShuZXdCb3QudGFncywgdGFyZ2V0UG9zaXRpb24sIGFiSURPcmlnaW4pOwoKICAgICAgICAgICAgaWRNYXAuc2V0KHByb3BlcnR5LCBiLmlkKTsKICAgICAgICAgICAgbmV3Qm90cy5wdXNoKGIpOwoKICAgICAgICAgICAgaWYgKGIudGFncy5jcmVhdG9yID09IHRoaXNCb3QuaWQpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBiLnRhZ3MuY3JlYXRvciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycm9yKSAKICAgICAgICB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJpbnZhbGlkIGJvdCIsIGVycm9yKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIAogICAgewogICAgICAgIGNvbnNvbGUubG9nKCJza2lwcGVkIGJvdDogIiArIG5ld0JvdCk7CiAgICB9Cn0KCmxldCBsaW5rVGFncyA9IFsibGluayIsICJjcmVhdG9yIiwgImNvbmZpZ0JvdCIsICJsaW5lVG8iLCAidHJhbnNmb3JtZXIiXTsKCmZvciAobGV0IG5ld0JvdCBvZiBuZXdCb3RzKSAKewogICAgZm9yIChsZXQgdGFnIG9mIGxpbmtUYWdzKSAKICAgIHsKICAgICAgICBsZXQgdmFsdWUgPSBuZXdCb3QudGFnc1t0YWddOwoKICAgICAgICBpZiAodGFnID09ICJjcmVhdG9yIikgCiAgICAgICAgewogICAgICAgICAgICB2YWx1ZSA9IG5ld0JvdC50YWdzLm9sZENyZWF0b3I7CiAgICAgICAgICAgIG5ld0JvdC50YWdzLm9sZENyZWF0b3IgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgdXBkYXRlQm90TGlua3MobmV3Qm90LCBpZE1hcCk7CgogICAgICAgIGlmICh2YWx1ZSkgCiAgICAgICAgewogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsZXQgbmV3VmFsdWUgPSB2YWx1ZS5tYXAoaWQgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpZE1hcC5nZXQoaWQpIHx8IGlkOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICBuZXdCb3QucmF3W3RhZ10gPSBuZXdWYWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXdJRCA9IGlkTWFwLmdldCh2YWx1ZSk7CgogICAgICAgICAgICAgICAgaWYgKG5ld0lEKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBuZXdCb3QucmF3W3RhZ10gPSBuZXdJRDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKaWYgKGNvbmZpZ0JvdC50YWdzLmFiMVNpbGVudE1vZGUgPT0gbnVsbCAmJiAhY29uZmlnQm90LnRhZ3MucGggJiYgYnVpbGRlclZlcnNpb24gPT0gImJ1aWxkZXIiKSAKewogICAgb3MudG9hc3QoImhhdGNoZWQgIiArIG9yaWdpbiArICIgdiIgKyB2ZXJzaW9uKTsKfQoKY29uZmlnQm90LnRhZ3MubGFzdEVnZ0hhdGNoZWQgPSBvcmlnaW47CgovL05FRUQgYWJCb3RJRCA9IGF3YWl0IHdoaXNwZXIob3ZvTmVzdCwgIm92b0FiU2V0dXAiLCB7YWJJRDogb3JpZ2luLCB2ZXJzaW9uOiB2ZXJzaW9ufSlbMF07Cgp3aGlzcGVyKG5ld0JvdHMsICJvbkVnZ0hhdGNoIiwge2FiOiBvcmlnaW4sIHZlcnNpb246IHZlcnNpb259KTsKCnNob3V0KCJvbkFiQWRkZWQiLCB7YWI6IG9yaWdpbiwgdmVyc2lvbjogdmVyc2lvbn0pOwoKLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgIC8vbGV0IGluaXRpYWxEZXBsb3kgPSBhYjFJbnN0TWVtb3J5LnRhZ3MuYmFzZUFCID09ICJpblByb2dyZXNzIiYmIChvcmlnaW4gPT0gY29uZmlnQm90LnRhZ3MuYWIgfHwgb3JpZ2luID09IGNvbmZpZ0JvdC50YWdzLmF1dG9Mb2FkIHx8IG9yaWdpbiA9PSBjb25maWdCb3QudGFncy5hdXhDb2RlKTsKCgoKICAgIC8vIGlmIChpbml0aWFsRGVwbG95KQogICAgLy8gewogICAgLy8gICAgIGxldCBwcmV2aW91c0JvdHMgPSBnZXRCb3RzKGJ5TW9kKHsic3BhY2UiOiAic2hhcmVkIiwgImFiMUlEIjogbnVsbH0pKTsKCiAgICAvLyAgICAgaWYgKHByZXZpb3VzQm90cykKICAgIC8vICAgICB7CiAgICAvLyAgICAgICAgIGRlc3Ryb3kocHJldmlvdXNCb3RzKTsKICAgIC8vICAgICB9IAogICAgLy8gfQoKICAgIC8vIGlmIChpbml0aWFsRGVwbG95KQogICAgLy8gewogICAgLy8gICAgIGxldCBwcmVoYXRjaCA9IGF3YWl0IHNob3V0KCJvblByZUhhdGNoIiwge2FiOiBvcmlnaW59KVswXTsKCiAgICAvLyAgICAgaWYgKCFwcmVoYXRjaCkKICAgIC8vICAgICB7CiAgICAvLyAgICAgICAgIGFiMUluc3RNZW1vcnkudGFncy5iYXNlQUIgPSBvcmlnaW47CiAgICAvLyAgICAgfQogICAgLy8gfScA56L71wfdAQhyZW1lbWJlcgIEAOei+9cH3Rso8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycBBGJvdHMkNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3AScA56L71weEHAZzeXN0ZW0CBADnovvXB4UcD2FiLTEuY29yZS5sZWFybicA56L71weEHAVhYjFJRAIEAOei+9cHlRwFbGVhcm4nAOei+9cHhBwEZm9ybQIEAOei+9cHmxwHbm90aGluZycA56L71weEHAdhYjFCb290AgQA56L71wejHLEFQGxldCBpbnN0TW9kZUNoZWNrID0gYXdhaXQgb3MudmVyc2lvbigpLnBsYXllck1vZGU7CmxldCBpbml0aWFsQm9vdCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuaW5pdGlhbEJvb3QgPyB0cnVlIDogZmFsc2U7CgpnbG9iYWxUaGlzLmJ1aWxkZXJWZXJzaW9uID0gaW5zdE1vZGVDaGVjayA9PSAiYnVpbGRlciIgPyB0cnVlIDogZmFsc2U7Cmdsb2JhbFRoaXMuYWIxID0gdGhpc0JvdDsKCmlmIChpbnN0TW9kZUNoZWNrID09ICJidWlsZGVyIikKewogICAgbGlua3MucmVtZW1iZXIudGFncy5hYjFBd2FrZVN0YXRlID0gdHJ1ZTsKCiAgICBhd2FpdCB0aGlzQm90LmFiMUFkYXB0KCJhYjFJbnRlcmZhY2UiKTsKCiAgICBpZiAoaW5pdGlhbEJvb3QpCiAgICB7CiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYjFNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsLCBwb3NpdGlvbjp7eDowLHk6MH19KTsKICAgIH0KfQoKLy9VVUFCCi8vYm90LnZhcnMKCi8vIGlmIChhdXRvQUIpCi8vIHsKLy8gICAgIGxldCBlZ2dEYXRhID0gYXdhaXQgbGlua3Muc3RvcmUuYWIxUmV0cmlldmVSZWNvcmQoYXV0b0FCKTsKCi8vICAgICBjb25zb2xlLmxvZyhlZ2dEYXRhKTsKLy8gfQoKaWYgKGluaXRpYWxCb290KQp7CiAgICBsaW5rcy5yZW1lbWJlci50YWdzLmluaXRpYWxCb290ID0gZmFsc2U7Cn0oAOei+9cHhBwHYWIxQ29yZQF4JwDnovvXB4QcCGFiMUFkYXB0AgQA56L71wfWIfIFQGNvbnN0IHN5c3RlbUlEID0gdGhhdDsKY29uc3QgYm9vdFN0cmFwID0gb3MuZ2V0QUIxQm9vdHN0cmFwVVJMKCkKY29uc3Qgc2tpbGxGaWxlID0gYm9vdFN0cmFwLnNsaWNlKDAsIGJvb3RTdHJhcC5sZW5ndGgtNykgKyBzeXN0ZW1JRCArIi5hdXgiOwoKdHJ5CnsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2ViaG9vayh7CiAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICB1cmw6IHNraWxsRmlsZQogICAgfSk7CgogICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1thYjEgYm9vdHN0cmFwXSBDb3VsZCBub3QgZG93bmxvYWQgc2tpbGwuJyk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHVwZGF0ZXMgPSByZXNwb25zZS5kYXRhLnVwZGF0ZXM7CiAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IG9zLmdldEluc3RTdGF0ZUZyb21VcGRhdGVzKHVwZGF0ZXMpOwogICAgY29uc3QgaWRzID0gT2JqZWN0LmtleXMoc3RhdGUpOwogICAgCiAgICBhd2FpdCBvcy5hcHBseVVwZGF0ZXNUb0luc3QodXBkYXRlcyk7CgogICAgd2hpc3BlcihpZHMsIHRhZ05hbWUsIGNvbmZpZ0JvdC50YWdzLmluc3QpOwoKICAgIC8vYWIxLmxvZygiYWItMSBhZGFwdCIpOwogICAgY29uc29sZS5sb2coImFiLTEgYWRhcHQiKTsKCiAgICByZXR1cm4gdHJ1ZTsKfQpjYXRjaAp7CiAgICBjb25zb2xlLmxvZygnW2FiMSBib290c3RyYXBdIENvdWxkIG5vdCBkb3dubG9hZCBza2lsbC4nKTsKfScA56L71weEHAtkZXNjcmlwdGlvbgIEAOei+9cHySdRVGhpcyBza2lsbCBpcyBkZXNpZ25lZCB0byBoYW5kbGUgYm90aCByZWNvbmZpZ3VyYXRpb24gb2YgYWItMSBhbmQgaW5pdGlhbGl6YXRpb24uJwDnovvXB4QcCm9uQm90QWRkZWQCBADnovvXB5soSUBjb25zb2xlLmxvZygiYWItMSBTVEFSVCBVUCIpOwoKc2V0VGltZW91dCgoKSA9PiB0aGlzQm90LmFiMUJvb3QoKSwgNTAwKTsnAOei+9cHhBwIcmVtZW1iZXICBADnovvXB+UoKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAOei+9cHhBwDbG9nAgQA56L71weMKZMBQGxldCB1cGRhdGVkTG9nczsKCmlmICghdGFncy5hYjFMb2cpCnsKICAgIHVwZGF0ZWRMb2dzID0gdGhhdDsKfQplbHNlCnsKICAgIHVwZGF0ZWRMb2dzID0gdGFncy5hYjFMb2cgKyAiXG4iICsgdGhhdDsKfQoKbWFza3MuYWIxTG9nID0gdXBkYXRlZExvZ3M7JwDnovvXB4QcDW1hbmlmZXN0YXRpb24CBADnovvXB6AqKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAOei+9cHhBwNYWIxQ3JlYXRlSG9zdAIEAOei+9cHxyrlB0BpZiAobGlua3MucmVtZW1iZXIudGFncy5ob3N0SUQpCnsKICAgIG9zLnRvYXN0KCJjb2RlIGNvcGllZCB0byBjbGlwYm9hcmQiKTsKCiAgICBvcy5zZXRDbGlwYm9hcmQobGlua3MucmVtZW1iZXIudGFncy5ob3N0SUQuc3Vic3RyaW5nKDAsMykgKyAiLSIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRC5zdWJzdHJpbmcoMykpOwoKICAgIHJldHVybjsKfQoKbGV0IG5ld0hvc3RJRCA9IHV1aWQoKS5yZXBsYWNlQWxsKCItIiwgIiIpLnN1YnN0cmluZygwLDYpOwpsZXQgZGF0ZSA9IERhdGVUaW1lLm5vdygpLnRvTWlsbGlzKCk7CmxldCByZWNvcmRLZXkgPSBhd2FpdCBvcy5nZXREYXRhKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxUmVjb3JkS2V5LCAiYjIwN2E1ZTQtZDUzMS00ODRmLWEwZDYtNjYyNmJlZjU5MDEzIiwgImh0dHBzOi8vcHVibGljb3MubGluayIpOwpsZXQgcmVjb3JkRGF0YSA9IGF3YWl0IG9zLnJlY29yZERhdGEocmVjb3JkS2V5LmRhdGEsIG5ld0hvc3RJRCwge3VybDogY29uZmlnQm90LnRhZ3MudXJsLCBkYXRlOiBkYXRlfSwgImh0dHBzOi8vcHVibGljb3MubGluayIpOwoKaWYgKHJlY29yZERhdGEuc3VjY2VzcykKewogICAgbGlua3MucmVtZW1iZXIudGFncy5ob3N0SUQgPSBuZXdIb3N0SUQuc3Vic3RyaW5nKDAsMykgKyAiLSIgKyBuZXdIb3N0SUQuc3Vic3RyaW5nKDMpOwoKICAgIG9zLnNldENsaXBib2FyZChsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRCk7CgogICAgdGhhdC50YWdzLmxhYmVsID0gImpvaW4gY29kZTogIiArIG5ld0hvc3RJRC5zdWJzdHJpbmcoMCwzKSArICItIiArIG5ld0hvc3RJRC5zdWJzdHJpbmcoMyk7CgogICAgb3MudG9hc3QoImhvc3QgZ2VuZXJhdGVkLCBjb2RlIGNvcGllZCB0byBjbGlwYm9hcmQ6ICIgKyBuZXdIb3N0SUQpOwp9CmVsc2UKewogICAgb3MudG9hc3QoInNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluIik7CgogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7Cn0nAOei+9cHhBwLYWIxSm9pbkhvc3QCBADnovvXB60yrgZAc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgpsZXQgam9pbkNvZGUgPSB0aGF0LnRleHQucmVwbGFjZUFsbCgiLSIsICIiKTsKbGV0IHJlY29yZEtleSA9IGF3YWl0IG9zLmdldERhdGEobGlua3MucmVtZW1iZXIudGFncy5hYjFSZWNvcmRLZXksICJiMjA3YTVlNC1kNTMxLTQ4NGYtYTBkNi02NjI2YmVmNTkwMTMiLCAiaHR0cHM6Ly9wdWJsaWNvcy5saW5rIik7CmxldCBnZXRSZWNvcmQgPSBhd2FpdCBvcy5nZXREYXRhKHJlY29yZEtleS5kYXRhLCBqb2luQ29kZSwgImh0dHBzOi8vcHVibGljb3MubGluay8iKTsKCmlmIChnZXRSZWNvcmQuc3VjY2VzcykKewogICAgbGV0IGRhdGUgPSBEYXRlVGltZS5ub3coKTsKICAgIGxldCBjcmVhdGVEYXRlID0gRGF0ZVRpbWUuZnJvbU1pbGxpcyhnZXRSZWNvcmQuZGF0YS5kYXRlKTsKICAgIGxldCBkaWZmZXJlbmNlID0gZGF0ZS5kaWZmKGNyZWF0ZURhdGUsICJkYXlzIikudG9PYmplY3QoKTsKCiAgICBkaWZmZXJlbmNlID0gTWF0aC5mbG9vcihkaWZmZXJlbmNlLmRheXMpOwoKICAgIGlmIChkaWZmZXJlbmNlIDwgOCkKICAgIHsKICAgICAgICBvcy50b2FzdCgiam9pbmluZyBob3N0IG5vdyIpOwogICAgCiAgICAgICAgb3MuZ29Ub1VSTChnZXRSZWNvcmQuZGF0YS51cmwpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG9zLnRvYXN0KCJqb2luIGNvZGUgb3V0IG9mIGRhdGUsIHBsZWFzZSBnZW5lcmF0ZSBhIG5ldyBqb2luIGNvZGUiKTsKICAgIH0KfQplbHNlCnsKICAgIG9zLnRvYXN0KCJ1bmFibGUgdG8gam9pbiwgcGxlYXNlIGNoZWNrIGNvZGUgYW5kIHRyeSBhZ2FpbiIpOwp9JwEEYm90cyQ3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YBJwDnovvXB9w4BnN5c3RlbQIEAOei+9cH3TgPYWItMS5jb3JlLnN0b3JlKADnovvXB9w4B2FiMUNvcmUBeCcA56L71wfcOARmb3JtAgQA56L71wfuOAdub3RoaW5nJwDnovvXB9w4C2Rlc2NyaXB0aW9uAgQA56L71wf2OD9UaGlzIHNraWxsIGlzIG1lYW50IHRvIGJlIGEgY29uZmlndXJhYmxlIG1lYW5zIHRvIHB1Ymxpc2ggZGF0YS4nAOei+9cH3DgQYWIxUHVibGlzaFJlY29yZAIEAOei+9cHtjmLA0BsZXQgcmVjb3JkRGF0YSA9IHRoYXQuZGF0YTsKbGV0IHJlY29yZE5hbWUgPSB0aGF0LnJlY29yZE5hbWU7CmxldCByZWNvcmRLZXkgPSB0aGF0LnJlY29yZEtleSA/IHRoYXQucmVjb3JkS2V5IDogbGlua3MucmVtZW1iZXIudGFncy5hYjFSZWNvcmRLZXk7CmxldCByZWNvcmRFbmRwb2ludCA9IHRoYXQucmVjb3JkRW5kcG9pbnQgPyB0aGF0LnJlY29yZEVuZHBvaW50IDogImh0dHBzOi8vcHVibGljb3MubGluayI7CgppZiAoIXJlY29yZERhdGEpCnsKICAgIHJldHVybiAibm8gZGF0YSBzdXBwbGllZCI7Cn0KCnJlY29yZERhdGEgPSBhd2FpdCBvcy5yZWNvcmREYXRhKHJlY29yZEtleSwgcmVjb3JkTmFtZSwgcmVjb3JkRGF0YSwgcmVjb3JkRW5kcG9pbnQpOwoKcmV0dXJuIHJlY29yZERhdGE7JwDnovvXB9w4DmFiMVB1Ymxpc2hGaWxlAgQA56L71wfCPLgDQGxldCBmaWxlID0gdGhhdC5maWxlOwpsZXQgZmlsZU5hbWUgPSB0aGF0LmZpbGVOYW1lOwpsZXQgbWltZVR5cGUgPSB0aGF0Lm1pbWVUeXBlOwpsZXQgcmVjb3JkS2V5ID0gdGhhdC5yZWNvcmRLZXkgPyB0aGF0LnJlY29yZEtleSA6IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxUmVjb3JkS2V5OwpsZXQgcmVjb3JkRW5kcG9pbnQgPSB0aGF0LnJlY29yZEVuZHBvaW50ID8gdGhhdC5yZWNvcmRFbmRwb2ludCA6ICJodHRwczovL3B1YmxpY29zLmxpbmsiOwoKaWYgKCFmaWxlKQp7CiAgICByZXR1cm4gIm5vIGZpbGUgc3VwcGxpZWQiOwp9CgpsZXQgZmlsZVVwbG9hZCA9IGF3YWl0IG9zLnJlY29yZEZpbGUocmVjb3JkS2V5LCBmaWxlLCB7ZGVzY3JpcHRpb246IGZpbGVOYW1lLCBtaW1lVHlwZTogbWltZVR5cGV9LCByZWNvcmRFbmRwb2ludCk7CgpyZXR1cm4gZmlsZVVwbG9hZDsnAOei+9cH3DgRYWIxQ29yZU1lbnVBY3Rpb24CBADnovvXB/s/DEB0aGlzQm90LigpOycA56L71wfcOAtvblN0b3JlTWVudQIEAOei+9cHiEApQC8vQ1JFQVRFIEEgTUVOVSBIRVJFCgpvcy50b2FzdCgiSEVMTE8iKTsnAOei+9cH3DgPYWIxQ29yZU1lbnVJY29uAgQA56L71weyQAlpb3Nfc2hhcmUnAOei+9cH3DgQYWIxQ29yZU1lbnVMYWJlbAIEAOei+9cHvEAFc2hhcmUnAOei+9cH3DgUYWIxQ29yZU1lbnVTb3J0T3JkZXICBADnovvXB8JAATQnAOei+9cH3DgIcmVtZW1iZXICBADnovvXB8RAKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAQRib3RzJGQ4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNQEnAOei+9cH60AGc3lzdGVtAgQA56L71wfsQBBhYi0xLmNvcmUuc2VhcmNoJwDnovvXB+tABGZvcm0CBADnovvXB/1AB25vdGhpbmcnAOei+9cH60AHYWIxQ29yZQIEAOei+9cHhUEEdHJ1ZScA56L71wfrQA9hYjFSZXRyaWV2ZUZpbGUCBADnovvXB4pBbEBpZiAoIXRoYXQudXJsKQp7CiAgICByZXR1cm4gIm5vIGZpbGUgdXJsIHN1cHBsaWVkIjsKfQoKbGV0IGRhdGEgPSBhd2FpdCBvcy5nZXRGaWxlKHRoYXQudXJsKTsKCnJldHVybiBkYXRhOycA56L71wfrQBFhYjFSZXRyaWV2ZVJlY29yZAIEAOei+9cH90HpAkBsZXQgcmVjb3JkTmFtZSA9IHRoYXQucmVjb3JkTmFtZTsKbGV0IHJlY29yZEtleSA9IHRoYXQucmVjb3JkS2V5ID8gdGhhdC5yZWNvcmRLZXkgOiBsaW5rcy5yZW1lbWJlci50YWdzLmFiMVJlY29yZEtleTsKbGV0IHJlY29yZEVuZHBvaW50ID0gdGhhdC5yZWNvcmRFbmRwb2ludCA/IHRoYXQucmVjb3JkRW5kcG9pbnQgOiAiaHR0cHM6Ly9wdWJsaWNvcy5saW5rIjsKCmlmICghcmVjb3JkTmFtZSkKewogICAgcmV0dXJuICJubyByZWNvcmQgbmFtZSBzdXBwbGllZCI7Cn0KCmxldCBnZXRSZWNvcmQgPSBhd2FpdCBvcy5nZXREYXRhKHJlY29yZEtleSwgcmVjb3JkTmFtZSwgcmVjb3JkRW5kcG9pbnQpOwoKcmV0dXJuIGdldFJlY29yZDsnAOei+9cH60ARYWIxQ29yZU1lbnVBY3Rpb24CBADnovvXB+FELEB0aGlzQm90Lm9uTG9va3VwQUIxRWdncyh7YWJJRDogdGhhdC50ZXh0fSk7KADnovvXB+tADG9uU2VhcmNoTWVudQF+JwDnovvXB+tAD2FiMUNvcmVNZW51SWNvbgIEAOei+9cHj0UGc2VhcmNoJwDnovvXB+tAEGFiMUNvcmVNZW51TGFiZWwCBADnovvXB5ZFBnNlYXJjaCcA56L71wfrQBVhYjFDb3JlTWVudU9uR2VuZXJhdGUCBADnovvXB51FaEB0YWdzLmZvcm0gPSAiaW5wdXQiOwp0YWdzLm9uQ2xpY2sgPSBudWxsOwp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiMUNvcmVNZW51QWN0aW9uKHRoYXQpO2A7JwDnovvXB+tAFGFiMUNvcmVNZW51U29ydE9yZGVyAgQA56L71weGRgEyJwDnovvXB+tACHJlbWVtYmVyAgQA56L71weIRijwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwDnovvXB+tADW1hbmlmZXN0YXRpb24CBADnovvXB69GKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAOei+9cH60APb25Mb29rdXBBQjFFZ2dzAgQA56L71wfWRv0aQC8vc2hvdXQoImFiMUxUTVNlYXJjaCIsIHthYklEOiBhYklELCBrZXk6IGtleSwgYXV0b0hhdGNoOiBib29sZWFuLCByZXR1cm5UeXBlOiBkYXRhL251bGx9KTsKYWIxLmxvZygiYWItMSBhYiBsb2FkICIgKyB0aGF0KTsKCmlmIChsaW5rcy5tYW5pZmVzdGF0aW9uKQp7CiAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7Cn0KCmNvbnN0IGFiSUQgPSB0aGF0LmFiSUQ7CmNvbnN0IGtleSA9IHRoYXQua2V5Owpjb25zdCBhdXRvSGF0Y2ggPSB0aGF0LmF1dG9IYXRjaDsKY29uc3QgcmV0dXJuVHlwZSA9IHRoYXQucmV0dXJuVHlwZTsKY29uc3QgZ2V0UmVjb3JkID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiMVJlY29yZEtleSwgYWJJRCwgbGlua3MucmVtZW1iZXIudGFncy5hYjFFbmRwb2ludCk7CgpsZXQgbmV3RWdnOwoKaWYgKCFnZXRSZWNvcmQuc3VjY2VzcyAmJiBjb25maWdCb3QudGFncy5naWcpLy9CUklORyBJTiBJTklUQUlBTCBDT0xMQUIgU0VUVVAKewogICAgY29uc3QgY29sbGFiQm90ID0gZ2V0Qm90KCJhYklET3JpZ2luIiwgImNvbGxhYlNldHVwIik7CgogICAgaWYgKCFjb2xsYWJCb3QpCiAgICB7CiAgICAgICAgdGhpc0JvdC5vbkxvb2t1cEFCMUVnZ3Moe2FiSUQ6ICJjb2xsYWJTZXR1cCIsIGF1dG9IYXRjaDogdHJ1ZX0pOwogICAgfQp9CmVsc2UgaWYgKCFnZXRSZWNvcmQuc3VjY2VzcykKewogICAgLy9NQVlCRSBSRU1PVkUgVEhJUyBTT09OPz8/CiAgICBjb25zb2xlLmxvZyhnZXRSZWNvcmQsICJjaGVja2luZyBvbGQgU1RNIik7CgogICAgbGV0IGZpbGVuYW1laGFzaCA9IGNyeXB0by5zaGEyNTYoYWJJRCk7CiAgICBsZXQgZmlsZXVybGhhc2ggPSAiYXV4XyIgKyBmaWxlbmFtZWhhc2ggKyAnLmF1eCc7CiAgICBsZXQgdGFyZ2V0VVJMID0gImh0dHBzOi8vYnVpbGRlci1zdG0tZmlsZXMuczMuYW1hem9uYXdzLmNvbS8iICsgZmlsZXVybGhhc2g7CiAgICBsZXQgbyA9IHt9OwogICAgby5tZXRob2QgPSAiR0VUIjsKICAgIG8udXJsID0gdGFyZ2V0VVJMOwoKICAgIHRyeSAKICAgIHsKICAgICAgICBsZXQgbHRtUmVzcG9uc2UgPSBhd2FpdCB3ZWJob29rKG8pOwoKICAgICAgICBuZXdFZ2cgPSBsdG1SZXNwb25zZS5kYXRhLnN0YXRlOwoKICAgICAgICBmb3IgKGNvbnN0IHByb3BlcnR5IGluIG5ld0VnZykKICAgICAgICB7CiAgICAgICAgICAgIGNvbnN0IG5ld01PRCA9IG5ld0VnZ1twcm9wZXJ0eV07CgogICAgICAgICAgICBuZXdFZ2cgPSBuZXdNT0Q7CiAgICAgICAgfQogICAgfSAKICAgIGNhdGNoIChlKSAKICAgIHsKCiAgICAgICAgb3MudG9hc3QoYG5vIGRhdGEgZm91bmQgaW4gJHthYklEfWApOwoKICAgICAgICBzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgcmV0dXJuICJhYklEIG5vdCBmb3VuZCI7CiAgICB9Cn0KZWxzZQp7CiAgICBuZXdFZ2cgPSBnZXRSZWNvcmQuZGF0YTsKfQoKaWYgKHJldHVyblR5cGUgPT0gImRhdGEiICYmIGdldFJlY29yZC5zdWNjZXNzKQp7CiAgICBsZXQgdmVyc2lvbiA9IGdldFJlY29yZC5kYXRhLnRhcmdldFZlcnNpb24gLSAxOwoKICAgIGlmICh0aGF0LmFiVmVyc2lvbikKICAgIHsKICAgICAgICBpZiAoIWlzTmFOKHRoYXQuYWJWZXJzaW9uKSkKICAgICAgICB7CiAgICAgICAgICAgIHZlcnNpb24gPSB0aGF0LmFiVmVyc2lvbiAtIDE7CiAgICAgICAgfQogICAgfQoKICAgIGxldCBlZ2dEYXRhVVJMID0gZ2V0UmVjb3JkLmRhdGEuZWdnVmVyc2lvbkhpc3RvcnlbdmVyc2lvbl07CiAgICBsZXQgcmV0dXJuRGF0YSA9IGF3YWl0IG9zLmdldEZpbGUoZWdnRGF0YVVSTCk7CgogICAgcmV0dXJuIHJldHVybkRhdGE7Cn0KZWxzZSBpZiAocmV0dXJuVHlwZSA9PSAiZGF0YSIpCnsKICAgIGxldCB2ZXJzaW9uQXJyYXkgPSBKU09OLnBhcnNlKG5ld0VnZy5lZ2dWZXJzaW9uSGlzdG9yeSk7CiAgICBsZXQgZmlsZVVVSUQgPSB2ZXJzaW9uQXJyYXlbbmV3RWdnLm1heFZlcnNpb24gLSAxXTsKICAgIGxldCBmaWxlbmFtZWhhc2hMVE0gPSBjcnlwdG8uc2hhMjU2KGZpbGVVVUlEKTsKICAgIGxldCBmaWxldXJsaGFzaExUTSA9ICJhdXhfIiArIGZpbGVuYW1laGFzaExUTSArICcuYXV4JzsKICAgIGxldCB0YXJnZXRMVE1VUkwgPSAiaHR0cHM6Ly9idWlsZGVyLWx0bS1maWxlcy5zMy5hbWF6b25hd3MuY29tLyIgKyBmaWxldXJsaGFzaExUTTsKICAgIGxldCBvID0ge307CiAgICBvLm1ldGhvZCA9ICJHRVQiOwogICAgby51cmwgPSB0YXJnZXRMVE1VUkw7CgogICAgZmlsZUdldCA9IGF3YWl0IHdlYmhvb2sobyk7CgogICAgaWYgKGZpbGVHZXQuc3RhdHVzICE9IDIwMCkKICAgIHsKICAgICAgICBvcy50b2FzdCgibm8gZmlsZSBmb3VuZCIpOwoKICAgICAgICBzaG91dCgiYWIxUmVmcmVzaCIpOwoKICAgICAgICByZXR1cm47CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgZmlsZUdldCA9IGZpbGVHZXQuZGF0YTsKICAgIH0KCiAgICByZXR1cm4gZmlsZUdldDsKfQoKY29uc3QgYWIxQm90ID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYjFCb3Q7CgpsZXQgY3VycmVudERpbTsKbGV0IHNwYWNlTW9kOwpsZXQgZGltZW5zaW9uWDsKbGV0IGRpbWVuc2lvblk7CmxldCBkaW1Nb2Q7CgppZiAoYWIxQm90KQp7CiAgICBjdXJyZW50RGltID0gYWIxQm90LnRhZ3MuZGltZW5zaW9uOwp9CmVsc2UKewogICAgY3VycmVudERpbSA9IG9zLmdldEN1cnJlbnREaW1lbnNpb24oKTsKfQoKaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRGb2N1cykgCnsKICAgIGRpbWVuc2lvblggPSBudWxsOwogICAgZGltZW5zaW9uWSA9IG51bGw7Cn0KZWxzZQp7CiAgICBsZXQgaGF0Y2hQb2ludCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxR3JpZEZvY3VzOwoKICAgIGN1cnJlbnREaW0gPSBoYXRjaFBvaW50LmRpbWVuc2lvbjsKICAgIGRpbWVuc2lvblggPSBoYXRjaFBvaW50LnBvc2l0aW9uLng7CiAgICBkaW1lbnNpb25ZID0gaGF0Y2hQb2ludC5wb3NpdGlvbi55OwogICAgc3BhY2VNb2QgPSB7c3BhY2U6ICJzaGFyZWQifTsKfQoKaWYgKCFhdXRvSGF0Y2ggJiYgY29uZmlnQm90LnRhZ3MuYWIgPT0gbnVsbCkKewogICAgZGltTW9kID0ge1tjdXJyZW50RGltXTogdHJ1ZSwgW2N1cnJlbnREaW0rIlgiXTogZGltZW5zaW9uWCwgW2N1cnJlbnREaW0rIlkiXTogZGltZW5zaW9uWSwgZGltZW5zaW9uOiBjdXJyZW50RGltfTsKfQplbHNlCnsKICAgIGlmIChjb25maWdCb3QudGFncy5rZXkgJiYgIXRoYXQua2V5KQogICAgewogICAgICAgIGtleSA9IGNvbmZpZ0JvdC50YWdzLmtleQogICAgfQoKICAgIGRpbU1vZC5hdXRvSGF0Y2ggPSB0cnVlOwogICAgZGltTW9kLmtleSA9IGtleTsKfQoKdGhpc0JvdC5tYW5pZmVzdE92byh7YWJJRDogYWJJRCwgZGltTW9kOiBkaW1Nb2QsIHNwYWNlTW9kOiBzcGFjZU1vZCwgZWdnRGF0YTogbmV3RWdnfSk7JwDnovvXB+tAC21hbmlmZXN0T3ZvAgQA56L71wfUYYIKQHNob3V0KCJhYjFNZW51UmVzZXQiKTsKCmlmIChsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCkKewogICAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7Cn0KCmlmIChsaW5rcy5vdm9Cb3QpCnsKICAgIGRlc3Ryb3kobGlua3Mub3ZvQm90KTsKfQoKbGV0IHNwYWNlTW9kID0gdGhhdC5zcGFjZU1vZDsKbGV0IGRpbU1vZCA9IHRoYXQuZGltTW9kOwpsZXQgZWdnRGF0YSA9IHRoYXQuZWdnRGF0YTsKbGV0IGVnZ01vZCA9IHt9OwoKZWdnTW9kLnNwYWNlID0gInRlbXBMb2NhbCI7CmVnZ01vZC5pbml0aWFsVGltZXIgPSB0cnVlOwplZ2dNb2QuYWJJRCA9IHRoYXQuYWJJRDsKZWdnTW9kLm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwplZ2dNb2Qub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIuaW50ZXJhY3RPdm8oKTtgOwplZ2dNb2Qub25DcmVhdGUgPSBgQCBpZiAodGFncy5hdXRvSGF0Y2gpCnsKICAgIGxpbmtzLm1hbmFnZXIuaGF0Y2hPdm8odGhpc0JvdCk7Cn0KZWxzZQp7CiAgICB0YWdzLnByb2dyZXNzQmFyID0gMDsgCgogICAgc2V0VGltZW91dCgoKSA9PiB7d2hpc3Blcih0aGlzQm90LCAiZWdnVGltZXIiKTt9LCA3NSk7Cn1gOwplZ2dNb2QuZm9ybSA9ICJlZ2ciOwplZ2dNb2QucHJvZ3Jlc3NCYXJDb2xvciA9ICIjQkY1RTY2IjsKZWdnTW9kLnByb2dyZXNzQmFyQmFja2dyb3VuZENvbG9yID0gIiM1OTI5ODkiOwplZ2dNb2QubGFiZWxTaXplID0gMC41OwplZ2dNb2QubGFiZWxDb2xvciA9ICIjNDA0MDQwIjsKZWdnTW9kLm9uUG9pbnRlckVudGVyID0gIkAgb3MudG9hc3QodGFncy5hYklEICsgJyB2Jyt0YWdzLnRhcmdldFZlcnNpb24pOyI7CmVnZ01vZC5sYWJlbFBvc2l0aW9uID0gImZyb250IjsKZWdnTW9kLm9yaWVudGF0aW9uTW9kZSA9ICJiaWxsYm9hcmRGcm9udCI7CmVnZ01vZC5vbkRlc3Ryb3kgPSBgQCBsaW5rcy5tYW5hZ2VyLm1hc2tzLm92b0JvdCA9IG51bGw7YDsKZWdnTW9kLmVnZ1RpbWVyID0gYEAgaWYgKHRhZ3MucHJvZ3Jlc3NCYXIgPCAxKSAKewogICAgdGFncy5wcm9ncmVzc0JhciArPSAwLjE7CgogICAgc2V0VGltZW91dCgoKSA9PiB7d2hpc3Blcih0aGlzQm90LCAiZWdnVGltZXIiKTt9LCA3NSk7Cn0KZWxzZQp7CiAgICB0aGlzQm90Lm9uQ2xpY2soKTsKICAgIAogICAgdGFncy5wcm9ncmVzc0JhciA9IG51bGw7Cn1gOwoKbGV0IG92byA9IGNyZWF0ZShlZ2dEYXRhLCBlZ2dNb2QsIGRpbU1vZCwgc3BhY2VNb2QpOwoKbWFza3Mub3ZvQm90ID0gIvCflJciICsgb3ZvLmlkOygA56L71wfrQAhvdm9IYXRjaAF+JwDnovvXB+tACW9uS2V5RG93bgIEAOei+9cH1GuFB0AvL0NPTVBMRVRFTFkgQlJPS0VOCgppZiAoIWxpbmtzLm92b0JvdCB8fCBjb25maWdCb3QudGFncy5tZW51UG9ydGFsICE9ICJvdm8iKQp7CiAgICByZXR1cm47Cn0KCmlmICh0aGF0LmtleXMgPT0gIlNoaWZ0IikKewogICAgbGV0IHZlcnNpb25CdXR0b24gPSB7fTsKCiAgICB2ZXJzaW9uQnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7CiAgICB2ZXJzaW9uQnV0dG9uLmFiMUVnZ01lbnUgPSB0cnVlOwogICAgdmVyc2lvbkJ1dHRvbi5tYXhWZXJzaW9uID0gdGFncy5tYXhWZXJzaW9uOwogICAgdmVyc2lvbkJ1dHRvbi5lZ2cgPSBnZXRJRCh0aGlzQm90KTsKICAgIHZlcnNpb25CdXR0b24ubWVudUl0ZW1TdHlsZSA9ICfwn6esIHsiYm9yZGVyLXJhZGl1cyI6ICI5cHggOXB4IDlweCA5cHgiLCAibWFyZ2luLXRvcCI6ICI2cHgifSc7CiAgICB2ZXJzaW9uQnV0dG9uLmxhYmVsID0gImNoYW5nZSBlZ2cgdmVyc2lvbiI7CiAgICB2ZXJzaW9uQnV0dG9uLmVnZ01lbnVSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKICAgIHZlcnNpb25CdXR0b24ub25HcmlkQ2xpY2sgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CiAgICB2ZXJzaW9uQnV0dG9uLmNvbG9yID0gIiNGRkZGRkYiOwogICAgdmVyc2lvbkJ1dHRvbi5vbktleVVwID0gIkAgaWYodGhhdC5rZXlzID09ICdTaGlmdCcpe2Rlc3Ryb3kodGhpc0JvdCl9OyI7CiAgICB2ZXJzaW9uQnV0dG9uLm9uQ2xpY2sgPSAiQCBvcy5zaG93SW5wdXRGb3JUYWcoZ2V0Qm90KCdpZCcsIHRhZ3MuZWdnKSwgJ3RhcmdldFZlcnNpb24nLCB7J3BsYWNlaG9sZGVyJzogJ2VudGVyIGEgdmVyc2lvbiBmcm9tIDEgdG8gJyArIHRhZ3MubWF4VmVyc2lvbn0pOyBzaG91dCgnZWdnTWVudVJlc2V0Jyk7IjsKCiAgICBjcmVhdGUodmVyc2lvbkJ1dHRvbik7Cn0nAOei+9cH60AIaGF0Y2hPdm8CBADnovvXB9hy/w1Ac2hvdXQoJ292b01lbnVSZXNldCcpOwoKY29uc3Qgb3ZvID0gdGhhdDsKCmxldCBhdXRvSGF0Y2ggPSBvdm8udGFncy5hdXRvSGF0Y2gKbGV0IHRhcmdldFZlcnNpb24gPSBjb25maWdCb3QudGFncy5hYlZlcnNpb24gJiYgY29uZmlnQm90LnRhZ3MuYWIgPT0gb3ZvLnRhZ3MuYWJJRCA/IGNvbmZpZ0JvdC50YWdzLmFiVmVyc2lvbiA6IG92by50YWdzLnRhcmdldFZlcnNpb247CmxldCB2ZXJzaW9uQXJyYXkgPSBvdm8udGFncy5lZ2dWZXJzaW9uSGlzdG9yeTsKbGV0IGZpbGVVUkwgPSB2ZXJzaW9uQXJyYXlbdGFyZ2V0VmVyc2lvbiAtIDFdOwpsZXQga2V5ID0gb3ZvLnRhZ3Mua2V5ID8gb3ZvLnRhZ3Mua2V5IDogY29uZmlnQm90LnRhZ3Mua2V5OwpsZXQgZmlsZUdldDsKCnRyeQp7CiAgICBmaWxlR2V0ID0gYXdhaXQgb3MuZ2V0RmlsZShmaWxlVVJMKTsKfQpjYXRjaCAoZXJyb3IpCnsKICAgIGNvbnNvbGUubG9nKCJjaGVja2luZyBvbGQgTFRNIiwgZXJyb3IpOwoKICAgIHZlcnNpb25BcnJheSA9IEpTT04ucGFyc2Uob3ZvLnRhZ3MuZWdnVmVyc2lvbkhpc3RvcnkpOwoKICAgIGxldCBmaWxlVVVJRCA9IHZlcnNpb25BcnJheVtvdm8udGFncy50YXJnZXRWZXJzaW9uXTsKICAgIGxldCBmaWxlbmFtZWhhc2ggPSBjcnlwdG8uc2hhMjU2KGZpbGVVVUlEKTsKICAgIGxldCBmaWxldXJsaGFzaCA9ICJhdXhfIiArIGZpbGVuYW1laGFzaCArICcuYXV4JzsKICAgIGxldCB0YXJnZXRVUkwgPSAiaHR0cHM6Ly9idWlsZGVyLWx0bS1maWxlcy5zMy5hbWF6b25hd3MuY29tLyIgKyBmaWxldXJsaGFzaDsKICAgIGxldCBvID0ge307CiAgICBvLm1ldGhvZCA9ICJHRVQiOwogICAgby51cmwgPSB0YXJnZXRVUkw7CgogICAgZmlsZUdldCA9IGF3YWl0IHdlYmhvb2sobyk7CgogICAgaWYgKGZpbGVHZXQuc3RhdHVzICE9IDIwMCkKICAgIHsKICAgICAgICBvcy50b2FzdCgibm8gZmlsZSBmb3VuZCIpOwoKICAgICAgICByZXR1cm47CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgZmlsZUdldCA9IGZpbGVHZXQuZGF0YTsKICAgIH0KfQoKaWYgKGNyeXB0by5pc0VuY3J5cHRlZChmaWxlR2V0KSkKewogICAgaWYgKCFrZXkpCiAgICB7CiAgICAgICAga2V5ID0gYXdhaXQgb3Muc2hvd0lucHV0KCcnLCB7CiAgICAgICAgICAgIHR5cGU6ICdzZWNyZXQnLAogICAgICAgICAgICB0aXRsZTogJ0VudGVyIGtleScKICAgICAgICB9KTsKICAgIH0KCiAgICB0cnkKICAgIHsKICAgICAgICBmaWxlR2V0ID0gY3J5cHRvLmRlY3J5cHQoa2V5LCBmaWxlR2V0KTsKICAgIH0KICAgIGNhdGNoIChlcnJvcikKICAgIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKCiAgICAgICAgb3MudG9hc3QoImtleSBkb2VzIG5vdCBtYXRjaCBmaWxlIik7CgogICAgICAgIHJldHVybjsKICAgIH0KICAgCiAgICBmaWxlR2V0ID0gSlNPTi5wYXJzZShmaWxlR2V0KTsKCiAgICBmaWxlR2V0ID0gZmlsZUdldC5zdGF0ZTsKfQplbHNlCnsKICAgIGZpbGVHZXQgPSBmaWxlR2V0LnN0YXRlOwp9CgpkZXN0cm95KG92byk7CgpsaW5rcy5jcmVhdGUuYWIxQ3JlYXRlQm90cyh7Ym90czogZmlsZUdldCwgb3JpZ2luOiBvdm8udGFncy5hYklELCB2ZXJzaW9uOiB0YXJnZXRWZXJzaW9ufSk7CgovL1RFU1QhISEKCi8vd2hpc3BlcihhYjFBVVhMb2FkZXIsICJhYjFQb3B1bGF0ZUJvdHMiLCB7ImJvdHMiOiBmaWxlR2V0LCAiZWdnIjogdHJ1ZSwgIm9yaWdpbiI6IHRhZ3MuYWJJRCwgImF1dG9IYXRjaCI6IGF1dG9IYXRjaCwgImtleSI6IGtleSwgInZlcnNpb24iOiB0YWdzLnRhcmdldFZlcnNpb259KTsnAOei+9cH60ALaW50ZXJhY3RPdm8CBADnovvXB9iAAdIHQGNvbnN0IG92b0JvdCA9IHRoYXQgPyB0aGF0IDogbGlua3Mub3ZvQm90OwoKaWYgKCFvdm9Cb3QpCnsKICAgIHJldHVybjsKfQoKc2hvdXQoIm92b01lbnVSZXNldCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAib3ZvIjsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgc2hvdXQoIm92b01lbnVSZXNldCIpO2A7Cm1hc2tzLm92b01lbnVSZXNldCA9IGBAIG1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsKbWFza3Mub3ZvTWVudVJlc2V0ID0gbnVsbDsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKYDsKCmxldCBlZ2dNZW51QnV0dG9uID0ge307Ly9VUERBVEUgTEFCRUwgT04gQk9UCgpvcy50d2VlblRvKG92b0JvdCwgMTUsNDUsNDUsIDUpOwoKZWdnTWVudUJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwplZ2dNZW51QnV0dG9uLm92byA9IHRydWU7CmVnZ01lbnVCdXR0b24ubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmVnZ01lbnVCdXR0b24ub3ZvQm90ID0gIvCflJciICsgb3ZvQm90LmlkOwplZ2dNZW51QnV0dG9uLnRhcmdldFZlcnNpb24gPSBvdm9Cb3QudGFncy50YXJnZXRWZXJzaW9uOwplZ2dNZW51QnV0dG9uLm1lbnVJdGVtU3R5bGUgPSAn8J+nrCB7ImJvcmRlci1yYWRpdXMiOiAiOXB4IDlweCA5cHggOXB4IiwgIm1hcmdpbi10b3AiOiAiNnB4In0nOwplZ2dNZW51QnV0dG9uLmxhYmVsID0gImhhdGNoICIgKyBvdm9Cb3QudGFncy5hYklEICsgIiB2IiArIG92b0JvdC50YWdzLnRhcmdldFZlcnNpb24gKyAiIG9mICIgKyBvdm9Cb3QudGFncy5tYXhWZXJzaW9uOwplZ2dNZW51QnV0dG9uLm92b01lbnVSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKZWdnTWVudUJ1dHRvbi5jb2xvciA9ICIjRkZGRkZGIjsKZWdnTWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MubWFuYWdlci5oYXRjaE92byhsaW5rcy5vdm9Cb3QpOyI7CgpjcmVhdGUoZWdnTWVudUJ1dHRvbik7JwDnovvXB+tABmNyZWF0ZQIEAOei+9cHpYgBKPCflJczNGMzYzIxMC01YmYxLTQ5Y2YtYjE1MS1lZTJkMDdmMGU2NzMnAQRib3RzJGU1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNwEnAOei+9cHzIgBBnN5c3RlbQIEAOei+9cHzYgBEmFiLTEuY29yZS5yZW1lbWJlcicA56L71wfMiAEEZm9ybQIEAOei+9cH4IgBB25vdGhpbmcoAOei+9cHzIgBB2FiMUNvcmUBeCgA56L71wfMiAENYWIxQXdha2VTdGF0ZQF5JwDnovvXB8yIAQtkZXNjcmlwdGlvbgIEAOei+9cH6ogBK1RoaXMgaXMgbWVhbnQgdG8gYmUgdGhlIGxvY2FsIHN0YXRlIGhvbGRlci4nAOei+9cHzIgBDGFiMVJlY29yZEtleQIEAOei+9cHlokBLnZSSzEuWVdJdE1RPT0uTkhac1VHdG9ObUZHWTNGSmRqSlRNbXMxTkZscVVUMDknAOei+9cHzIgBEmFiMUFjdGl2ZURpbWVuc2lvbgIEAOei+9cHxYkBBGhvbWUnAOei+9cHzIgBDGFiMUJhc2VDb2xvcgIEAOei+9cHyokBByM5MDhCRkMoAOei+9cHzIgBEGFiMUdyaWRTbmFwU3RhdGUBeCgA56L71wfMiAEPYWIxQm90U25hcFN0YXRlAXgnAOei+9cHzIgBDmFiMU1lbnVSZWZyZXNoAgQA56L71wfUiQEYQGNsZWFyVGFnTWFza3ModGhpc0JvdCk7KADnovvXB8yIAQtpbml0aWFsQm9vdAF4JwDnovvXB8yIAQthYjFFbmRwb2ludAIEAOei+9cH7okBFmh0dHBzOi8vcHVibGljb3MubGluay8nAQRib3RzJGY4NjAyODc4LWMyZWYtNDhiZC04NWEwLThkNjM1MWViNDEyMAEnAOei+9cHhYoBBnN5c3RlbQIEAOei+9cHhooBD2FiLTEuY29yZS5pbnB1dCcA56L71weFigEEZm9ybQIEAOei+9cHlooBB25vdGhpbmcnAOei+9cHhYoBCW9uS2V5RG93bgIEAOei+9cHnooBP0BpZiAodGhhdC5rZXlzID09ICJgIiAmJiBidWlsZGVyVmVyc2lvbikKewogICAgb3Muc2hvd0NoYXQoKTsKfScA56L71weFigEGb25DaGF0AgQA56L71wfeigGRFEBpZiAoIWJ1aWxkZXJWZXJzaW9uKQp7CiAgICByZXR1cm47Cn0KCmlmICh0aGF0Lm1lc3NhZ2VbMF0gPT0gIi4iKSAKewogICAgb3MuaGlkZUNoYXQoKTsKCiAgICBzd2l0Y2ggKHRoYXQubWVzc2FnZSkKICAgIHsKICAgICAgICBjYXNlICcuZG93bmxvYWRBQjEnOgogICAgICAgICAgICBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgPSBmYWxzZTsKCiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gYXdhaXQgb3Muc2hvd0lucHV0KCJncm91cCIpOwoKICAgICAgICAgICAgaWYgKGdyb3VwID09ICJhYjFDb3JlIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbGlua3MucmVtZW1iZXIudGFncy5pbml0aWFsQm9vdCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGFiMUdyb3VwID0gZ2V0Qm90cyhncm91cCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBvcy5kb3dubG9hZEJvdHNBc0luaXRpYWx6YXRpb25VcGRhdGUoYWIxR3JvdXAsIGdyb3VwKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBgLmxvYWRTa2lsbGA6CiAgICAgICAgICAgIGxldCBza2lsbCA9IGF3YWl0IG9zLnNob3dJbnB1dCgic2tpbGwiKTsKCiAgICAgICAgICAgIGxpbmtzLmxlYXJuLmFiMUFkYXB0KHNraWxsKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBgLnN5c3RlbWA6CiAgICAgICAgICAgIGNvbmZpZ0JvdC50YWdzLnN5c3RlbVBvcnRhbCA9IHRydWU7CgogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIGAuc2hlZXRgOgogICAgICAgICAgICBjb25maWdCb3QudGFncy5zaGVldFBvcnRhbCA9ICFjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsIDogY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBgLm1lbnVTaGVldGA6CiAgICAgICAgICAgIGNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgYC5kb3dubG9hZGA6CiAgICAgICAgICAgIG9zLmRvd25sb2FkQm90cyhnZXRCb3RzKCJzcGFjZSIsICJzaGFyZWQiKSwgImFiMUFsbCIpOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBgLnVwbG9hZGA6CiAgICAgICAgICAgIG9zLnNob3dVcGxvYWRBdXhGaWxlKCk7CgogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIGAuc2xlZXBgOgogICAgICAgICAgICBjaGFuZ2VTdGF0ZShsaW5rcy5tYW5pZmVzdGF0aW9uLCAiQXNsZWVwIiwgImFiMU1hbmlmZXN0U3RhdGUiKTsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgYC4uYDoKICAgICAgICAgICAgY2hhbmdlU3RhdGUobGlua3MubWFuaWZlc3RhdGlvbiwgIkF3YWtlIiwgImFiMU1hbmlmZXN0U3RhdGUiKTsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJy5sb2cnOgogICAgICAgICAgICBpZiAoY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsID09IGFiMS5pZCArICIuYWIxTG9nIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IG51bGw7CiAgICAgICAgICAgICAgICBjb25maWdCb3QubWFza3MudGFnUG9ydGFsU3BhY2UgPSBudWxsOwoKICAgICAgICAgICAgICAgIHRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9IG51bGw7CgogICAgICAgICAgICAgICAgb3MuaGlkZUNoYXQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSBhYjEuaWQgKyAiLmFiMUxvZyI7CiAgICAgICAgICAgICAgICBjb25maWdCb3QubWFza3MudGFnUG9ydGFsU3BhY2UgPSAidGVtcExvY2FsIjsKCiAgICAgICAgICAgICAgICB0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSAidG9wIjsKCiAgICAgICAgICAgICAgICBvcy5zaG93Q2hhdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJy5oaWRlTG9nJzoKICAgICAgICAgICAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IG51bGw7CiAgICAgICAgICAgIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSA9IG51bGw7CgogICAgICAgICAgICB0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSBudWxsOwoKICAgICAgICAgICAgb3MuaGlkZUNoYXQoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSB0aGF0Lm1lc3NhZ2U7CiAgICAgICAgICAgIGxldCBleGVjdXRhYmxlID0gbWVzc2FnZS5zbGljZSgxKTsKCiAgICAgICAgICAgIHRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvcy5ydW4oZXhlY3V0YWJsZSk7ICAKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCAoZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0KICAgIH0KfSgA56L71weFigEHYWIxQ29yZQF4JwDnovvXB4WKAQtkZXNjcmlwdGlvbgIEAOei+9cH8Z4BQlRoaXMgaXMgbWVhbnQgdG8gaGFuZGxlIGFueSBub25lIG1lbnUgcmVsYXRlZCBpbnB1dHMvaW50ZXJhY3Rpb25zLicA56L71weFigEMb25GaWxlVXBsb2FkAgQA56L71we0nwElQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfScA56L71weFigEFbGVhcm4CBADnovvXB9qfASjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwDnovvXB4WKAQhyZW1lbWJlcgIEAOei+9cHgaABKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAOei+9cHhYoBDW1hbmlmZXN0YXRpb24CBADnovvXB6igASjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkAA=="}]}